{"Title":"Azure CLI 脚本示例 - 计算 blob 容器大小","Description":"通过计算容器中 blob 的总大小来计算 Azure Blob 存储中容器的大小。","Content":"# <a name=\"calculate-the-size-of-a-blob-storage-container\"></a>计算 Blob 存储容器的大小\r \r 此脚本通过计算容器中 blob 的总大小来计算 Azure Blob 存储中容器的大小。\r \r [!INCLUDE [sample-cli-install](../../../includes/sample-cli-install.md)]\r \r [!INCLUDE [quickstarts-free-trial-note](../../../includes/quickstarts-free-trial-note.md)]\r \r ## <a name=\"sample-script\"></a>示例脚本\r \r ```azurecli\r #!/bin/bash\r export AZURE_STORAGE_ACCOUNT=<storage-account-name>\r export AZURE_STORAGE_ACCESS_KEY=<storage-account-key>\r \r # Create a resource group\r az group create --name myResourceGroup --location chinaeast\r \r # Create a container\r az storage container create --name mycontainer\r \r # Create sample files to upload as blobs\r for i in `seq 1 3`; do\r     echo $RANDOM > container_size_sample_file_$i.txt\r done\r \r # Upload sample files to container\r az storage blob upload-batch \\\r     --pattern \"container_size_sample_file_*.txt\" \\\r     --source . \\\r     --destination mycontainer\r \r # Calculate total size of container. Use the --query parameter to display only\r # blob contentLength and output it in TSV format so only the values are\r # returned. Then pipe the results to the paste and bc utilities to total the\r # size of the blobs in the container.\r bytes=`az storage blob list \\\r     --container-name mycontainer \\\r     --query \"[*].[properties.contentLength]\" \\\r     --output tsv |\r     paste --serial --delimiters=+ | bc`\r \r # Display total bytes\r echo \"Total bytes in container: $bytes\"\r \r # Delete the sample files created by this script\r rm container_size_sample_file_*.txt\r ```\r \r ## <a name=\"clean-up-deployment\"></a>清理部署 \r \r 运行以下命令来删除资源组、容器和所有相关资源。\r \r ```azurecli\r az group delete --name myResourceGroup\r ```\r \r ## <a name=\"script-explanation\"></a>脚本说明\r \r 此脚本使用以下命令来计算 Blob 存储容器的大小。 表中的每一项均链接到命令特定的文档。\r \r | 命令 | 说明 |\r |---|---|\r | [az group create](https://docs.azure.cn/cli/group#create) | 创建用于存储所有资源的资源组。 |\r | [az storage blob upload](https://docs.azure.cn/cli/storage/account#create) | 将本地文件上传到 Azure Blob 存储容器。 |\r | [az storage blob list](https://docs.azure.cn/cli/storage/account/keys#list) | 列出 Azure Blob 存储容器中的 blob。 |\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 有关 Azure CLI 的详细信息，请参阅 [Azure CLI 文档](https://docs.azure.cn/cli/overview)。\r \r 有关其他存储 CLI 脚本示例，可参阅 [Azure Blob 存储的 Azure CLI 示例](../blobs/storage-samples-blobs-cli.md)。\r "}