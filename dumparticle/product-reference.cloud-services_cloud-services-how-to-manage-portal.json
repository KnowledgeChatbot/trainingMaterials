{"Title":"常见的云服务管理任务","Description":"了解如何在 Azure 门户中管理云服务。 这些示例使用 Azure 门户。","Content":"# <a name=\"how-to-manage-cloud-services\"></a>如何管理云服务\r 在 Azure 门户的“云服务(经典)”区域中，可以更新服务角色或部署、将预留部署提升到生产、将资源链接到云服务，以便查看资源依赖关系并对资源进行整体缩放，以及删除云服务或部署。\r \r 有关如何扩展云服务的详细信息，请参阅[此文](./cloud-services-how-to-scale-portal.md)。\r \r ## <a name=\"how-to-update-a-cloud-service-role-or-deployment\"></a>如何：更新云服务角色或部署\r 如果需要更新云服务的应用程序代码，请使用云服务边栏选项卡上的“更新”  。 可以更新一个角色或所有角色。 若要进行更新，可以上传新服务包或服务配置文件。\r \r 1. 在 [Azure 门户][Azure portal]中，选择要更新的云服务。 此步骤打开云服务实例边栏选项卡。\r 2. 在边栏选项卡中，单击“更新”  按钮。\r \r     ![更新按钮](./media/cloud-services-how-to-manage-portal/update-button.png)\r \r 3. 使用新服务包文件 (.cspkg) 和服务配置文件 (.cscfg) 更新部署。\r \r     ![更新部署](./media/cloud-services-how-to-manage-portal/update-blade.png)\r \r 4. **可选** 更新部署标签和存储帐户。\r \r 5. 如果任何角色只有一个角色实例，请选择“即使一个或多个角色包含单个实例也进行部署”，以使升级能够继续。\r \r     如果每个角色至少具有两个角色实例（虚拟机），那么 Azure 在云服务更新期间只能保证 99.95% 的服务可用性。 因为有两个角色实例，因此其中一个虚拟机可以在另一个虚拟机更新时处理客户端请求。\r \r 6. 如果要在包上传完成后应用更新，请选中“开始部署”  。\r \r 7. 单击“确定”开始更新服务。\r \r ## <a name=\"how-to-swap-deployments-to-promote-a-staged-deployment-to-production\"></a>如何：交换部署以将暂留部署升级到生产环境\r \r 如果决定部署云服务的新版本，可以在云服务过渡环境中暂存和测试新版本。 使用“交换”将用于寻址这两个部署的 URL 地址互换，将新版本提升到生产环境。 \r \r 可以通过“云服务”页或仪表板来交换部署。\r \r 1. 在 [Azure 门户][Azure portal]中，选择要更新的云服务。 此步骤打开云服务实例边栏选项卡。\r 2. 在边栏选项卡中，单击“交换”  按钮。\r \r     ![云服务交换](./media/cloud-services-how-to-manage-portal/swap-button.png)\r \r 3. 将打开以下确认提示。\r \r     ![云服务交换](./media/cloud-services-how-to-manage-portal/swap-prompt.png)\r \r 4. 验证部署信息后，单击“确定”交换部署。\r \r     交换部署的速度很快，因为唯一发生更改的是部署所用的虚拟 IP 地址 (VIP)。\r \r     若要节省计算成本，可以在验证生产部署是否能够按预期运行后删除过渡部署。\r \r ### <a name=\"common-questions-about-swapping-deployments\"></a>有关交换部署的常见问题\r \r **交换部署的先决条件是什么？**\r \r 成功的部署交换有两个先决条件：\r \r - 如果想要将静态 IP 地址用于生产槽，也必须为过渡槽保留一个静态 IP 地址。 否则，交换失败。\r \r - 在执行交换之前，角色的所有实例必须都在运行。 可以在 Azure 门户的概述边栏选项卡中检查实例的状态。 或者，可以在 Windows PowerShell 中使用 [Get-AzureRole](https://docs.microsoft.com/en-us/powershell/module/azure/get-azurerole?view=azuresmps-3.7.0) 命令。\r \r 请注意，来宾 OS 更新和服务修复操作也会导致部署交换失败。 有关详细信息，请参阅[排查云服务部署问题](cloud-services-troubleshoot-deployment-problems.md)。\r \r **应用程序的交换是否会导致停机？ 应如何处理它？**\r \r 如在上一部分中所述，部署交换通常很快，因为它只更改 Azure 负载均衡器中的配置。 但是，在某些情况下，它会需要 10 秒或更长时间并导致暂时性连接故障。 \r \r ## <a name=\"how-to-link-a-resource-to-a-cloud-service\"></a>如何：将资源链接到云服务\r \r Azure 门户不会像当前 Azure 经典管理门户一样将资源链接在一起。而是将其他资源部署到云服务正在使用的同一资源组。\r \r ## <a name=\"how-to-delete-deployments-and-a-cloud-service\"></a>如何：删除部署和云服务\r \r 必须先删除每个现有部署，才能删除云服务。\r \r 若要节省计算成本，可以在验证生产部署是否能够按预期运行后删除过渡部署。停止的已部署角色实例仍会产生计算成本。\r \r 可使用以下过程删除部署或云服务。\r \r 1. 在 [Azure 门户][Azure portal]中，选择要删除的云服务。 此步骤打开云服务实例边栏选项卡。\r 2. 在边栏选项卡中，单击“删除”  按钮。\r \r     ![云服务交换](./media/cloud-services-how-to-manage-portal/delete-button.png)\r \r 3. 可以通过勾选“云服务及其部署”，或通过选择“生产部署”或“暂存部署”来删除整个云服务。\r \r     ![云服务交换](./media/cloud-services-how-to-manage-portal/delete-blade.png)\r \r 4. 单击底部的“删除”按钮。\r \r 5. 若要删除云服务，单击“删除云服务”。然后，在出现确认提示时单击“是”。\r \r > [!NOTE]\r > 删除云服务时，如果已配置详细监视，则必须从存储帐户中手动删除数据。 有关在何处查找度量值表的信息，请参阅[此文](./cloud-services-how-to-monitor.md)。\r \r \r ## <a name=\"how-to-find-more-information-about-failed-deployments\"></a>如何：查找有关失败部署的详细信息\r “概述”边栏选项卡的顶部提供了一个状态栏。 单击该栏时，将打开一个新的边栏选项卡，其中显示了所有错误信息。 如果部署不包含任何错误，则信息边栏选项卡是空白的。\r \r ![云服务交换](./media/cloud-services-how-to-manage-portal/status-info.png)\r \r \r \r [Azure portal]: https://portal.azure.cn\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r * [云服务的常规配置](./cloud-services-how-to-configure-portal.md)。\r * 了解如何[部署云服务](./cloud-services-how-to-create-deploy-portal.md)。\r * 配置[自定义域名](./cloud-services-custom-domain-name-portal.md)。\r * 配置 [SSL 证书](./cloud-services-configure-ssl-certificate-portal.md)。\r \r <!--Update_Description: update wording -->"}