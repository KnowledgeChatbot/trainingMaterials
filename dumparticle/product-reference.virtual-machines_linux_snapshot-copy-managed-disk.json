{"Title":"创建快照","Description":"了解如何在 Azure 中何创建 VHD 的副本作为备份或用于排查问题。","Content":"# <a name=\"create-a-snapshot\"></a>创建快照 \r \r 创建 OS 或数据磁盘 VHD 的快照，以便将其用作备份或用于排查 VM 问题。 快照是 VHD 的完整只读副本。 \r \r ## <a name=\"use-azure-cli-20-to-take-a-snapshot\"></a>使用 Azure CLI 2.0 拍摄快照\r \r 以下示例需要安装 Azure CLI 2.0 并登录到 Azure 帐户。 运行 `az --version` 即可查找版本。 如果需要进行安装或升级，请参阅[安装 Azure CLI 2.0](https://docs.azure.cn/zh-cn/cli/install-azure-cli?view=azure-cli-latest)。 \r \r 以下步骤说明如何使用带有 `--source-disk` 参数的 `az snapshot create` 命令创建快照。 以下示例假设在 `myResourceGroup` 资源组中存在使用托管操作系统磁盘创建的名为 `myVM` 的VM。\r \r ```azure-cli\r # take the disk id with which to create a snapshot\r osDiskId=$(az vm show -g myResourceGroup -n myVM --query \"storageProfile.osDisk.managedDisk.id\" -o tsv)\r az snapshot create -g myResourceGroup --source \"$osDiskId\" --name osDisk-backup\r ```\r \r 输出应类似于：\r \r ```json\r {\r   \"accountType\": \"Standard_LRS\",\r   \"creationData\": {\r     \"createOption\": \"Copy\",\r     \"imageReference\": null,\r     \"sourceResourceId\": null,\r     \"sourceUri\": \"/subscriptions/<guid>/resourceGroups/myResourceGroup/providers/Microsoft.Compute/disks/osdisk_6NexYgkFQU\",\r     \"storageAccountId\": null\r   },\r   \"diskSizeGb\": 30,\r   \"encryptionSettings\": null,\r   \"id\": \"/subscriptions/<guid>/resourceGroups/myResourceGroup/providers/Microsoft.Compute/snapshots/osDisk-backup\",\r   \"location\": \"chinanorth\",\r   \"name\": \"osDisk-backup\",\r   \"osType\": \"Linux\",\r   \"ownerId\": null,\r   \"provisioningState\": \"Succeeded\",\r   \"resourceGroup\": \"myResourceGroup\",\r   \"tags\": null,\r   \"timeCreated\": \"2017-02-06T21:27:10.172980+00:00\",\r   \"type\": \"Microsoft.Compute/snapshots\"\r }\r ```\r \r ## <a name=\"use-azure-portal-to-take-a-snapshot\"></a>使用 Azure 门户拍摄快照 \r \r 1. 登录到 [Azure 门户](https://portal.azure.cn)。\r 2. 首先在左上角单击“新建”并搜索“快照”。\r 3. 在“快照”边栏选项卡中，单击“创建”。\r 4. 输入快照的 **名称** 。\r 5. 选择现有的[资源组](../../azure-resource-manager/resource-group-overview.md#resource-groups)，或键入新资源组的名称。 \r 6. 选择 Azure 数据中心“位置”。  \r 7. 对于**源磁盘**，选择要获取其快照的托管磁盘。\r 8. 选择用于存储快照的“帐户类型”。 建议使用 **Standard_LRS**，除非需要将其存储在高性能磁盘上。\r 9. 单击“创建” 。\r \r 如果计划使用快照创建托管磁盘并将其附加到需要具有高性能的 VM，请结合使用 `az snapshot create` 命令和参数 `--sku Premium_LRS`。 这样就会创建可以作为高级托管磁盘存储的快照。 高级托管磁盘性能更好，因为它们是固态硬盘 (SSD)，但成本高于标准磁盘 (HDD)。\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r  通过从快照创建托管磁盘，然后将新的托管磁盘附加为 OS 磁盘，来从快照创建虚拟机。 有关详细信息，请参阅[从快照创建 VM](./../scripts/virtual-machines-linux-cli-sample-create-vm-from-snapshot.md?toc=%2fcli%2fmodule%2ftoc.json) 脚本。\r <!--Update_Description: update meta properties， update link, wording update -->\r "}