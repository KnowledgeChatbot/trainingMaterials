{"Title":"关于托管磁盘的复制","Description":"关于托管磁盘的复制","Content":"# 关于托管磁盘的复制\r \r ## 适用场景\r \r 想把托盘磁盘在当前资源组里复制一份？想把托盘磁盘复制到其他资源组里？想把托盘磁盘复制到其他订阅里？在 Azure 门户上发现没有这些功能？你可以在这篇文章里可以找到答案。\r \r > [!NOTE]\r > 本文仅适用于使用托管磁盘的虚拟机。\r \r ## 解决方案\r \r 1. 将托盘磁盘在当前资源组里复制一份。\r \r     ```\r     #读取托盘磁盘信息\r     PS C:\\windows\\system32> $managedDisk= Get-AzureRMDisk -ResourceGroupName \"<资源组名称>\" -DiskName \"<托管磁盘名称>\"\r     #准备托盘磁盘配置信息\r     PS C:\\windows\\system32> $diskConfig = New-AzureRmDiskConfig -SourceResourceId $managedDisk.Id -Location $managedDisk.Location -CreateOption Copy\r     #创建托盘磁盘，注意磁盘名称不要重复\r     PS C:\\windows\\system32> New-AzureRmDisk -Disk $diskConfig -DiskName \"<托管磁盘名称>\" -ResourceGroupName \"<资源组名称>\"\r     AccountType        : StandardLRS\r     TimeCreated        : 8/29/2017 1:36:52 PM\r     OsType             : Linux\r     CreationData       : Microsoft.Azure.Management.Compute.Models.CreationData\r     DiskSizeGB         : 128\r     EncryptionSettings :\r     OwnerId            :\r     ProvisioningState  : Succeeded\r     Id                 : /subscriptions/订阅 ID/resourceGroups/资源组名称/providers/Microsoft.Compute/disks/托盘磁盘名称\r     Name               : 托盘磁盘名称\r     Type               : Microsoft.Compute/disks\r     Location           : chinaeast\r     Tags               :\r     ```\r \r 2. 将托管磁盘复制到其他资源组里。\r \r     ```\r     #读取托盘磁盘信息\r     PS C:\\windows\\system32> $managedDisk= Get-AzureRMDisk -ResourceGroupName \"<资源组名称>\" -DiskName \"<托管磁盘名称>\"\r     #准备托盘磁盘配置信息\r     PS C:\\windows\\system32> $diskConfig = New-AzureRmDiskConfig -SourceResourceId $managedDisk.Id -Location $managedDisk.Location -CreateOption Copy\r     #创建托盘磁盘，注意磁盘名称不要重复\r     PS C:\\windows\\system32> New-AzureRmDisk -Disk $diskConfig -DiskName \"<托管磁盘名称>\" -ResourceGroupName \"<新资源组名称>\"\r     AccountType        : StandardLRS\r     TimeCreated        : 8/29/2017 1:36:52 PM\r     OsType             : Linux\r     CreationData       : Microsoft.Azure.Management.Compute.Models.CreationData\r     DiskSizeGB         : 128\r     EncryptionSettings :\r     OwnerId            :\r     ProvisioningState  : Succeeded\r     Id                 : /subscriptions/订阅 ID/resourceGroups/新资源组名称/providers/Microsoft.Compute/disks/托盘磁盘名称\r     Name               : 托盘磁盘名称\r     Type               : Microsoft.Compute/disks\r     Location           : chinaeast\r     Tags               :\r     ```\r \r 3. 将创建好的托管磁盘挂载到虚拟机上。请注意托管磁盘只能挂载到使用托管磁盘的虚拟机上。\r \r     ```\r     #在当前订阅下读取托盘磁盘信息\r     PS C:\\windows\\system32> $managedDisk= Get-AzureRMDisk -ResourceGroupName \"<资源组名称>\" -DiskName \"<托管磁盘名称>\"\r \r     #登陆需要复制到的订阅\r     PS C:\\windows\\system32> Login-AzureRmAccount -Environment AzureChinaCloud\r \r     Environment           : AzureChinaCloud\r     Account               : tonwan@mcpod.partner.onmschina.cn\r     TenantId              : 954ddad8-66d7-47a8-8f9f-1316152d9587\r     SubscriptionId        : d1fc1ce1-589b-47af-b2a8-0a5e860f0560\r     SubscriptionName      : Tonglei.Wang\r     CurrentStorageAccount :\r \r     #选择需要复制到的订阅\r     PS C:\\windows\\system32> Select-AzureRmSubscription -SubscriptionId d1fc1ce1-589b-47af-b2a8-0a5e860f0560\r \r     Environment           : AzureChinaCloud\r     Account               : tonwan@mcpod.partner.onmschina.cn\r     TenantId              : 954ddad8-66d7-47a8-8f9f-1316152d9587\r     SubscriptionId        : d1fc1ce1-589b-47af-b2a8-0a5e860f0560\r     SubscriptionName      : Tonglei.Wang\r     CurrentStorageAccount :\r \r     #准备托盘磁盘配置信息\r     PS C:\\windows\\system32> $diskConfig = New-AzureRmDiskConfig -SourceResourceId $managedDisk.Id -Location $managedDisk.Location -CreateOption Copy\r \r     #创建托盘磁盘，注意磁盘名称不要重复\r     PS C:\\windows\\system32> New-AzureRmDisk -Disk $diskConfig -DiskName \"<托管磁盘名称>\" -ResourceGroupName \"<资源组名称>\"\r     AccountType        : StandardLRS\r     TimeCreated        : 8/29/2017 1:36:52 PM\r     OsType             : Linux\r     CreationData       : Microsoft.Azure.Management.Compute.Models.CreationData\r     DiskSizeGB         : 128\r     EncryptionSettings :\r     OwnerId            :\r     ProvisioningState  : Succeeded\r     Id                 : /subscriptions/ 需要复制到的订阅 ID/resourceGroups/ 资源组名称 /providers/Microsoft.Compute/disks/ 托盘磁盘名称\r     Name               : 托盘磁盘名称\r     Type               : Microsoft.Compute/disks\r     Location           : chinaeast\r     Tags               :\r     ```"}