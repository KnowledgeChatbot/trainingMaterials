{"Title":"在 HDInsight 中使用 R 来自定义群集 - Azure","Description":"了解如何通过脚本操作安装 R，以及如何在 HDInsight 群集上使用 R。","Content":"# <a name=\"install-and-use-r-on-hdinsight-hadoop-clusters\"></a>在 HDInsight Hadoop 群集上安装并使用 R\r \r 了解如何使用 R 通过脚本操作来自定义基于 Windows 的 HDInsight 群集，以及如何在 HDInsight 群集上使用 R。\r \r 可以使用脚本操作在 Azure HDInsight 上任何类型的群集（Hadoop、Storm、HBase、Spark）上安装 R。 用于在 HDInsight 群集上安装 R 的示例脚本可通过 [https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1](https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1)上的只读 Azure 存储 Blob 获得。\r \r **相关文章**\r \r * [在 HDInsight 中创建 Hadoop 群集](hdinsight-hadoop-provision-linux-clusters.md)：有关如何创建 HDInsight 群集的一般信息\r * [使用脚本操作自定义 HDInsight 群集][hdinsight-cluster-customize]：有关使用脚本操作自定义 HDInsight 群集的一般信息\r * [为 HDInsight 开发脚本操作脚本](hdinsight-hadoop-script-actions.md)\r \r ## <a name=\"what-is-r\"></a>什么是 R？\r <a href=\"http://www.r-project.org/\" target=\"_blank\">统计计算的 R 项目</a>是一种用于统计计算的开放源代码语言和环境。 R 提供了数百个内置统计函数及其自己的编程语言，该语言结合了各方面的函数编程和面向对象的编程。 它还提供了各种图形功能。 R 是面向各个领域最专业的统计学家和科学家的首选编程环境。\r \r R 与 Azure Blob 存储 (WASB) 兼容，这样，存储在此的数据可以在 HDInsight 上使用 R 进行处理。  \r \r ## <a name=\"install-r\"></a>安装 R\r 用于在 HDInsight 群集上安装 R 的 [示例脚本](https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1) 可从 Azure 存储中的只读 Blob 获得。 本部分提供有关如何在使用 Azure 门户创建群集时使用示例脚本的说明。\r \r > [!NOTE]\r > 示例脚本是随同 HDInsight 群集版本 3.1 一起引入的。 有关 HDInsight 群集版本的详细信息，请参阅 [HDInsight 群集版本](hdinsight-component-versioning.md)。\r >\r >\r \r 1. 从门户创建 HDInsight 群集时，可先单击“可选配置”，然后单击“脚本操作”。\r 2. 在“脚本操作”  页上，输入以下值：\r \r     ![使用脚本操作自定义群集](./media/hdinsight-hadoop-r-scripts/hdi-r-script-action.png \"使用脚本操作自定义群集\")\r \r     <table border='1'>\r         <tr><th>属性</th><th>值</th></tr>\r         <tr><td>名称</td>\r             <td>指定脚本操作的名称，例如 Install R<b></b>。</td></tr>\r         <tr><td>脚本 URI</td>\r             <td>指定调用其对应脚本可自定义群集的 URI，例如 https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1<i></i></td></tr>\r         <tr><td>节点类型</td>\r             <td>指定在其上运行自定义脚本的节点。 可以选择“所有节点”、“仅限头节点”或“仅限辅助角色节点”<b></b><b></b><b></b>。\r         <tr><td>Parameters</td>\r             <td>根据脚本的需要，请指定参数。 但是，用于安装 R 的脚本不需要任何参数，因此，可以将此项保留为空。</td></tr>\r     </table>\r \r     可以添加多个脚本操作，以在群集上安装多个组件。 在添加了脚本后，单击复选标记以开始创建群集。\r \r 还可以通过 Azure PowerShell 或 HDInsight .NET SDK 使用脚本在 HDInsight 上安装 R。 有关这些过程的说明在本文后面提供。\r \r ## <a name=\"run-r-scripts\"></a>运行 R 脚本\r 本部分介绍如何在安装有 HDInsight 的 Hadoop 群集上运行 R 脚本。\r \r 1. **与群集建立远程桌面连接**：在门户中，对创建的安装有 R 的群集启用远程桌面，并连接到该群集。 有关说明，请参阅[使用 RDP 连接到 HDInsight 群集](hdinsight-administer-use-management-portal.md#connect-to-clusters-using-rdp)。\r 2. **打开 R 控制台**：R 安装将 R 控制台的链接放置在头节点的桌面上。 单击它以打开 R 控制台。\r 3. **运行 R 脚本**：通过粘贴并选择 R 脚本，并按 ENTER，可以从 R 控制台直接运行该脚本。 下面是一个简单的示例脚本，该脚本将生成 1 到 100 的数字，并将其乘以 2。\r \r         library(rmr2)\r         library(rhdfs)\r         ints = to.dfs(1:100)\r         calc = mapreduce(input = ints, map = function(k, v) cbind(v, 2*v))\r         from.dfs(calc)\r \r 前两行调用随 R 一起安装的 RHadoop 库。最后一行将结果打印到控制台。 输出应如下所示：\r \r     [1,]  1 2\r     [2,]  2 4\r     .\r     .\r     .\r     [98,]  98 196\r     [99,]  99 198\r     [100,] 100 200\r \r ## <a name=\"install-r-using-aure-powershell\"></a>使用 Azure PowerShell 安装 R\r 请参阅[使用脚本操作自定义 HDInsight 群集](hdinsight-hadoop-customize-cluster.md#call-scripts-using-azure-powershell)。  此示例演示如何使用 Azure PowerShell 安装 Spark。 需要自定义要使用的脚本 [https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1](https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1)。\r \r ## <a name=\"install-r-using-net-sdk\"></a>使用 .NET SDK 安装 R\r 请参阅[使用脚本操作自定义 HDInsight 群集](hdinsight-hadoop-customize-cluster.md#call-scripts-using-azure-powershell)。 此示例演示如何使用 .NET SDK 安装 Spark。 需要自定义脚本以使用 [https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1](https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1)。\r \r ## <a name=\"see-also\"></a>另请参阅\r * [在 HDInsight 中创建 Hadoop 群集](hdinsight-hadoop-provision-linux-clusters.md)：有关如何创建 HDInsight 群集的一般信息\r * [使用脚本操作自定义 HDInsight 群集][hdinsight-cluster-customize]：有关使用脚本操作自定义 HDInsight 群集的一般信息\r * [为 HDInsight 开发脚本操作脚本](hdinsight-hadoop-script-actions.md)\r * [在 HDInsight 群集上安装并使用 Spark][hdinsight-install-spark]：有关安装 Spark 的脚本操作示例\r * [在 HDInsight 群集上安装 Giraph](hdinsight-hadoop-giraph-install.md)：有关如何安装 Giraph 的脚本操作示例\r * [在 HDInsight 群集上安装 Solr](hdinsight-hadoop-solr-install-linux.md)：有关安装 Solr 的脚本操作示例。\r \r [powershell-install-configure]: https://docs.microsoft.com/powershell/azureps-cmdlets-docs\r [hdinsight-provision]: hdinsight-hadoop-provision-linux-clusters.md/\r [hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster-linux.md\r [hdinsight-install-spark]:spark/apache-spark-jupyter-spark-sql.md\r \r <!--Update_Description: update wording and link references-->\r "}