{"Title":"使用 Azure Cosmos DB 模拟器进行本地开发","Description":"利用 Azure Cosmos DB 模拟器，可以在本地免费开发和测试应用程序，无需创建 Azure 订阅。","Content":"# <a name=\"use-the-azure-cosmos-db-emulator-for-local-development-and-testing\"></a>将 Azure Cosmos DB 模拟器用于本地开发和测试\r \r <table>\r <tr>\r   <td><strong>二进制文件</strong></td>\r   <td>[下载 MSI](https://aka.ms/cosmosdb-emulator)</td>\r </tr>\r <tr>\r   <td><strong>Docker</strong></td>\r   <td>[Docker 中心](https://hub.docker.com/r/microsoft/azure-documentdb-emulator/)</td>\r </tr>\r <tr>\r   <td><strong>Docker 源</strong></td>\r   <td>[GitHub](https://github.com/azure/azure-documentdb-emulator-docker)</td>\r </tr>\r </table>\r \r 为方便进行开发，Azure Cosmos DB 模拟器提供了一个模拟 Azure Cosmos DB 服务的本地环境。 使用 Azure Cosmos DB 模拟器可在本地开发和测试应用程序，无需创建 Azure 订阅且不会产生任何费用。 如果对应用程序在 Azure Cosmos DB 模拟器中的工作情况感到满意，则可以切换到在云中使用 Azure Cosmos DB 帐户。\r \r 本文涵盖以下任务： \r \r > [!div class=\"checklist\"]\r > * 安装模拟器\r > * 对请求进行身份验证\r > * 在模拟器中使用数据资源管理器\r > * 导出 SSL 证书\r > * 从命令行调用模拟器\r > * 在适用于 Windows 的 Docker 上运行模拟器\r > * 收集跟踪文件\r > * 故障排除\r \r <!-- Not Available on VIDEO -->\r \r ## <a name=\"how-the-emulator-works\"></a>模拟器的工作原理\r Azure Cosmos DB 模拟器提供对 Azure Cosmos DB 服务的高保真模拟。 它支持和 Azure Cosmos DB 相同的功能，包括支持创建和查询 JSON 文档、预配集合和调整集合的规模，以及执行存储过程和触发器。 可以使用 Azure Cosmos DB 模拟器开发和测试应用程序，并通过对 Azure Cosmos DB 的连接终结点进行单一配置更改将其部署到多个区域范围的 Azure。\r <!-- Notice: 全球 to 多个区域 -->\r \r 虽然创建了实际 Azure Cosmos DB 服务的高保真本地模拟，但是 Azure Cosmos DB 模拟器的实现不同于该服务。 例如，Azure Cosmos DB 模拟器针对持久性使用标准 OS 组件（如本地文件系统），针对连接性使用 HTTPS 协议堆栈。 这意味着，不可通过 Azure Cosmos DB 模拟器使用某些依赖于 Azure 基础结构的功能，如全局复制、读/写的单位数毫秒延迟，以及可调整的一致性级别。\r \r > [!NOTE]\r > 目前，模拟器中的数据资源管理器仅支持创建 DocumentDB API 集合与 MongoDB 集合。 模拟器中的数据资源管理器目前不支持创建表。 \r ## <a name=\"differences-between-the-emulator-and-the-service\"></a>模拟器和服务之间的差异 \r 由于 Azure Cosmos DB 模拟器提供在本地开发人员工作站上运行的模拟环境，因此模拟器与云中的 Azure Cosmos DB 帐户之间的功能存在一些差异：\r \r * Azure Cosmos DB 模拟器只支持一个固定的帐户和公开的主密钥。  在 Azure Cosmos DB 模拟器中无法重新生成密钥。\r * Azure Cosmos DB 模拟器不是可缩放的服务，并且不支持大量集合。\r * Azure Cosmos DB 模拟器不模拟不同的 [Azure Cosmos DB 一致性级别](consistency-levels.md)。\r * Azure Cosmos DB 模拟器不模拟[多区域复制](distribute-data-globally.md)。\r * Azure Cosmos DB 模拟器不支持服务配额替代，而 Azure Cosmos DB 服务支持（例如文档大小限制、增加的分区集合存储）。\r * 由于 Azure Cosmos DB 模拟器副本不一定能反映 Azure Cosmos DB 服务的最新更改，因此请使用 [Azure Cosmos DB Capacity Planner](https://www.documentdb.com/capacityplanner) 准确估计应用程序的生产吞吐量 (RU) 需求。\r \r ## <a name=\"system-requirements\"></a>系统要求\r Azure Cosmos DB 模拟器具有以下硬件和软件要求：\r \r * 软件要求\r   * Windows Server 2012 R2、Windows Server 2016 或 Windows 10\r *   最低硬件要求\r   * 2 GB RAM\r   * 10 GB 可用硬盘空间\r \r ## <a name=\"installation\"></a>安装\r 可以从 [下载中心](https://aka.ms/cosmosdb-emulator)下载并安装 Azure Cosmos DB 模拟器，也可以在用于 Windows 的 Docker 上运行模拟器。 有关在用于 Windows 的 Docker 上使用模拟器的说明，请参阅[在 Docker 上运行](#running-on-docker)。 \r \r > [!NOTE]\r > 若要安装、配置和运行 Azure Cosmos DB 模拟器，必须在计算机上具有管理权限。\r \r ## <a name=\"running-on-windows\"></a>在 Windows 上运行\r \r 若要启动 Azure Cosmos DB 模拟器，请选择“启动”按钮或按 Windows 键。 开始键入“Azure Cosmos DB 模拟器”，然后从应用程序列表中选择该模拟器。 \r \r ![选择“启动”按钮或按 Windows 键，开始键入“Azure Cosmos DB 模拟器”，并从应用程序列表中选择该模拟器](./media/local-emulator/database-local-emulator-start.png)\r \r 运行模拟器时，在 Windows 任务栏通知区域中会显示一个图标。 ![Azure Cosmos DB 本地模拟器任务栏通知](./media/local-emulator/database-local-emulator-taskbar.png)\r \r 默认情况下 Azure Cosmos DB 模拟器在本地计算机（“localhost”）上运行，侦听端口 8081。\r \r 默认情况下，Azure Cosmos DB 模拟器安装到 `C:\\Program Files\\Azure Cosmos DB Emulator` 目录。 还可以从命令行启动和停止模拟器。 有关详细信息，请参阅[命令行工具参考](#command-line)。\r \r ## <a name=\"start-data-explorer\"></a>启动数据资源管理器\r \r Azure Cosmos DB 模拟器启动时，会在浏览器中自动打开 Azure Cosmos DB 数据资源管理器。 地址会显示为 [https://localhost:8081/_explorer/index.html](https://localhost:8081/_explorer/index.html)。 如果关闭浏览器并想要稍后重新打开，可在浏览器中打开 URL 或从 Windows 任务栏图标中的 Azure Cosmos DB 模拟器中启动，如下所示。\r \r ![Azure Cosmos DB 本地模拟器数据资源管理器启动器](./media/local-emulator/database-local-emulator-data-explorer-launcher.png)\r \r ## <a name=\"checking-for-updates\"></a>检查更新\r 数据资源管理器将指示是否有新的更新可供下载。 \r \r > [!NOTE]\r > 在 Azure Cosmos DB 模拟器的一个版本中创建的数据不保证在使用不同版本时可以访问。 如果需要长期保存数据，建议将该数据存储在 Azure Cosmos DB 帐户中，而不是存储在 Azure Cosmos DB 模拟器中。 \r \r ## <a name=\"authenticating-requests\"></a>对请求进行身份验证\r 与云中的 Azure Cosmos DB 一样，针对 Azure Cosmos DB 模拟器的每个请求都必须进行身份验证。 Azure Cosmos DB 模拟器使用一个固定的帐户和公开的身份验证密钥进行主密钥身份验证。 此帐户和密钥是允许用于 Azure Cosmos DB 模拟器的唯一凭据。 它们具有以下特点：\r \r     Account name: localhost:<port>\r     Account key: C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==\r \r > [!NOTE]\r > Azure Cosmos DB 模拟器支持的主密钥仅用于模拟器。 不能在 Azure Cosmos DB 模拟器中使用生产 Azure Cosmos DB 帐户和密钥。 \r \r > [!NOTE] \r > 如果使用“/Key”选项启动仿真器，请使用生成的密钥而不是“C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==”\r \r 此外，与 Azure Cosmos DB 服务一样，Azure Cosmos DB 模拟器仅支持采用 SSL 的安全通信。\r \r ## <a name=\"running-on-a-local-network\"></a>在本地网络上运行\r \r 可在本地网络中运行仿真器。 要启用网络访问，请在[命令行](#command-line-syntax)中指定 /AllowNetworkAccess 选项（同时还需指定 /Key=key_string 或 /KeyFile=file_name）。 可使用 /GenKeyFile=file_name 提前生成具有随机密钥的文件。  然后可将其传递至 /KeyFile=file_name 或 /Key=contents_of_file。\r \r 首次启用网络访问时，用户应关闭模拟器，并删除模拟器的数据目录 (C:\\Users\\user_name\\AppData\\Local\\CosmosDBEmulator)。\r \r ## <a name=\"developing-with-the-emulator\"></a>通过模拟器进行开发\r 在桌面上运行 Azure Cosmos DB 模拟器以后，可以使用任何支持的 [Azure Cosmos DB SDK](documentdb-sdk-dotnet.md) 或 [Azure Cosmos DB REST API](https://docs.microsoft.com/rest/api/documentdb/) 与模拟器进行交互。 Azure Cosmos DB 模拟器还包括内置数据资源管理器，可以利用它在不编写任何代码的情况下为 DocumentDB 和 MongoDB API 创建集合，以及查看和编辑文档。   \r \r     // Connect to the Azure Cosmos DB Emulator running locally\r     DocumentClient client = new DocumentClient(\r         new Uri(\"https://localhost:8081\"), \r         \"C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==\");\r \r 如果使用 [Azure Cosmos DB 的 MongoDB 协议支持](mongodb-introduction.md)，请使用以下连接字符串：\r \r     mongodb://localhost:C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==@localhost:10255/admin?ssl=true\r \r 可以使用现有工具如 [Azure DocumentDB Studio](https://github.com/mingaliu/DocumentDBStudio) 连接到 Azure Cosmos DB 模拟器。 还可以通过 [Azure Cosmos DB 数据迁移工具](https://github.com/azure/azure-documentdb-datamigrationtool)在 Azure Cosmos DB 模拟器和 Azure Cosmos DB 服务之间迁移数据。\r \r > [!NOTE] \r > 如果使用“/Key”选项启动仿真器，请使用生成的密钥而不是“C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==”\r \r 默认情况下，使用 Azure Cosmos DB 模拟器，可创建多达 25 个单分区集合或 1 个已分区集合。 有关如何更改此值的详细信息，请参阅[设置 PartitionCount 值](#set-partitioncount)。\r \r ## <a name=\"export-the-ssl-certificate\"></a>导出 SSL 证书\r \r .NET 语言和运行时使用 Windows 证书存储来安全地连接到 Azure Cosmos DB 本地模拟器。 其他语言有自己管理和使用证书方法。 Java 使用自己的[证书存储](https://docs.oracle.com/cd/E19830-01/819-4712/ablqw/index.html)，而 Python 使用[套接字包装器](https://docs.python.org/2/library/ssl.html)。\r \r 若要获取与不集成到 Windows 证书存储中的语言和运行时配合使用的证书，需要使用 Windows 证书管理器进行导出。 可通过运行 certlm.msc 进行启动，也可按照[导出 Azure Cosmos DB 模拟器证书](./local-emulator-export-ssl-certificates.md)中的分步说明进行操作。 证书管理器开始运行后，打开个人证书（如下所示），并将友好名称为“DocumentDBEmulatorCertificate”的证书导出为 BASE-64 编码的 X.509 (.cer) 文件。\r \r ![Azure Cosmos DB 本地模拟器 SSL 证书](./media/local-emulator/database-local-emulator-ssl_certificate.png)\r \r 可按照 [ 将证书添加到 Java CA 证书存储 ](/java-add-certificate-ca-store) 中的说明，将 X.509 证书导入 Java 证书存储。 证书导入证书存储后，Java 和 MongoDB 应用程序即可连接到 Azure Cosmos DB 模拟器。\r \r 从 Python 和 Node.js SDK 连接到模拟器时，会禁用 SSL 验证。\r \r ## <a name=\"command-line\"></a>命令行工具参考\r 从安装位置中，可以使用命令行启动和停止模拟器、配置选项和执行其他操作。\r \r ### <a name=\"command-line-syntax\"></a>命令行语法\r \r     CosmosDB.Emulator.exe [/Shutdown] [/DataPath] [/Port] [/MongoPort] [/DirectPorts] [/Key] [/EnableRateLimiting] [/DisableRateLimiting] [/NoUI] [/NoExplorer] [/?]\r \r 若要查看选项列表，请在命令提示符下键入 `CosmosDB.Emulator.exe /?` 。\r \r <table>\r <tr>\r   <td><strong>选项</strong></td>\r   <td><strong>说明</strong></td>\r   <td><strong>命令</strong></td>\r   <td><strong>参数</strong></td>\r </tr>\r <tr>\r   <td>[无参数]</td>\r   <td>使用默认设置启动 Azure Cosmos DB 模拟器。</td>\r   <td>CosmosDB.Emulator.exe</td>\r   <td></td>\r </tr>\r <tr>\r   <td>[帮助]</td>\r   <td>显示支持的命令行参数的列表。</td>\r   <td>CosmosDB.Emulator.exe /?</td>\r   <td></td>\r </tr>\r <tr>\r   <td>Shutdown</td>\r   <td>关闭 Azure Cosmos DB 模拟器。</td>\r   <td>CosmosDB.Emulator.exe /Shutdown</td>\r   <td></td>\r </tr>\r <tr>\r   <td>DataPath</td>\r   <td>指定要在其中存储数据文件的路径。 默认值为 %LocalAppdata%\\CosmosDBEmulator。</td>\r   <td>CosmosDB.Emulator.exe /DataPath=&lt;datapath&gt;</td>\r   <td>&lt;datapath&gt;：可访问的路径</td>\r </tr>\r <tr>\r   <td>端口</td>\r   <td>指定用于模拟器的端口号。  默认值为 8081。</td>\r   <td>CosmosDB.Emulator.exe /Port=&lt;port&gt;</td>\r   <td>&lt;port&gt;：单个端口号</td>\r </tr>\r <tr>\r   <td>MongoPort</td>\r   <td>指定用于 MongoDB 兼容性 API 的端口号。 默认为 10255。</td>\r   <td>CosmosDB.Emulator.exe /MongoPort=&lt;mongoport&gt;</td>\r   <td>&lt;mongoport&gt;：单个端口号</td>\r </tr>\r <tr>\r   <td>DirectPorts</td>\r   <td>指定用于直接连接的端口。 默认值为 10251、10252、10253、10254。</td>\r   <td>CosmosDB.Emulator.exe /DirectPorts:&lt;directports&gt;</td>\r   <td>&lt;directports&gt;：以逗号分隔的 4 个端口的列表</td>\r </tr>\r <tr>\r   <td>键</td>\r   <td>模拟器的授权密钥。 密钥必须是 64 字节向量的 base 64 编码。</td>\r   <td>CosmosDB.Emulator.exe /Key:&lt;key&gt;</td>\r   <td>&lt;key&gt;：密钥必须是 64 字节向量的 base 64 编码</td>\r </tr>\r <tr>\r   <td>EnableRateLimiting</td>\r   <td>指定启用请求速率限制行为。</td>\r   <td>CosmosDB.Emulator.exe /EnableRateLimiting</td>\r   <td></td>\r </tr>\r <tr>\r   <td>DisableRateLimiting</td>\r   <td>指定禁用请求速率限制行为。</td>\r   <td>CosmosDB.Emulator.exe /DisableRateLimiting</td>\r   <td></td>\r </tr>\r <tr>\r   <td>NoUI</td>\r   <td>不显示模拟器用户界面。</td>\r   <td>CosmosDB.Emulator.exe /NoUI</td>\r   <td></td>\r </tr>\r <tr>\r   <td>NoExplorer</td>\r   <td>不在启动时显示文档资源管理器。</td>\r   <td>CosmosDB.Emulator.exe /NoExplorer</td>\r   <td></td>\r </tr>\r <tr>\r   <td>PartitionCount</td>\r   <td>指定已分区的集合的最大数。 有关详细信息，请参阅[更改集合数](#set-partitioncount)。</td>\r   <td>CosmosDB.Emulator.exe /PartitionCount=&lt;partitioncount&gt;</td>\r   <td>&lt;partitioncount&gt;：允许的单分区集合的最大数量。 默认值为 25。 允许的最大值为 250。</td>\r </tr>\r <tr>\r   <td>DefaultPartitionCount</td>\r   <td>指定分区集合的默认分区数。</td>\r   <td>CosmosDB.Emulator.exe /DefaultPartitionCount=&lt;defaultpartitioncount&gt;</td>\r   <td>&lt;defaultpartitioncount&gt; 默认值为 25。</td>\r </tr>\r <tr>\r   <td>AllowNetworkAccess</td>\r   <td>通过网络启用对仿真器的访问。 要启用网络访问，还必须传递 /Key=&lt;key_string&gt; 或 /KeyFile=&lt;file_name&gt;。</td>\r   <td>CosmosDB.Emulator.exe /AllowNetworkAccess /Key=&lt;key_string&gt;<br><br>或<br><br>CosmosDB.Emulator.exe /AllowNetworkAccess /KeyFile=&lt;file_name&gt;</td>\r   <td></td>\r </tr>\r <tr>\r   <td>NoFirewall</td>\r   <td>在使用 /AllowNetworkAccess 时，请勿调整防火墙规则。</td>\r   <td>CosmosDB.Emulator.exe /NoFirewall</td>\r   <td></td>\r </tr>\r <tr>\r   <td>GenKeyFile</td>\r   <td>生成新的授权密钥并保存至指定文件。 所生成的密钥可与 /Key 或 /KeyFile 选项配合使用。</td>\r   <td>CosmosDB.Emulator.exe  /GenKeyFile=&lt;path to key file&gt;</td>\r   <td></td>\r </tr>\r <tr>\r   <td>一致性</td>\r   <td>为帐户设置默认一致性级别。</td>\r   <td>CosmosDB.Emulator.exe /Consistency=&lt;consistency&gt;</td>\r   <td>&lt;一致性&gt;：值必须是下列[一致性级别](consistency-levels.md)之一：Session、Strong、Eventual 或 BoundedStaleness。  默认值为“Session”。</td>\r </tr>\r <tr>\r   <td>?</td>\r   <td>显示帮助消息。</td>\r   <td></td>\r   <td></td>\r </tr>\r </table>\r \r ## <a name=\"set-partitioncount\"></a> 更改集合数\r \r 默认情况下，使用 Azure Cosmos DB 模拟器可创建多达 25 个单区集合或 1 个已分区集合。 通过修改 **PartitionCount** 值，可以创建最多 250 个单分区集合或 10 个已分区集合，或两者的任意组合（不得超过 250 个单分区，其中 1 个已分区集合 = 25 个单分区集合）。\r \r 如果在已超过当前分区计数后尝试创建集合，则模拟器会引发 ServiceUnavailable 异常，并收到以下消息。\r \r     Sorry, we are currently experiencing high demand in this region, \r     and cannot fulfill your request at this time. We work continuously \r     to bring more and more capacity online, and encourage you to try again. \r     Please do not hesitate to email docdbswat@microsoft.com at any time or \r     for any reason. ActivityId: 29da65cc-fba1-45f9-b82c-bf01d78a1f91\r \r 若要更改 Azure Cosmos DB 模拟器可用的集合数，请执行以下操作：\r \r 1. 通过在系统任务栏上右键单击“Azure Cosmos DB 模拟器”图标，并单击“重置数据...”，删除所有本地 Azure Cosmos DB 模拟器数据。\r 2. 删除文件夹 C:\\Users\\user_name\\AppData\\Local\\CosmosDBEmulator 中的所有模拟器数据。\r 3. 通过在系统任务栏上右键单击“Azure Cosmos DB 模拟器”图标，并单击“退出”，退出所有打开的实例。 退出所有实例可能需要一分钟。\r 4. 安装最新版的 [Azure Cosmos DB 模拟器](https://aka.ms/cosmosdb-emulator)。\r 5. 通过设置一个 <= 250 的值启动具有 PartitionCount 标志的模拟器。 例如： `C:\\Program Files\\Azure CosmosDB Emulator>CosmosDB.Emulator.exe /PartitionCount=100`。\r \r ## <a name=\"running-on-docker\"></a>在 Docker 上运行\r \r 可以在用于 Windows 的 Docker 上运行 Azure Cosmos DB 模拟器。 该模拟器不适合于用于 Oracle Linux 的 Docker。\r \r 安装[用于 Windows 的 Docker](https://www.docker.com/docker-windows) 后，通过右键单击工具栏上的 Docker 图标并选择“切换到 Windows 容器”切换到 Windows 容器。\r \r 接下来，通过从常用的 shell 运行以下命令，从 Docker 中心拉取模拟器映像。\r \r ```     \r docker pull microsoft/azure-cosmosdb-emulator \r ```\r 若要启动映像，请运行以下命令。\r \r 通过命令行：\r ```cmd \r md %LOCALAPPDATA%\\CosmosDBEmulatorCert 2>null\r docker run -v %LOCALAPPDATA%\\CosmosDBEmulatorCert:c:\\CosmosDBEmulator\\CosmosDBEmulatorCert -P -t -i -m 2GB microsoft/azure-cosmosdb-emulator \r ```\r \r 通过 PowerShell：\r ```powershell\r md $env:LOCALAPPDATA\\CosmosDBEmulatorCert 2>null\r docker run -v $env:LOCALAPPDATA\\CosmosDBEmulatorCert:c:\\CosmosDBEmulator\\CosmosDBEmulatorCert -P -t -i -m 2GB microsoft/azure-cosmosdb-emulator \r ```\r \r 响应类似于以下内容：\r \r ```\r Starting Emulator\r Emulator Endpoint: https://172.20.229.193:8081/\r Master Key: C2y6yDjf5/R+ob0N8A7Cgv30VRDJIWEHLM+4QDU5DE2nQ9nDuVTqobD4b8mGGyPMbIZnqyMsEcaGQy67XIw/Jw==\r Exporting SSL Certificate\r You can import the SSL certificate from an administrator command prompt on the host by running:\r cd /d %LOCALAPPDATA%\\CosmosDBEmulatorCert\r powershell .\\importcert.ps1\r --------------------------------------------------------------------------------------------------\r Starting interactive shell\r ``` \r \r 现在，在客户端中使用来自响应的终结点和主密钥，并将 SSL 证书导入到主机中。 若要导入 SSL 证书，请从管理员命令提示符执行以下操作：\r \r ```\r cd %LOCALAPPDATA%\\CosmosDBEmulatorCert\r powershell .\\importcert.ps1\r ```\r \r 在模拟器启动之后便关闭交互式 shell 会关闭模拟器的容器。\r \r 若要打开数据资源管理器，请在浏览器中导航到以下 URL。 上面所示的响应消息中提供了模拟器终结点。\r \r     https://<emulator endpoint provided in response>/_explorer/index.html\r \r ## <a name=\"troubleshooting\"></a>故障排除\r \r 使用以下提示来帮助解决使用 Azure Cosmos DB 模拟器时遇到的问题：\r \r - 如果安装了新版本的模拟器并遇到错误，请务必重置数据。 重置数据的方法如下：在系统任务栏上右键单击“Azure Cosmos DB 模拟器”图标，然后单击“重置数据...”。 如果这样做无法修复错误，则可卸载并重新安装该应用。 有关说明，请参阅[卸载本地模拟器](#uninstall)。\r \r - 如果 Azure Cosmos DB 模拟器崩溃，请从 c:\\Users\\user_name\\AppData\\Local\\CrashDumps 文件夹收集转储文件、进行压缩并将其附加到电子邮件，发送至 [Azure Support](https://www.azure.cn/support/contact/)。\r \r - 如果在 CosmosDB.StartupEntryPoint.exe 中遇到崩溃，请从管理员命令提示符运行以下命令：`lodctr /R` \r \r - 如果遇到连接问题，请[收集跟踪文件](#trace-files)、进行压缩并将其附加到电子邮件，发送至 [Azure Support](https://www.azure.cn/support/contact/)。\r \r - 如果出现“服务不可用”消息，则可能表示模拟器无法初始化网络堆栈。 检查是否安装了 Pulse 安全客户端或 Juniper 网络客户端，因为这些客户端的网络筛选器驱动程序可能会导致问题。 卸载第三方网络筛选器驱动程序通常即可解决问题。\r \r ### <a name=\"trace-files\"></a>收集跟踪文件\r \r 若要收集调试跟踪，请在管理命令提示符下运行以下命令：\r \r 1. `cd /d \"%ProgramFiles%\\Azure Cosmos DB Emulator\"`\r 2. `CosmosDB.Emulator.exe /shutdown`。 监视系统任务栏，确保该程序已关闭，这可能需要一分钟时间。 也可以直接在 Azure Cosmos DB 模拟器用户界面中单击“退出” 。\r 3. `CosmosDB.Emulator.exe /starttraces`\r 4. `CosmosDB.Emulator.exe`\r 5. 再现问题。 如果数据资源管理器无法运行，只需等待几秒钟，待浏览器打开以捕获错误。\r 5. `CosmosDB.Emulator.exe /stoptraces`\r 6. 导航到 `%ProgramFiles%\\Azure Cosmos DB Emulator`，查找 docdbemulator_000001.etl 文件。\r 7. 将 .etl 文件和重现步骤一起发送至 [Azure Support](https://www.azure.cn/support/contact/) 进行调试。\r \r ### <a name=\"uninstall\"></a>卸载本地模拟器\r \r 1. 通过在系统任务栏上右键单击“Azure Cosmos DB 模拟器”图标，然后单击“退出”，退出所有打开的本地模拟器实例。 退出所有实例可能需要一分钟。\r 2. 在 Windows 搜索框中，键入“应用和功能”，然后单击“应用和功能(系统设置)”结果。\r 3. 在应用列表中，滚动到“Azure Cosmos DB 模拟器”并将其选中，单击“卸载”，然后确认并再次单击“卸载”。\r 4. 卸载应用后，导航到 C:\\Users\\<user>\\AppData\\Local\\CosmosDBEmulator 并删除该文件夹。 \r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 在本教程中已完成以下操作：\r \r > [!div class=\"checklist\"]\r > * 安装本地模拟器\r > * 在适用于 Windows 的 Docker 上运行模拟器\r > * 经过身份验证的请求\r > * 在模拟器中使用数据资源管理器\r > * 导出 SSL 证书\r > * 从命令行调用模拟器\r > * 收集跟踪文件\r \r 在本教程中，已了解如何使用本地模拟器进行免费的本地开发。 现在可以继续学习下一教程，了解如何导出模拟器 SSL 证书。 \r \r > [!div class=\"nextstepaction\"]\r > [导出 Azure Cosmos DB 模拟器证书](local-emulator-export-ssl-certificates.md)\r \r <!--Update_Description: update meta properties, wording update, update link-->"}