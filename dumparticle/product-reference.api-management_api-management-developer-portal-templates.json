{"Title":"使用模板自定义 API 管理开发人员门户 -Azure","Description":"了解如何使用模板自定义 Azure API 管理开发人员门户。","Content":"# <a name=\"how-to-customize-the-azure-api-management-developer-portal-using-templates\"></a>如何使用模板自定义 Azure API 管理开发人员门户\r \r 在 Azure API 管理中自定义开发人员门户有三种基本方法：\r \r * [编辑静态页面内容和页面布局元素][modify-content-layout]\r * [跨开发人员门户更新页面元素所用的样式][customize-styles]\r * [修改门户生成的页面所用的模板][portal-templates]（在本指南中进行了介绍）\r \r 模板用于自定义系统生成的开发人员门户页的内容（例如，API 文档、产品、用户身份验证等）。 使用 [DotLiquid](http://dotliquidmarkup.org/) 语法和一组提供的本地化字符串资源、图标和页面控件，可根据需要非常灵活地配置页面内容。\r \r ## <a name=\"developer-portal-templates-overview\"></a>开发人员门户模板概述\r 在以管理员身份登录时，可从“开发人员门户”编辑模板。 若要访问它，请先打开 Azure 门户，再单击 API 管理实例的服务工具栏中的“发布者门户”。\r \r ![发布者门户][api-management-management-console]\r \r 然后单击右上角的“开发人员门户”。 \r \r ![开发人员门户菜单][api-management-developer-portal-menu]\r \r 若要访问开发人员门户模板，请单击左侧的自定义图标显示自定义菜单，并单击“模板”。\r \r ![开发人员门户模板][api-management-customize-menu]\r \r 模板列表显示了模板的多个类别，涵盖开发人员门户中的不同页面。 每个模板都不同，但编辑它们并发布更改的步骤均相同。 若要编辑模板，请单击模板的名称。\r \r ![开发人员门户模板][api-management-templates-menu]\r \r 单击模板将转到由该模板自定义的开发人员门户页面。 在此示例中，显示了“产品列表”模板。 “产品列表”模板控制红色矩形所示的屏幕区域。 \r \r ![产品列表模板][api-management-developer-portal-templates-overview]\r \r 某些模板（如“用户配置文件”模板）自定义同一页面的不同部分。 \r \r ![用户配置文件模板][api-management-user-profile-templates]\r \r 每个开发人员门户模板的编辑器都具有显示在页面底部的两个部分。 左侧显示模板的编辑窗格，右侧显示模板的数据模型。 \r \r 模板编辑窗格包含标记，用于控制开发人员门户中的对应页面的外观和行为。 模板中的标记使用 [DotLiquid](http://dotliquidmarkup.org/) 语法。 DotLiquid 的一个流行编辑器是 [DotLiquid for Designers](https://github.com/dotliquid/dotliquid/wiki/DotLiquid-for-Designers)。 在编辑期间对模板所作的任何更改都实时显示在浏览器中，但在[保存](#to-save-a-template)并[发布](#to-publish-a-template)该模板之前对客户不可见。\r \r ![模板标记][api-management-template]\r \r “模板数据”窗格提供可在特定模板中使用的实体的数据模型指南。 它通过显示当前在开发人员门户中显示的实时数据提供此指南。 可通过单击“模板数据”窗格右上角的矩形展开模板窗格。\r \r ![模板数据模型][api-management-template-data]\r \r 在前面的示例中，开发人员门户中显示了两个从“模板数据”窗格中显示的数据检索的产品，如以下示例所示。\r \r ```json\r {\r     \"Paging\": {\r         \"Page\": 1,\r         \"PageSize\": 10,\r         \"TotalItemCount\": 2,\r         \"ShowAll\": false,\r         \"PageCount\": 1\r     },\r     \"Filtering\": {\r         \"Pattern\": null,\r         \"Placeholder\": \"Search products\"\r     },\r     \"Products\": [\r         {\r             \"Id\": \"56ec64c380ed850042060001\",\r             \"Title\": \"Starter\",\r             \"Description\": \"Subscribers will be able to run 5 calls/minute up to a maximum of 100 calls/week.\",\r             \"Terms\": \"\",\r             \"ProductState\": 1,\r             \"AllowMultipleSubscriptions\": false,\r             \"MultipleSubscriptionsCount\": 1\r         },\r         {\r             \"Id\": \"56ec64c380ed850042060002\",\r             \"Title\": \"Unlimited\",\r             \"Description\": \"Subscribers have completely unlimited access to the API. Administrator approval is required.\",\r             \"Terms\": null,\r             \"ProductState\": 1,\r             \"AllowMultipleSubscriptions\": false,\r             \"MultipleSubscriptionsCount\": 1\r         }\r     ]\r }\r ```\r \r **产品列表**模板中的标记处理数据以显示所需的输出，方法是循环访问产品集合以显示信息和指向每个单独产品的链接。 请注意标记中的 `<search-control>` 和 `<page-control>` 元素。 这些元素控制页面上的搜索和分页控件的显示。 `ProductsStrings|PageTitleProducts` 是一个本地化的字符串引用，包含页面的 `h2` 标题文本。 有关可在开发人员门户模板中使用的字符串资源、页面控件和图标的列表，请参阅 [API 管理开发人员门户模板参考](./api-management-developer-portal-templates-reference.md)。\r \r ```html\r <search-control></search-control>\r <div class=\"row\">\r     <div class=\"col-md-9\">\r         <h2>{% localized \"ProductsStrings|PageTitleProducts\" %}</h2>\r     </div>\r </div>\r <div class=\"row\">\r     <div class=\"col-md-12\">\r     {% if products.size > 0 %}\r     <ul class=\"list-unstyled\">\r     {% for product in products %}\r         <li>\r             <h3><a href=\"/products/{{product.id}}\">{{product.title}}</a></h3>\r             {{product.description}}\r         </li>    \r     {% endfor %}\r     </ul>\r     <paging-control></paging-control>\r     {% else %}\r     {% localized \"CommonResources|NoItemsToDisplay\" %}\r     {% endif %}\r     </div>\r </div>\r ```\r \r ## <a name=\"to-save-a-template\"></a>保存模板\r 若要保存模板，请在模板编辑器中单击“保存”。\r \r ![保存模板][api-management-save-template]\r \r 已保存的更改在发布之前不会在开发人员门户中生效。\r \r ## <a name=\"to-publish-a-template\"></a>发布模板\r 已保存的模板可单独发布，也可全部一起发布。 若要发布个别模板，请在模板编辑器中单击“发布”。\r \r ![发布模板][api-management-publish-template]\r \r 单击“是”进行确认并使模板在开发人员门户中生效。\r \r ![确认发布][api-management-publish-template-confirm]\r \r 若要发布所有当前未发布的模板版本，请单击模板列表中的“发布”。 未发布的模板由跟在模板名称之后的星号予以指示。 在此示例中，将发布“产品列表”和“产品”模板。\r \r ![发布模板][api-management-publish-templates]\r \r 单击“发布自定义”进行确认。\r \r ![确认发布][api-management-publish-customizations]\r \r 新发布的模板在开发人员门户中立即生效。\r \r ## <a name=\"to-revert-a-template-to-the-previous-version\"></a>将模板还原到以前版本\r 要将模板还原到以前发布的版本，请单击模板编辑器中的“还原”。\r \r ![还原模板][api-management-revert-template]\r \r 单击“是”进行确认。\r \r ![确认][api-management-revert-template-confirm]\r \r 还原操作完成后，模板的以前发布的版本在开发人员门户中生效。\r \r ## <a name=\"to-restore-a-template-to-the-default-version\"></a>将模板还原到默认版本\r 将模板还原到其默认版本的过程分为两步。 首先，必须还原模板，然后必须发布还原后的版本。\r \r 若要将单个模板还原到默认版本，请在模板编辑器中单击“还原”。\r \r ![还原模板][api-management-reset-template]\r \r 单击“是”进行确认。\r \r ![确认][api-management-reset-template-confirm]\r \r 若要将所有模板还原到其默认版本，请单击模板列表中的“还原默认模板”。\r \r ![还原模板][api-management-restore-templates]\r \r 然后，必须按照[发布模板](#to-publish-a-template)中的步骤分别或一起发布还原后的所有模板。\r \r ## <a name=\"next-steps\"></a>后续步骤\r 有关开发人员门户模板、字符串资源、图标和页面控件的参考信息，请参阅 [API 管理开发人员门户模板参考](./api-management-developer-portal-templates-reference.md)。\r \r [modify-content-layout]: ./api-management-modify-content-layout.md\r [customize-styles]: ./api-management-customize-styles.md\r [portal-templates]: ./api-management-developer-portal-templates.md\r \r [api-management-customize-menu]: ./media/api-management-developer-portal-templates/api-management-customize-menu.png\r [api-management-templates-menu]: ./media/api-management-developer-portal-templates/api-management-templates-menu.png\r [api-management-developer-portal-templates-overview]: ./media/api-management-developer-portal-templates/api-management-developer-portal-templates-overview.png\r [api-management-template]: ./media/api-management-developer-portal-templates/api-management-template.png\r [api-management-template-data]: ./media/api-management-developer-portal-templates/api-management-template-data.png\r [api-management-developer-portal-menu]: ./media/api-management-developer-portal-templates/api-management-developer-portal-menu.png\r [api-management-management-console]: ./media/api-management-developer-portal-templates/api-management-management-console.png\r [api-management-browse]: ./media/api-management-developer-portal-templates/api-management-browse.png\r [api-management-user-profile-templates]: ./media/api-management-developer-portal-templates/api-management-user-profile-templates.png\r [api-management-save-template]: ./media/api-management-developer-portal-templates/api-management-save-template.png\r [api-management-publish-template]: ./media/api-management-developer-portal-templates/api-management-publish-template.png\r [api-management-publish-template-confirm]: ./media/api-management-developer-portal-templates/api-management-publish-template-confirm.png\r [api-management-publish-templates]: ./media/api-management-developer-portal-templates/api-management-publish-templates.png\r [api-management-publish-customizations]: ./media/api-management-developer-portal-templates/api-management-publish-customizations.png\r [api-management-revert-template]: ./media/api-management-developer-portal-templates/api-management-revert-template.png\r [api-management-revert-template-confirm]: ./media/api-management-developer-portal-templates/api-management-revert-template-confirm.png\r [api-management-reset-template]: ./media/api-management-developer-portal-templates/api-management-reset-template.png\r [api-management-reset-template-confirm]: ./media/api-management-developer-portal-templates/api-management-reset-template-confirm.png\r [api-management-restore-templates]: ./media/api-management-developer-portal-templates/api-management-restore-templates.png\r \r \r \r \r \r \r \r "}