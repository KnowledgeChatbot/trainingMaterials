{"Title":"Azure PowerShell 脚本示例 - 打开负载均衡器中的应用程序端口","Description":"Azure PowerShell 脚本示例 - 打开 Azure 负载均衡器中 Service Fabric 应用程序的端口。","Content":"# <a name=\"open-an-application-port-in-the-azure-load-balancer\"></a>打开 Azure 负载均衡器中的应用程序端口\r \r 正在 Azure 中运行的 Service Fabric 应用程序位于 Azure 负载均衡器后。 此示例脚本将打开 Azure 负载均衡器中的端口，以便 Service Fabric 应用程序可与外部客户端通信。 根据需要自定义参数。 \r \r 必要时，使用 [Service Fabric SDK](../service-fabric-get-started.md) 安装 Service Fabric PowerShell 模块。 \r \r ## <a name=\"sample-script\"></a>示例脚本\r \r ```powershell\r # Variables\r $probename = \"AppPortProbe6\"\r $rulename=\"AppPortLBRule6\"\r $RGname=\"mysftestclustergroup\"\r $port=8303\r \r # Get the load balancer resource\r $resource = Get-AzureRmResource | Where {$_.ResourceGroupName -eq $RGname -and $_.ResourceType -eq \"Microsoft.Network/loadBalancers\"} \r $slb = Get-AzureRmLoadBalancer -Name $resource.Name -ResourceGroupName $RGname\r \r # Add a new probe configuration to the load balancer\r $slb | Add-AzureRmLoadBalancerProbeConfig -Name $probename -Protocol Tcp -Port $port -IntervalInSeconds 15 -ProbeCount 2\r \r # Add rule configuration to the load balancer\r $probe = Get-AzureRmLoadBalancerProbeConfig -Name $probename -LoadBalancer $slb\r $slb | Add-AzureRmLoadBalancerRuleConfig -Name $rulename -BackendAddressPool $slb.BackendAddressPools[0] -FrontendIpConfiguration $slb.FrontendIpConfigurations[0] -Probe $probe -Protocol Tcp -FrontendPort $port -BackendPort $port\r \r # Set the goal state for the load balancer\r $slb | Set-AzureRmLoadBalancer\r \r ```\r \r ## <a name=\"script-explanation\"></a>脚本说明\r \r 此脚本使用以下命令。 表中的每条命令链接到特定于命令的文档。\r \r | 命令 | 说明 |\r |---|---|\r | [Get-AzureRmResource](https://docs.microsoft.com/powershell/module/azurerm.resources/get-azurermresource) | 获取 Azure 资源。  |\r | [Get-AzureRmLoadBalancer](https://docs.microsoft.com/powershell/module/azurerm.network/get-azurermloadbalancer) | 获取 Azure 负载均衡器。 |\r | [Add-AzureRmLoadBalancerProbeConfig](https://docs.microsoft.com/powershell/module/azurerm.network/add-azurermloadbalancerprobeconfig) | 向负载均衡器添加探测配置。|\r | [Get-AzureRmLoadBalancerProbeConfig](https://docs.microsoft.com/powershell/module/azurerm.network/get-azurermloadbalancerprobeconfig) | 获取负载均衡器的探测配置。 |\r | [Add-AzureRmLoadBalancerRuleConfig](https://docs.microsoft.com/powershell/module/azurerm.network/add-azurermloadbalancerruleconfig) | 向负载均衡器添加规则配置。 |\r | [Set-AzureRmLoadBalancer](https://docs.microsoft.com/powershell/module/azurerm.network/set-azurermloadbalancer) | 设置负载均衡器的目标状态。 |\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 有关 Azure PowerShell 模块的详细信息，请参阅 [Azure PowerShell 文档](https://docs.microsoft.com/powershell/azure/overview)。\r \r 可以在 [Azure PowerShell 示例](../service-fabric-powershell-samples.md)中找到 Azure Service Fabric 的其他 Powershell 示例。\r \r <!--Update_Description: update meta properties -->"}