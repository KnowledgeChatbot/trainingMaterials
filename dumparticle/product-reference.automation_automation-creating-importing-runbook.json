{"Title":"在 Azure 自动化中创建或导入 Runbook","Description":"本文介绍了如何在 Azure 自动化中创建新的 Runbook，或如何从文件中导入 Runbook。","Content":"# <a name=\"creating-or-importing-a-runbook-in-azure-automation\"></a>在 Azure 自动化中创建或导入 Runbook\r 可以通过以下方法将 Runbook 添加到 Azure 自动化：[创建新的 Runbook](#creating-a-new-runbook)；从文件或 [Runbook 库](automation-runbook-gallery.md)导入现有 Runbook。 本文介绍如何通过文件创建和导入 Runbook。  可以在 [Azure 自动化的 Runbook 和模块库](automation-runbook-gallery.md)中获取有关如何访问社区 Runbook 和模块的所有详细信息。\r \r ## <a name=\"creating-a-new-runbook\"></a> 创建新的 Runbook\r 可以使用一个 Azure 经典管理门户或 Windows PowerShell 在 Azure 自动化中创建一个新的 Runbook。 一旦创建了 Runbook，便可以利用[了解 PowerShell 工作流](automation-powershell-workflow.md)中的信息对其进行编辑。\r \r ### <a name=\"to-create-a-new-azure-automation-runbook-with-the-azure-classic-management-portal\"></a>使用 Azure 经典管理门户创建新的 Azure 自动化 Runbook\r 只能使用 Azure 经典管理门户中的 PowerShell 工作流 Runbook。\r \r 1. 在 Azure 经典管理门户中，依次单击“新建”、“应用程序服务”、“自动化”、“Runbook”、“快速创建”。\r 2. 输入所需信息，然后单击“创建”。 Runbook 名称必须以字母开头，可以使用字母、数字、下划线和短划线。\r 3. 若要立即编辑 Runbook，则请单击“编辑 Runbook” 。 否则，请单击“确定”。\r 4. 新的 Runbook 将出现在“Runbook”选项卡中。\r \r ### <a name=\"to-create-a-new-azure-automation-runbook-with-windows-powershell\"></a>使用 Windows PowerShell 创建新的 Azure 自动化 Runbook\r 可以使用 [New-AzureAutomationRunbook](https://msdn.microsoft.com/library/dn690272.aspx) cmdlet 创建空的 PowerShell 工作流 Runbook。 可以通过指定 Name 参数来创建空的 Runbook 以便稍后编辑，也可以通过指定 Path 参数导入脚本文件。 \r \r 以下示例命令演示了如何创建新的空 Runbook。\r \r     $automationAccountName = \"MyAutomationAccount\"\r     $runbookName = \"Sample-TestRunbook\"\r     New-AzureAutomationRunbook -AutomationAccountName $automationAccountName -Name $runbookName\r \r ## <a name=\"ImportRunbook\"></a> 将 Runbook 从文件导入 Azure 自动化\r 可以通过导入 PowerShell 工作流（扩展名为 .ps1）在 Azure 自动化中创建一个新的 Runbook。\r \r 如果该文件包含多个 PowerShell 工作流，导入将失败。 必须将每个工作流保存到各自的文件中，并分别导入每个工作流。\r \r ### <a name=\"to-import-a-runbook-from-a-file-with-the-azure-classic-management-portal\"></a>使用 Azure 经典管理门户从文件导入 Runbook\r 可通过以下过程将脚本文件导入 Azure 自动化。 请注意，你只能通过此门户将 .ps1 文件导入 PowerShell 工作流 Runbook。\r \r 1. 在 Azure 经典管理门户中，选择“自动化”，然后选择一个自动化帐户。\r 2. 单击“导入”。\r 3. 单击“浏览文件”，找到要导入的脚本文件。\r 4. 若要立即编辑 Runbook，则请单击“编辑 Runbook” 。 否则，请单击“确定”。\r 5. 新的 Runbook 将出现在自动化帐户的“Runbook”选项卡中。\r 6. 必须先 [发布 Runbook](#publishing-a-runbook) ，然后才能运行它。\r \r ### <a name=\"ImportRunbookScriptPS\"></a> 使用 Windows PowerShell 从脚本文件导入 Runbook\r 可以使用 [Set-AzureAutomationRunbookDefinition](https://msdn.microsoft.com/library/dn690267.aspx) cmdlet 将脚本文件导入到现有 Runbook 的草稿版本中。 脚本文件必须包含单个 Windows PowerShell 工作流。 如果 Runbook 已有草稿版本，则除非你使用 Overwrite 参数，否则导入将失败。 导入 Runbook 后，可以使用 [Publish-AzureAutomationRunbook](https://msdn.microsoft.com/library/dn690266.aspx) 进行发布。\r \r 下面的示例命令演示了如何将脚本文件导入到 Runbook 中。\r \r     $automationAccountName =  \"AutomationAccount\"\r     $runbookName = \"Sample_TestRunbook\"\r     $scriptPath = \"C:\\Runbooks\\Sample_TestRunbook.ps1\"\r \r     Set-AzureAutomationRunbookDefinition -AutomationAccountName $automationAccountName -Name $runbookName -Path $ scriptPath -Overwrite\r     Publish-AzureAutomationRunbook -AutomationAccountName $automationAccountName -Name $runbookName\r \r ## <a name=\"publishing-a-runbook\"></a> 发布 Runbook\r 创建或导入新的 Runbook 时，必须先将其发布，然后才能导入。  自动化中的每个 Runbook 都有草稿版和已发布版。 只有已发布版才能用来运行，只有草稿版才能用来编辑。 已发布版不受对草稿版所做的任何更改的影响。 当草稿版可以使用时，你可以发布草稿版，这样草稿版就会覆盖已发布版。\r \r ## <a name=\"to-publish-a-runbook-using-the-azure-classic-management-portal\"></a>使用 Azure 经典管理门户发布 Runbook\r 1. 在 Azure 经典管理门户中打开 Runbook。\r 2. 在屏幕顶部，单击“创作”。\r 3. 在屏幕底部，单击“发布”，然后在出现验证消息时单击“是”。\r \r ## <a name=\"to-publish-a-runbook-using-windows-powershell\"></a>使用 Windows PowerShell 发布 Runbook\r 可以使用 Windows PowerShell，通过 [Publish-AzureAutomationRunbook](https://msdn.microsoft.com/library/dn690266.aspx) cmdlet 发布 Runbook。 以下示例命令显示了如何发布示例 Runbook。\r \r     $automationAccountName = \"AutomationAccount\"\r     $runbookName = \"Sample_TestRunbook\"\r \r     Publish-AzureAutomationRunbook -AutomationAccountName $automationAccountName -Name $runbookName\r \r ## <a name=\"next-steps\"></a>后续步骤\r * 若要了解如何从 Runbook 和 PowerShell 模块库中受益，请参阅 [Azure 自动化的 Runbook 和模块库](automation-runbook-gallery.md)\r * 若要深入了解使用文本编辑器编辑 PowerShell 和 PowerShell 工作流 Runbook，请参阅[在 Azure 自动化中编辑文本 Runbook](automation-edit-textual-runbook.md)"}