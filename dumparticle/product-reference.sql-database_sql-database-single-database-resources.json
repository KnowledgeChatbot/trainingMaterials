{"Title":"Azure SQL 数据库单一数据库","Description":"管理单个 Azure SQL 数据库的服务层、性能级别和存储量。","Content":"# <a name=\"manage-resources-for-a-single-database-in-azure-sql-database\"></a>管理 Azure SQL 数据库中单一数据库的资源\r \r 对于单一数据库，需要确定数据库处理在服务层、性能级别的工作负荷所需的资源量，以及所需的存储量。 \r \r ## <a name=\"manage-single-database-resources-using-the-azure-portal\"></a>使用 Azure 门户管理单一数据库资源\r \r 若要使用 Azure 门户为新的或现有 Azure SQL 数据库设置或更改服务层、性能级别或存储量，请单击“定价层(缩放 DTU)”打开数据库的“配置性能”窗口 - 如以下屏幕截图中所示。 \r \r - 通过为工作负荷选择服务层来设置或更改服务层。 \r - 使用“DTU”滑块在服务层内设置或更改性能级别 (**DTU**)。\r - 使用“存储”滑块为性能级别设置或更改存储量。 \r \r ![配置服务层和性能级别](./media/sql-database-single-database-resources/change-service-tier.png)\r \r \r ## <a name=\"manage-single-database-resources-using-powershell\"></a>使用 PowerShell 管理单一数据库资源\r \r 若要使用 PowerShell 设置或更改 Azure SQL 数据库服务层、性能级别和存储量，请使用以下 PowerShell cmdlet。 如果需要安装或升级 PowerShell，请参阅[安装 Azure PowerShell 模块](https://docs.microsoft.com/powershell/azure/install-azurerm-ps)。 \r \r | Cmdlet | 说明 |\r | --- | --- |\r |[New-AzureRmSqlDatabase](https://docs.microsoft.com/powershell/module/azurerm.sql/new-azurermsqldatabase)|创建数据库 |\r |[Get-AzureRmSqlDatabase](https://docs.microsoft.com/powershell/module/azurerm.sql/get-azurermsqldatabase)|获取一个或多个数据库|\r |[Set-AzureRmSqlDatabase](https://docs.microsoft.com/powershell/module/azurerm.sql/set-azurermsqldatabase)|设置数据库的属性，或将现有数据库移到弹性池中。 例如，使用 MaxSizeBytes 属性来设置数据库的最大大小。|\r \r \r > [!TIP]\r > 可以使用 PowerShell 脚本监视数据库的性能指标，将其缩放到更高的性能级别，并基于性能指标之一创建警报规则，有关这样的示例脚本，请参阅[使用 PowerShell 监视和缩放单一 SQL 数据库](scripts/sql-database-monitor-and-scale-database-powershell.md)。\r \r ## <a name=\"manage-single-database-resources-using-the-azure-cli\"></a>使用 Azure CLI 管理单一数据库资源\r \r 若要使用 Azure CLI 设置或更改 Azure SQL 数据库服务层、性能级别和存储量，请使用以下 [Azure CLI SQL 数据库](/cli/sql/db)命令。 在 macOS、 Linux 或 Windows 上[安装](/cli/install-azure-cli) CLI。 若要创建并管理 SQL 弹性池，请参阅[弹性池](sql-database-elastic-pool.md)。\r \r | Cmdlet | 说明 |\r | --- | --- |\r |[az sql server firewall-rule create](/cli/sql/server/firewall-rule#az_sql_server_firewall_rule_create)|配置服务器防火墙规则|\r |[az sql server firewall-rule list](/cli/sql/server/firewall-rule#az_sql_server_firewall_rule_list)|列出服务器上的防火墙规则|\r |[az sql server firewall-rule show](/cli/sql/server/firewall-rule#az_sql_server_firewall_rule_show)|显示防火墙规则的详细信息|\r |[az sql server firewall-rule update](/cli/sql/server/firewall-rule##az_sql_server_firewall_rule_update)|更新防火墙规则|\r |[az sql server firewall-rule delete](/cli/sql/server/firewall-rule#az_sql_server_firewall_rule_delete)|删除防火墙规则。|\r \r \r > [!TIP]\r > 可以使用 Azure CLI 脚本在查询数据库的大小信息后将单一 Azure SQL 数据库缩放到不同的性能级别，有关这样的示例脚本，请参阅[使用 CLI 监视和缩放单一 SQL 数据库](scripts/sql-database-monitor-and-scale-database-cli.md)。\r >\r \r ## <a name=\"manage-single-database-resources-using-transact-sql\"></a>使用 Transact-SQL 管理单一数据库资源\r \r 若要使用 Transact-SQL 设置或更改 Azure SQL 数据库服务层、性能级别和存储量，请使用以下 T-SQL 命令。 可以使用 Azure 门户、[SQL Server Management Studio](/sql/ssms/use-sql-server-management-studio)、[Visual Studio Code](https://code.visualstudio.com/docs) 或可以连接到 Azure SQL 数据库服务器并传递 Transact-SQL 命令的其他任何程序，发出这些命令。 \r \r | 命令 | 说明 |\r | --- | --- |\r |[CREATE DATABASE（Azure SQL 数据库）](https://docs.microsoft.com/sql/t-sql/statements/create-database-azure-sql-database)|新建数据库。 必须连接到 master 数据库才能新建数据库。|\r | [ALTER DATABASE（Azure SQL 数据库）](https://docs.microsoft.com/sql/t-sql/statements/alter-database-azure-sql-database) |修改 Azure SQL 数据库。 |\r |[sys.database_service_objectives（Azure SQL 数据库）](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-database-service-objectives-azure-sql-database)|返回 Azure SQL 数据库或 Azure SQL 数据仓库的版本（服务层）、服务目标（定价层）和弹性池名称（若有）。 如果已登录到 Azure SQL 数据库服务器中的 master 数据库，则会返回所有数据库的相关信息。 对于 Azure SQL 数据仓库，必须连接到 master 数据库。|\r |[sys.database_usage（Azure SQL 数据库）](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-database-usage-azure-sql-database)|列出 Azure SQL 数据库服务器上的数据库的数目、类型和持续时间。|\r \r 以下示例演示如何使用 ALTER DATABASE 命令更改数据库的最大大小：\r \r  ```sql\r ALTER DATABASE <myDatabaseName> \r    MODIFY (MAXSIZE = 4096 GB);\r ```\r \r ## <a name=\"manage-single-database-resources-using-the-rest-api\"></a>使用 REST API 管理单一数据库资源\r \r 若要设置或更改 Azure SQL 数据库服务层、性能级别和存储量，请使用以下 REST API 请求。\r \r | 命令 | 说明 |\r | --- | --- |\r |[数据库 - 创建或更新](https://docs.microsoft.com/rest/api/sql/databases/createorupdate)|创建新数据库或更新现有数据库。|\r |[数据库 - 获取](https://docs.microsoft.com/rest/api/sql/databases/get)|获取数据库。|\r |[数据库 - 按弹性池获取](https://docs.microsoft.com/rest/api/sql/databases/getbyelasticpool)|获取弹性池内的数据库。|\r |[数据库 - 按推荐的弹性池获取](https://docs.microsoft.com/rest/api/sql/databases/getbyrecommendedelasticpool)|获取推荐弹性池内的数据库。|\r |[数据库 - 按弹性池列出](https://docs.microsoft.com/rest/api/sql/databases/listbyelasticpool)|返回弹性池中数据库的列表。|\r |[数据库 - 按推荐的弹性池列出](https://docs.microsoft.com/rest/api/sql/databases/listbyrecommendedelasticpool)|返回推荐弹性池内的数据库列表。|\r |[数据库 - 按服务器列出](https://docs.microsoft.com/rest/api/sql/databases/listbyserver)|返回服务器中的数据库列表。|\r |[数据库 - 更新](https://docs.microsoft.com/api/sql/databases/update)|更新现有的数据库。|\r \r \r \r ## <a name=\"next-steps\"></a>后续步骤\r \r - 要了解关于服务层、性能级别和存储量的相关信息，请参阅[服务层](sql-database-service-tiers.md)。\r - 有关弹性池的信息，请参阅[弹性池](sql-database-elastic-pool.md)。\r <!--Update_Description:update Global CLI 2.0 links to Mooncake CLI 2.0 links-->"}