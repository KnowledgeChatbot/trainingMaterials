{"Title":"自定义 Azure 应用程序网关的 Web 应用程序防火墙规则 - PowerShell","Description":"此页提供有关如何使用 PowerShell 自定义应用程序网关的 Web 应用程序防火墙规则的信息。","Content":"# <a name=\"customize-web-application-firewall-rules-through-powershell\"></a>通过 PowerShell 自定义 Web 应用程序防火墙规则\r \r > [!div class=\"op_single_selector\"]\r > * [Azure 门户](application-gateway-customize-waf-rules-portal.md)\r > * [PowerShell](application-gateway-customize-waf-rules-powershell.md)\r > * [Azure CLI 2.0](application-gateway-customize-waf-rules-cli.md)\r \r 应用程序网关 Web 应用程序防火墙可为 Web 应用程序提供保护。 这些保护由 OWASP CRS 规则集提供。 某些规则可能会导致误报，并会阻止实际流量。  出于此原因，应用程序网关在启用了 Web 应用程序防火墙的应用程序网关上提供自定义规则组和规则的功能。 有关特定规则组和规则的详细信息，请访问 [Web 应用程序防火墙 CRS 规则组和规则](application-gateway-crs-rulegroups-rules.md)\r \r ## <a name=\"view-rule-groups-and-rules\"></a>查看规则组和规则\r \r 以下示例演示如何查看可在启用了 WAF 的应用程序网关上配置的规则和规则组。\r \r ### <a name=\"view-rule-groups\"></a>查看规则组\r \r ```powershell\r Get-AzureRmApplicationGatewayAvailableWafRuleSets\r ```\r \r 下面是截取自前一示例的响应。\r \r ```\r OWASP (Ver. 3.0):\r \r     REQUEST-910-IP-REPUTATION:\r         Description:\r             \r         Rules:\r             RuleId     Description\r             ------     -----------\r             910011     Rule 910011\r             910012     Rule 910012\r             ...        ...\r \r     REQUEST-911-METHOD-ENFORCEMENT:\r         Description:\r             \r         Rules:\r             RuleId     Description\r             ------     -----------\r             911011     Rule 911011\r             ...        ...\r \r OWASP (Ver. 2.2.9):\r \r     crs_20_protocol_violations:\r         Description:\r             \r         Rules:\r             RuleId     Description\r             ------     -----------\r             960911     Invalid HTTP Request Line\r             981227     Apache Error: Invalid URI in Request.\r             960000     Attempted multipart/form-data bypass\r             ...        ...\r ```\r \r ## <a name=\"disable-rules\"></a>禁用规则\r \r 以下示例在应用程序网关上禁用规则 `910018` 和 `910017`。\r \r ```azurecli\r az network application-gateway waf-config set --resource-group AdatumAppGatewayRG --gateway-name AdatumAppGateway --enabled true --rule-set-version 3.0 --disabled-rules 910018 910017\r ```\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 配置已禁用的规则后，可通过访问[应用程序网关诊断](application-gateway-diagnostics.md#diagnostic-logs)来了解如何查看 WAF 日志\r \r [fig1]: ./media/application-gateway-customize-waf-rules-portal/1.png\r [1]: ./media/application-gateway-customize-waf-rules-portal/figure1.png\r [2]: ./media/application-gateway-customize-waf-rules-portal/figure2.png\r [3]: ./media/application-gateway-customize-waf-rules-portal/figure3.png\r \r "}