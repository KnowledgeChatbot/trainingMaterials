{"Title":"Azure 计费企业 API","Description":"了解使企业 Azure 客户能够以编程方式提取消耗数据的报告 API。","Content":"# <a name=\"overview-of-reporting-apis-for-enterprise-customers\"></a>面向企业客户的报告 API 概述\r Microsoft Enterprise Azure 客户可通过 REST 或 JSON API 访问使用量和计费信息。企业管理员需要通过从 Enterprise Azure 门户生成密钥来启用对 API 的访问权限。获得合约编号和密钥的任何人均可访问 API\r \r ## <a name=\"enabling-data-access-to-the-api\"></a>启用通过API的数据访问 \r * 现在， Microsoft Enterprise Azure 客户可通过 API 访问使用量和计费信息。 \r * 企业管理员通过访问密钥控制对API的访问权限\r \r * 企业管理员可以执行企业门户中“报告 à API 访问密钥”下的的以下功能：\r \r 1. 生成主访问密钥和次要访问密钥\r 2. 禁用访问密钥 \r 3. 查看访问密钥的开始日期和结束日期 \r \r \r ## <a name=\"Reports available through the API\"></a>可通过API获得的报告 \r 可以获得两个不同的报告： \r \r  a.合约摘要 CSV 文件： 此报告包含与本月合约摘要相关的信息。此报告包含的信息和格式与在 EA 门户的“下载使用量数据”部分获得的“余额和费用”报告相同。   \r \r b.使用量和计费详细信息 CSV 文件： 此报告包含与服务使用量和计费相关的详细信息。此报告包含的信息和格式与在 EA 门户的“ 下载使用量数据”部分获得的“使用量详细信息”报告相同。\r \r \r ## <a name=\"API details\"></a>API详细信息 \r \r REST或JSON API用于获取CSV文件。可以使用两个不同的 API ：   \r \r 1.GetUsageList API： 提供的 JSON 字符串所列出的月份会提供使用量摘要和详细报告。返回的信息包含调用 GetUsageByMonth API 的URI。  \r \r 2.GetUsageByMonth API： 此 API 使用户能够下载“合约摘要 CSV”二进制数组和“使用量和计费详细信息CSV”二进制数组。\r \r 3.关于技术规范文档和示例代码，请登录EA Portal 帮助文档查看\r \r \r ## <a name=\"Update frequency of the usage and billing data \"></a>使用量和计费数据的更新频率 \r \r * 目前文件每24小时更新一次。\r * 可能存在长达3天的数据延迟。例如，周一的使用量可能会到周四才会在文件中显示。  \r 调用API进行POC/开发：  \r \r *如果你是合作伙伴或开发人员并要访问API，但没有Enterprise Azure合约，则可以使用测试合约 (EnrollmentNumber 100) 和 测试合约访问密钥来调用 API并查看示例数据。 \r \r ## <a name=\"Azure service catalog\"></a> Azure服务目录 \r \r 我们在 Blob上以CSV格式发布了所有Azure 服务的目录。如果你需要为你的系统构建所有 Azure 服务的特选目录，则此目录很有用。该文件每月更新两次，在每月 5 日和 20日或该日期之前发布。目录 URL：    https://azurepricing.blob.core.windows.net/supplemental/Friendly_Service_Names.xlsx \r \r ## <a name=\"Catalog Column Details\"></a>目录列详细信息\r \r 产品  :   此字段包含服务名称。例如： “ A1 VM (非 Windows) - 美国东部”\r \r ResourceGUID   :   是标识服务的唯一键。详细使用量 CSV 也包含 \r \r ResourceGUID，此字段应该用于在该目录和详细使用量之间进行交叉引用。 \r \r 顶级服务分类  :   帮助缩小服务范围。对于具有多个服务类型的服务特别重要，例如： 虚拟机。  \r \r 服务类型  :   提供有关服务的第二级详细信息。例如： A1 VM（ 非 Windows）   \r \r 服务区域  :   这是服务所需的第三级详细信息，此字段有助于将范围缩小到 ResourceGUID 的区域上下文。\r \r 服务资源  :    这是第四级也是最后一级详细信息，此字段有助于将范围缩小到所用的服务资源。将此字段与“服务”、“服务类型”和“服务区域”结合使用可提供完整的服务上下文。例如： “  Azure 存储空间-地理冗余-所有区域-标准 IO - 块 Blob (GB)”和“Azure 存储空间-地理冗余-所有区域-标准 IO - 文件(GB)”。这两个示例中的突出显示部分为“服务资源”，请注意服务的其他详细信息没有更改。   \r \r 度量单位  :   示例值： 小时、 GB、事件、推送、单位、单位小时、MB、每日单位   \r \r 套餐产品编号  :   当客户在 EA 上有资金承诺时应针对定价进行交叉引用的 EA 产品编号。   \r \r 每单位套餐用量  :   此字段提供 1 个单位的 EA SKU 中包括的服务数。例如： 当每个 SKU 表示使用 100 小时，EA 虚拟机 SKU 的此值将为 100。   \r \r 使用产品编号  :   当客户在 EA 上没有资金承诺时应针对定价进行交叉引用的 EA 产品编号。 \r \r 每单位使用量  :   此字段提供 1 个单位的 EA SKU 中包括的服务数。例如： 当每个 SKU 表示使用 100 小时，EA 虚拟机 SKU 的此值将为 100。   \r \r 报告月份  :   此字段指示运行该服务目录报告的月份。\r \r  \r \r \r \r \r \r \r \r \r \r "}