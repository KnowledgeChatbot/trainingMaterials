{"Title":"Azure SQL 数据库自动化异地冗余备份","Description":"SQL 数据库每隔几分钟会自动创建一个本地数据库备份，使用 Azure 读取访问异地冗余存储来提供异地冗余。","Content":"# <a name=\"learn-about-automatic-sql-database-backups\"></a>了解 SQL 数据库自动备份\r \r SQL 数据库会自动创建数据库备份，并使用 Azure 读取访问异地冗余存储 (RA-GRS) 来提供异地冗余。 可以自动创建这些备份且不收取额外费用。 不需要执行任何操作就能进行这样的备份。 数据库备份是任何业务连续性和灾难恢复策略的基本组成部分，因为数据库备份可以保护数据免遭意外损坏或删除。 \r \r ## <a name=\"what-is-a-sql-database-backup\"></a>什么是 SQL 数据库备份？\r \r SQL 数据库使用 SQL Server 技术创建[完整](https://msdn.microsoft.com/library/ms186289.aspx)、[差异](https://msdn.microsoft.com/library/ms175526.aspx)和[事务日志](https://msdn.microsoft.com/library/ms191429.aspx)备份。 一般每隔 5-10 分钟创建一次事务日志备份，具体频率取决于性能级别和数据库活动量。 借助事务日志备份以及完整备份和差异备份，可将数据库还原到托管数据库的服务器上的特定时间点。 还原数据库时，服务会确定需要还原哪些完整、差异和事务日志备份。\r \r \r 可使用这些备份：\r \r * 在保留期内将数据库还原到某个时间点。 此操作会在与原始数据库相同的服务器中创建新数据库。\r * 将已删除的数据库还原到删除时的时间点或保留期内的任意时间点。 仅可在创建原始数据库所在的同一服务器中还原已删除的数据库。\r * 将数据库还原到其他地理区域。 在无法访问服务器和数据库的情况下，此操作可帮助从地理位置灾难中恢复。 它会在全球任意位置的任意现有服务器中创建新数据库。 \r * 从 Azure 恢复服务保管库中存储的特定备份还原数据库。 此操作允许还原旧版本的数据库，以满足符合性请求或运行旧版本的应用程序。\r * 若要执行还原，请参阅[从备份还原数据库](sql-database-recovery-using-backups.md)。\r \r > [!NOTE]\r > 在 Azure 存储中，术语“复制”指将文件从一个位置复制到另一个位置。 SQL 数据库复制指让多个辅助数据库与主数据库保持同步。 \r > \r \r ## <a name=\"how-much-backup-storage-is-included-at-no-cost\"></a>免费附送的备份存储空间有多少？\r SQL 数据库提供的备份存储容量高达最大预配数据库存储空间的两倍，不收取任何额外费用。 例如，如果有一个标准数据库实例并且预配的数据库大小为 250 GB，则可以免费获得 500 GB 的备份存储空间。 如果数据库超过提供的备份存储空间，则可以选择与 Azure 支持联系来缩短保留期。 另一种做法是按照标准读取访问异地冗余存储 (RA-GRS) 费率付费购买额外的备份存储空间。 \r \r ## <a name=\"how-often-do-backups-happen\"></a>多久备份一次？\r 每周执行一次完整数据库备份，通常每隔数小时执行一次差异数据库备份，通常每隔 5-10 分钟执行一次事务日志备份。 会在数据库创建后立即计划第一次完整备份。 完整备份通常可在 30 分钟内完成，但如果数据库很大，花费的时间可能更长。 例如，对已还原的数据库或数据库副本执行初始备份可能需要更长时间。 在完成首次完整备份后，在后台以静默方式自动计划和管理所有后续备份。 在平衡整体系统工作负荷时，SQL 数据库服务会确定所有数据库备份的确切时间。 \r \r 备份存储异地复制根据 Azure 存储复制计划执行。\r \r ## <a name=\"how-long-do-you-keep-my-backups\"></a>备份的保留时间有多长？\r 每个 SQL 数据库备份都有一个保留期，该期限基于数据库的[服务层](sql-database-service-tiers.md)。 各服务层中数据库的保留期如下：\r \r \r * 基本服务层为 7 天。\r * 标准服务层为 14 天。\r * 高级服务层为 35 天。\r \r 如果将数据库从标准或高级服务层降级到基本服务层，备份将保存 7 天。 超过 7 天的所有现有备份不再可用。 \r \r 如果将数据库从基本服务层升级到标准或高级服务层，SQL 数据库将保存现有备份，直到超过 35 天。 此时创建的新备份保存 35 天。\r \r 如果删除了某个数据库，SQL 数据库以保存联机数据库的相同方式保存其备份。 例如删除了保留期为 7 天的某个基本数据库。 已保存 4 天的备份将继续保存 3 天。\r \r > [!IMPORTANT]\r > 如果删除了托管 SQL 数据库的 Azure SQL 服务器，则属于该服务器的所有数据库也会被删除且不可恢复。 无法还原已删除的服务器。\r > \r \r ## <a name=\"are-backups-encrypted\"></a>备份已加密？\r \r 为 Azure SQL 数据库启用 TDE 时，也会加密备份。 默认情况下，所有新的 Azure SQL 数据库都配置为启用 TDE。 有关 TDE 的详细信息，请参阅[使用 Azure SQL 数据库进行透明数据加密](https://docs.microsoft.com/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql)。\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r - 数据库备份是任何业务连续性和灾难恢复策略的基本组成部分，因为数据库备份可以保护数据免遭意外损坏或删除。 若要了解其他 Azure SQL 数据库业务连续性解决方案，请参阅[业务连续性概述](sql-database-business-continuity.md)。\r - 要使用 Azure 门户还原到某个时间点，请参阅[使用 Azure 门户将数据库还原到某个时间点](sql-database-recovery-using-backups.md)。\r - 要使用 PowerShell 还原到某个时间点，请参阅[使用 PowerShell 将数据库还原到某个时间点](scripts/sql-database-restore-database-powershell.md)。\r <!--Update_Description: add next steps-->"}