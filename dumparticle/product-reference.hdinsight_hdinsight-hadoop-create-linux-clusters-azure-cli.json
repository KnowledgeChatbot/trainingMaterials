{"Title":"使用命令行创建 Hadoop 群集 - Azure HDInsight","Description":"了解如何使用跨平台 Azure CLI 1.0 创建 HDInsight 群集。","Content":"# <a name=\"create-hdinsight-clusters-using-the-azure-cli\"></a>使用 Azure CLI 创建 HDInsight 群集\r \r [!INCLUDE [selector](../../includes/hdinsight-create-linux-cluster-selector.md)]\r \r 本文介绍了使用 Azure CLI 1.0 创建 HDInsight 3.5 群集的相关步骤。\r \r [!INCLUDE [hdinsight-linux-acn-version.md](../../includes/hdinsight-linux-acn-version.md)]\r \r > [!IMPORTANT]\r > Linux 是在 HDInsight 3.4 版或更高版本上使用的唯一操作系统。 有关详细信息，请参阅 [HDInsight 在 Windows 上停用](hdinsight-component-versioning.md#hdinsight-windows-retirement)。\r \r ## <a name=\"prerequisites\"></a>先决条件\r \r [!INCLUDE [delete-cluster-warning](../../includes/hdinsight-delete-cluster-warning.md)]\r \r * **一个 Azure 订阅**。 请参阅[获取 Azure 试用版](https://www.azure.cn/pricing/1rmb-trial/)。\r \r * **Azure CLI**。 本文档中的步骤最近已使用 Azure CLI 版本 0.10.14 进行测试。\r \r     > [!IMPORTANT]\r     > 本文中的步骤不适用于 Azure CLI 2.0。 Azure CLI 2.0 不支持创建 HDInsight 群集。\r \r ## <a name=\"log-in-to-your-azure-subscription\"></a>登录到 Azure 订阅\r \r 按照 [从 Azure 命令行接口 (Azure CLI) 连接到 Azure 订阅](../xplat-cli-connect.md) 中所述的步骤，使用 **登录** 方法连接到订阅。\r \r ## <a name=\"create-a-cluster\"></a>创建群集\r \r 应通过命令行（例如 PowerShell 或 Bash）执行以下步骤。\r \r 1. 使用以下命令进行 Azure 订阅的身份验证：\r \r         azure login -e AzureChinaCloud\r \r     系统提示提供用户名与密码。 如果有多个 Azure 订阅，可以使用 `azure account set <subscriptionname>` 来设置 Azure CLI 命令要使用的订阅。\r \r 2. 使用以下命令切换到 Azure Resource Manager 模式：\r \r         azure config mode arm\r \r 3. 创建资源组。 此资源组包含 HDInsight 群集和关联的存储帐户。\r \r         azure group create groupname location\r \r     * 将 `groupname` 替换为组的唯一名称。\r \r     * 将 `location` 替换为要在其中创建该组的地理区域。\r \r        有关有效位置的列表，请使用 `azure location list` 命令，并使用 `Name` 列中的位置之一。\r \r 4. 创建存储帐户。 此存储帐户用作 HDInsight 群集的默认存储。\r \r         azure storage account create -g groupname --sku-name RAGRS -l location --kind Storage storagename\r \r     * 将 `groupname` 替换为上一步中创建的组的名称。\r \r     * 将 `location` 替换为上一步骤中使用的同一个位置。\r \r     * 将 `storagename` 替换为存储帐户的唯一名称。\r \r         > [!NOTE]\r         > 有关此命令中使用参数的详细信息，请使用 `azure storage account create -h` 查看此命令的帮助。\r \r 5. 检索用于访问存储帐户的密钥。\r \r         azure storage account keys list -g groupname storagename\r \r     * 将 `groupname` 替换为资源组名称。\r     * 将 `storagename` 替换为存储帐户的名称。\r \r      在返回的数据中，保存 `key1` 的 `key` 值。\r \r 6. 创建 HDInsight 群集。\r \r         azure hdinsight cluster create -g groupname -l location -y Linux --clusterType Hadoop --defaultStorageAccountName storagename.blob.core.chinacloudapi.cn --defaultStorageAccountKey storagekey --defaultStorageContainer clustername --workerNodeCount 3 --userName admin --password httppassword --sshUserName sshuser --sshPassword sshuserpassword clustername\r \r     * 将 `groupname` 替换为资源组名称。\r \r     * 将 `Hadoop` 替换为要创建的群集类型。 例如，`Hadoop`、`HBase`、`Kafka`、`Spark` 或 `Storm`。\r \r      > [!IMPORTANT]\r      > HDInsight 群集具有各种不同的类型，与该群集进行优化的工作负荷或技术相对应。 没有任何方法支持创建组合多种类型的群集，如一个群集同时具有 Storm 和 HBase 类型。\r \r     * 将 `location` 替换为前面步骤中使用的同一个位置。\r \r     * 将 `storagename` 替换为存储帐户名称。\r \r     * 将 `storagekey` 替换为上一步骤中获取的密钥。\r \r     * 对于 `--defaultStorageContainer` 参数，请使用为群集使用的同一个名称。\r \r     * 将 `admin` 和 `httppassword` 替换为通过 HTTPS 访问群集时要使用的用户名和密码。\r \r     * 将 `sshuser` 和 `sshuserpassword` 替换为通过 SSH 访问群集时要使用的用户名和密码\r \r     > [!IMPORTANT]\r     > 此示例创建一个具有两个辅助节点的群集。 还可以在创建群集后，通过执行缩放操作更改工作节点数。 如果计划使用 32 个以上的辅助角色节点，则必须选择至少具有 8 个核心和 14-GB RAM 的头节点大小。 在创建群集期间，可以使用 `--headNodeSize` 参数设置头节点大小。\r     >\r     > 有关节点大小和相关费用的详细信息，请参阅 [HDInsight 定价](https://www.azure.cn/pricing/details/hdinsight/)。\r \r     可能需要几分钟时间才能完成群集创建过程。 通常大约为 15 分钟。\r \r ## <a name=\"troubleshoot\"></a>故障排除\r \r 如果在创建 HDInsight 群集时遇到问题，请参阅[访问控制要求](hdinsight-administer-use-portal-linux.md#create-clusters)。\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 使用 Azure CLI 成功创建 HDInsight 群集后，请参考以下主题来了解如何使用群集：\r \r ### <a name=\"hadoop-clusters\"></a>Hadoop 群集\r \r * [将 Hive 与 HDInsight 配合使用](hadoop/hdinsight-use-hive.md)\r * [将 Pig 与 HDInsight 配合使用](hadoop/hdinsight-use-pig.md)\r * [将 MapReduce 与 HDInsight 配合使用](hadoop/hdinsight-use-mapreduce.md)\r \r ### <a name=\"hbase-clusters\"></a>HBase 群集\r \r * [HBase on HDInsight 入门](hbase/apache-hbase-tutorial-get-started-linux.md)\r * [为 HBase on HDInsight 开发 Java 应用程序](hbase/apache-hbase-build-java-maven-linux.md)\r \r ### <a name=\"storm-clusters\"></a>Storm 群集\r \r * [为 Storm on HDInsight 开发 Java 拓扑](storm/apache-storm-develop-java-topology.md)\r * [在 Storm on HDInsight 中使用 Python 组件](storm/apache-storm-develop-python-topology.md)\r * [使用 Storm on HDInsight 部署和监视拓扑](storm/apache-storm-deploy-monitor-topology-linux.md)\r \r <!--Update_Description: update wording and link references-->"}