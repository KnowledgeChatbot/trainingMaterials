{"Title":"使用 Azure CLI 1.0 创建 Linux VM","Description":"使用 Azure CLI 1.0 在 Azure 上创建 Linux VM","Content":"# <a name=\"create-a-linux-vm-using-the-azure-cli-10\"></a>使用 Azure CLI 1.0 创建 Linux VM\r \r 本文说明如何使用 Azure 命令行接口 (LI ) 中的 `azure vm quick-create` 命令在 Azure 上快速部署 Linux 虚拟机 (VM)。 `quick-create` 命令可将 VM 部署在基本且安全的基础结构内，可让你快速构建原型或测试概念。\r \r > [!NOTE]\r 若要使用 Azure CLI 2.0 创建 VM，请参阅[使用 Azure CLI 创建 VM](../windows/quick-create-cli.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)。\r \r 也可以使用 [Azure 门户](quick-create-portal.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)快速部署 Linux VM。\r \r 本文需要 [SSH 公钥和私钥文件](mac-create-ssh-keys.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)。\r \r [!INCLUDE [quickstarts-free-trial-note](../../../includes/quickstarts-free-trial-note.md)]\r \r ## <a name=\"quick-commands\"></a>快速命令\r \r 以下示例演示如何部署 CoreOS VM 并附加安全外壳 (SSH) 密钥（参数可能与此不同）：\r \r ```azurecli\r azure vm quick-create -M ~/.ssh/id_rsa.pub -Q CoreOS\r ```\r \r ## <a name=\"detailed-walkthrough\"></a>详细演练\r \r 下面逐步讲解如何部署 UbuntuLTS VM，并解释每个步骤的具体操作。\r \r ## <a name=\"vm-quick-create-aliases\"></a>VM quick-create 别名\r \r 选择分发的便捷方法是使用映射到最常见 OS 分发的 Azure CLI 别名。 下表列出了别名（截止到 Azure 0.10 版）。 使用 `quick-create` 的所有部署默认为部署到由固态硬盘 (SSD) 存储提供支持的 VM，这些 VM 提供更快的预配性能和高性能磁盘访问。 （这些别名表示 Azure 上的一小部分可用分发。 在 Azure 应用商店中查找更多映像（可以[在 PowerShell 中搜索映像](../windows/cli-ps-findimage.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)，或者[在 Web 上](https://portal.azure.cn/#blade/Microsoft_Azure_Marketplace/GalleryFeaturedMenuItemBlade/selectedMenuItemId/Compute_MP/resetMenuId/)搜索），或者[上传自己的自定义映像](create-upload-generic.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)。）\r \r | 别名 | 发布者 | 产品 | SKU | 版本 |\r |:--- |:--- |:--- |:--- |:--- |\r | CentOS |OpenLogic |CentOS |7.2 |最新 |\r | CoreOS |CoreOS |CoreOS |Stable |最新 |\r | Debian |credativ |Debian |8 |最新 |\r | openSUSE |SUSE |openSUSE |13.2 |最新 |\r <!-- Not Available image of RHEL -->\r | UbuntuLTS |Canonical |Ubuntu Server |14.04.4-LTS |最新 |\r \r 以下各节对 **ImageURN** 选项 (`-Q`) 使用 `UbuntuLTS` 别名来部署 Ubuntu 14.04.4 LTS Server。\r \r 上一个 `quick-create` 示例在禁用 SSH 密码时仅调出 `-M` 标志来标识要上传的 SSH 公钥，因此系统会提示输入以下参数：\r \r * 资源组名称（通常适用于第一个 Azure 资源组的任何字符串）\r * VM 名称\r * 位置（`chinanorth` 或 `chinaeast` 都是合理的默认值）\r * linux（为了让 Azure 知道用户需要哪个 OS）\r * username\r \r 以下示例会指定所有值，因此不会再有进一步的提示。 只要使用 `~/.ssh/id_rsa.pub` 作为 ssh-rsa 格式公钥文件，它就会正常运行：\r \r ```azurecli\r azure vm quick-create \\\r   --resource-group myResourceGroup \\\r   --name myVM \\\r   --location chinanorth \\\r   --os-type Linux \\\r   --admin-username myAdminUser \\\r   --ssh-publickey-file ~/.ssh/id_rsa.pub \\\r   --image-urn UbuntuLTS\r ```\r \r 输出应类似于以下输出块：\r \r ```azurecli\r info:    Executing command vm quick-create\r + Listing virtual machine sizes available in the location \"chinanorth\"\r + Looking up the VM \"myVM\"\r info:    Verifying the public key SSH file: /Users/ahmet/.ssh/id_rsa.pub\r info:    Using the VM Size \"Standard_DS1\"\r info:    The [OS, Data] Disk or image configuration requires storage account\r + Looking up the storage account cli16330708391032639673\r + Looking up the NIC \"examp-chinanorth-1633070839-nic\"\r info:    An nic with given name \"examp-chinanorth-1633070839-nic\" not found, creating a new one\r + Looking up the virtual network \"examp-chinanorth-1633070839-vnet\"\r info:    Preparing to create new virtual network and subnet\r / Creating a new virtual network \"examp-chinanorth-1633070839-vnet\" [address prefix: \"10.0.0.0/16\"] with subnet \"examp-chinanorth-1633070839-snet\" [address prefix: \"10.+.1.0/24\"]\r + Looking up the virtual network \"examp-chinanorth-1633070839-vnet\"\r + Looking up the subnet \"examp-chinanorth-1633070839-snet\" under the virtual network \"examp-chinanorth-1633070839-vnet\"\r info:    Found public ip parameters, trying to setup PublicIP profile\r + Looking up the public ip \"examp-chinanorth-1633070839-pip\"\r info:    PublicIP with given name \"examp-chinanorth-1633070839-pip\" not found, creating a new one\r + Creating public ip \"examp-chinanorth-1633070839-pip\"\r + Looking up the public ip \"examp-chinanorth-1633070839-pip\"\r + Creating NIC \"examp-chinanorth-1633070839-nic\"\r + Looking up the NIC \"examp-chinanorth-1633070839-nic\"\r + Looking up the storage account clisto1710997031examplev\r + Creating VM \"myVM\"\r + Looking up the VM \"myVM\"\r + Looking up the NIC \"examp-chinanorth-1633070839-nic\"\r + Looking up the public ip \"examp-chinanorth-1633070839-pip\"\r data:    Id                              :/subscriptions/2<--snip-->d/resourceGroups/exampleResourceGroup/providers/Microsoft.Compute/virtualMachines/exampleVMName\r data:    ProvisioningState               :Succeeded\r data:    Name                            :exampleVMName\r data:    Location                        :chinanorth\r data:    Type                            :Microsoft.Compute/virtualMachines\r data:\r data:    Hardware Profile:\r data:      Size                          :Standard_DS1\r data:\r data:    Storage Profile:\r data:      Image reference:\r data:        Publisher                   :Canonical\r data:        Offer                       :UbuntuServer\r data:        Sku                         :14.04.4-LTS\r data:        Version                     :latest\r data:\r data:      OS Disk:\r data:        OSType                      :Linux\r data:        Name                        :clic7fadb847357e9cf-os-1473374894359\r data:        Caching                     :ReadWrite\r data:        CreateOption                :FromImage\r data:        Vhd:\r data:          Uri                       :https://cli16330708391032639673.blob.core.chinacloudapi.cn/vhds/clic7fadb847357e9cf-os-1473374894359.vhd\r data:\r data:    OS Profile:\r data:      Computer Name                 :myVM\r data:      User Name                     :myAdminUser\r data:      Linux Configuration:\r data:        Disable Password Auth       :true\r data:\r data:    Network Profile:\r data:      Network Interfaces:\r data:        Network Interface #1:\r data:          Primary                   :true\r data:          MAC Address               :00-0D-3A-33-42-FB\r data:          Provisioning State        :Succeeded\r data:          Name                      :examp-chinanorth-1633070839-nic\r data:          Location                  :chinanorth\r data:            Public IP address       :138.91.247.29\r data:            FQDN                    :examp-chinanorth-1633070839-pip.chinanorth.chinacloudapp.cn\r data:\r data:    Diagnostics Profile:\r data:      BootDiagnostics Enabled       :true\r data:      BootDiagnostics StorageUri    :https://clisto1710997031examplev.blob.core.chinacloudapi.cn/\r data:\r data:      Diagnostics Instance View:\r info:    vm quick-create command OK\r ```\r \r ## <a name=\"log-in-to-the-new-vm\"></a>登录到新 VM\r 使用输出中列出的公共 IP 地址登录到 VM。 可以使用列出的完全限定域名 (FQDN)：\r \r ```bash\r ssh -i ~/.ssh/id_rsa.pub ahmet@138.91.247.29\r ```\r \r 登录过程应如以下输出块所示：\r \r ```bash\r Warning: Permanently added '138.91.247.29' (ECDSA) to the list of known hosts.\r Welcome to Ubuntu 14.04.4 LTS (GNU/Linux 3.19.0-65-generic x86_64)\r \r  * Documentation:  https://help.ubuntu.com/\r \r   System information as of Thu Sep  8 22:50:57 UTC 2016\r \r   System load: 0.63              Memory usage: 2%   Processes:       81\r   Usage of /:  39.6% of 1.94GB   Swap usage:   0%   Users logged in: 0\r \r   Graph this data and manage this system at:\r     https://landscape.canonical.com/\r \r   Get cloud support with Ubuntu Advantage Cloud Guest:\r     http://www.ubuntu.com/business/services/cloud\r \r 0 packages can be updated.\r 0 updates are security updates.\r \r The programs included with the Ubuntu system are free software;\r the exact distribution terms for each program are described in the\r individual files in /usr/share/doc/*/copyright.\r \r Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\r applicable law.\r \r myAdminUser@myVM:~$\r ```\r \r ## <a name=\"next-steps\"></a>后续步骤\r 使用 `azure vm quick-create` 命令可以快速部署 VM，以便可以登录到 bash shell 开始工作。 但是，使用 `vm quick-create` 不会为用户提供广泛的控制，也不会让用户创建更复杂的环境。  若要部署针对基础结构自定义的 Linux VM，可以遵循下列任一文章操作：\r \r * [直接使用 Azure CLI 命令创建自定义的 Linux VM 环境](create-cli-complete.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)\r * [使用模板在 Azure 上创建受 SSH 保护的 Linux VM](create-ssh-secured-vm-from-template.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)\r \r 还可以[将 `docker-machine` Azure 驱动程序与各种命令配合使用，快速创建 Linux VM 作为 docker 主机](docker-machine.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)。\r \r <!--Update_Description: update meta properties, wording update-->"}