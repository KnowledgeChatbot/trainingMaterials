{"Title":"如何使用 Azure CLI 1.0 和 Azure Resource Manager 模板创建 Linux VM","Description":"在 Azure 上使用 Azure CLI 1.0 和 Azure Resource Manager 模板创建 Linux VM。","Content":"# <a name=\"how-to-create-a-linux-vm-using-the-azure-cli-10-an-azure-resource-manager-template\"></a>如何使用 Azure CLI 1.0 和 Azure Resource Manager 模板创建 Linux VM\r 本文说明如何使用 Azure CLI 1.0 和 Azure Resource Manager 模板快速部署 Linux 虚拟机。 本文需要以下条件：\r \r * 一个 Azure 帐户（[获取试用版](https://www.azure.cn/pricing/1rmb-trial/)）。\r * 已使用 `azure login -e AzureChinaCloud` 登录 [Azure CLI 1.0](../../cli-install-nodejs.md)。\r * Azure CLI *必须处于* Azure Resource Manager 模式`azure config mode arm`。\r \r 也可以使用 [Azure 门户](quick-create-portal.md?toc=%2fvirtual-machines%2flinux%2ftoc.json)快速部署 Linux VM 模板。\r \r ## <a name=\"cli-versions-to-complete-the-task\"></a>用于完成任务的 CLI 版本\r 可使用以下 CLI 版本之一完成任务：\r \r - [Azure CLI 1.0](#quick-command-summary) - 适用于经典部署模型和资源管理部署模型（本文）的 CLI\r - [Azure CLI 2.0](create-ssh-secured-vm-from-template.md) - 适用于资源管理部署模型的下一代 CLI\r \r ## <a name=\"quick-command-summary\"></a>快速命令摘要\r ```azurecli\r azure group create \\\r     -n myResourceGroup \\\r     -l chinanorth \\\r     --template-uri https://raw.githubusercontent.com/azure/azure-quickstart-templates/master/101-vm-sshkey/azuredeploy.json\r ```\r \r ## <a name=\"detailed-walkthrough\"></a>详细演练\r 使用模板可以在 Azure 上创建具有所需设置的 VM，这些设置可在启动过程中自定义，例如用户名和主机名。 对于本文，我们将推出一个利用 Ubuntu VM 和网络安全组 (NSG) 并打开端口 22 用于 SSH 的 Azure 模板。\r \r Azure Resource Manager 模板是可用于一次性简易任务（如启动 Ubuntu VM）的 JSON 文件，如本文所述。  Azure 模板还可用于构造整个环境的复杂 Azure 配置，如测试、开发或生产部署堆栈。\r \r ## <a name=\"create-the-linux-vm\"></a>创建 Linux VM\r 下面的代码示例演示如何调用 `azure group create` 创建资源组，并同时使用 [此 Azure Resource Manager 模板](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/101-vm-sshkey/azuredeploy.json)部署受 SSH 保护的 Linux VM。 请记住，在示例中必须使用环境中唯一的名称。 此示例使用 *myResourceGroup* 作为资源组名称，使用 *myVM* 作为 VM 名称。\r \r >[!NOTE]\r > 必须修改从 GitHub 存储库“azure-quickstart-templates”下载的模板，以适应 Azure 中国云环境。 例如，替换某些终结点（将“blob.core.windows.net”替换为“blob.core.chinacloudapi.cn”，将“cloudapp.azure.com”替换为“chinacloudapp.cn”）；更改某些不受支持的 VM 映像；更改某些不受支持的 VM 大小。\r \r ```azurecli\r azure group create \\\r     --name myResourceGroup \\\r     --location chinanorth \\\r     --template-uri https://raw.githubusercontent.com/azure/azure-quickstart-templates/master/101-vm-sshkey/azuredeploy.json\r ```\r \r 输出应类似于以下输出块：\r \r ```azurecli\r info:    Executing command group create\r + Getting resource group myResourceGroup\r + Creating resource group myResourceGroup\r info:    Created resource group myResourceGroup\r info:    Supply values for the following parameters\r sshKeyData: ssh-rsa AAAAB3Nza<..ssh public key text..>VQgwjNjQ== myAdminUser@myVM\r + Initializing template configurations and parameters\r + Creating a deployment\r info:    Created template deployment \"azuredeploy\"\r data:    Id:                  /subscriptions/<..subid text..>/resourceGroups/myResourceGroup\r data:    Name:                myResourceGroup\r data:    Location:            chinanorth\r data:    Provisioning State:  Succeeded\r data:    Tags: null\r data:\r info:    group create command OK\r ```\r \r 该示例使用 `--template-uri` 参数部署了一个 VM。 如果确信模板适用于 Azure 中国区，始终可以使用 `--template-uri` 参数。  还可以使用以模板文件路径作为实际参数的 `--template-file` 形式参数在本地下载或创建模板并传递模板。 Azure CLI 将提示你输入模板所需的参数。\r \r ## <a name=\"next-steps\"></a>后续步骤\r 搜索 [模板库](https://github.com/Azure/azure-quickstart-templates/) 以发现下一步要部署哪些应用框架。"}