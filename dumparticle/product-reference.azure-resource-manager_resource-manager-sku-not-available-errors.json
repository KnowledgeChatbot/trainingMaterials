{"Title":"Azure SKU 不可用错误","Description":"介绍如何解决部署过程中 SKU 不可用错误。","Content":"# <a name=\"resolve-errors-for-sku-not-available\"></a>解决 SKU 不可用错误\r \r 本文介绍如何解决 **SkuNotAvailable** 错误。\r \r ## <a name=\"symptom\"></a>症状\r \r 部署资源（通常为虚拟机）时，会收到以下错误代码和错误消息：\r \r ```\r Code: SkuNotAvailable\r Message: The requested tier for resource '<resource>' is currently not available in location '<location>' \r for subscription '<subscriptionID>'. Please try another tier or deploy to a different location.\r ```\r \r ## <a name=\"cause\"></a>原因\r \r 当所选的资源 SKU（如 VM 大小）不可用于所选的位置时，会收到此错误。\r \r ## <a name=\"solution\"></a>解决方案\r \r 若要解决此问题，需要确定区域提供哪些 SKU。 可使用 PowerShell、门户或 REST 操作查找可用的 SKU。\r \r ### <a name=\"solution-1\"></a>解决方案 1\r \r 在 PowerShell 中使用 [Get-AzureRmComputeResourceSku](https://docs.microsoft.com/powershell/module/azurerm.compute/get-azurermcomputeresourcesku) 命令。 按位置对结果进行筛选。 必须安装最新版本 PowerShell 才能运行此命令。\r \r ```powershell\r Get-AzureRmComputeResourceSku | where {$_.Locations.Contains(\"chinaeast\")}\r ```\r \r 结果包括位置的 SKU 列表以及针对该 SKU 的任何限制。\r \r ```powershell\r ResourceType                Name      Locations Restriction                      Capability Value\r ------------                ----      --------- -----------                      ---------- -----\r availabilitySets         Classic chinaeast             MaximumPlatformFaultDomainCount     3\r availabilitySets         Aligned chinaeast             MaximumPlatformFaultDomainCount     3\r virtualMachines      Standard_A0 chinaeast\r virtualMachines      Standard_A1 chinaeast\r virtualMachines      Standard_A2 chinaeast\r ```\r \r ### <a name=\"solution-2\"></a>解决方案 2\r \r 在 Azure CLI 中，使用 `az vm list-skus` 命令。 然后，可以使用 `grep` 或类似的实用工具来筛选输出。\r \r ```bash\r $ az vm list-skus --output table\r ResourceType      Locations           Name                    Capabilities                       Tier      Size           Restrictions\r ----------------  ------------------  ----------------------  ---------------------------------  --------  -------------  ---------------------------\r availabilitySets  chinaeast              Classic                 MaximumPlatformFaultDomainCount=3\r avilabilitySets   chinaeast              Aligned                 MaximumPlatformFaultDomainCount=3\r availabilitySets  chinaeast2             Classic                 MaximumPlatformFaultDomainCount=3\r availabilitySets  chinaeast2             Aligned                 MaximumPlatformFaultDomainCount=3\r availabilitySets  chinanorth              Classic                 MaximumPlatformFaultDomainCount=3\r availabilitySets  chinanorth              Aligned                 MaximumPlatformFaultDomainCount=3\r availabilitySets  chinaeast           Classic                 MaximumPlatformFaultDomainCount=3\r availabilitySets  chinaeast           Aligned                 MaximumPlatformFaultDomainCount=3\r ```\r \r ### <a name=\"solution-3\"></a>解决方案 3\r \r 使用[门户](https://portal.azure.cn)。 登录到门户，并通过界面添加资源。 设置值时，可看到该资源的可用 SKU。 不需要完成部署。\r \r ![可用的 SKU](./media/resource-manager-sku-not-available-errors/view-sku.png)\r \r ### <a name=\"solution-4\"></a>解决方案 4\r \r 对虚拟机使用 REST API。 发送以下请求：\r \r ```HTTP \r GET\r https://management.chinacloudapi.cn/subscriptions/{subscription-id}/providers/Microsoft.Compute/skus?api-version=2016-03-30\r ```\r \r 它会用以下格式返回可用的 SKU 和区域：\r \r ```json\r {\r   \"value\": [\r     {\r       \"resourceType\": \"virtualMachines\",\r       \"name\": \"Standard_A0\",\r       \"tier\": \"Standard\",\r       \"size\": \"A0\",\r       \"locations\": [\r         \"chinaeast\"\r       ],\r       \"restrictions\": []\r     },\r     {\r       \"resourceType\": \"virtualMachines\",\r       \"name\": \"Standard_A1\",\r       \"tier\": \"Standard\",\r       \"size\": \"A1\",\r       \"locations\": [\r         \"chinaeast\"\r       ],\r       \"restrictions\": []\r     },\r     ...\r   ]\r }\r ```\r \r 如果在该区域或满足业务需求的备用区域中找不到合适的 SKU，请将 [SKU 请求](https://support.windowsazure.cn/support/support-azure)提交到 Azure 支持。\r \r <!--Update_Description: new articles on resource manager sku not available errors-->"}