{"Title":"为 Azure 导入/导出服务的导入作业准备硬盘驱动器的示例工作流 - v1","Description":"请参阅为 Azure 导入/导出服务中的导入作业准备驱动器的完整过程演练。","Content":"# <a name=\"sample-workflow-to-prepare-hard-drives-for-an-import-job\"></a>为导入作业准备硬盘驱动器的示例工作流\r 本主题讲解如何完成为导入作业准备驱动器的整个过程。  \r \r 本示例将以下数据导入到名为 `mystorageaccount` 的 Window Azure 存储帐户：  \r \r |位置|说明|  \r |--------------|-----------------|  \r |H:\\Video|视频集合，总共 5 TB。|  \r |H:\\Photo|照片集合，总共 30 GB。|  \r |K:\\Temp\\FavoriteMovie.ISO|Blu-Ray™ 磁盘映像，25 GB。|  \r |\\\\\\bigshare\\john\\music|网络共享上的音乐文件集合，总共 10 GB。|  \r \r 导入作业将这些数据导入到存储帐户中的以下目标：  \r \r |源|目标虚拟目录或 Blob|  \r |------------|-------------------------------------------|  \r |H:\\Video|https://mystorageaccount.blob.core.chinacloudapi.cn/video|  \r |H:\\Photo|https://mystorageaccount.blob.core.chinacloudapi.cn/photo|  \r |K:\\Temp\\FavoriteMovie.ISO|https://mystorageaccount.blob.core.chinacloudapi.cn/favorite/FavoriteMovies.ISO|  \r |\\\\\\bigshare\\john\\music|https://mystorageaccount.blob.core.chinacloudapi.cn/music|  \r \r 借助此映射，可将文件 `H:\\Video\\Drama\\GreatMovie.mov` 导入 Blob `https://mystorageaccount.blob.core.chinacloudapi.cn/video/Drama/GreatMovie.mov`。  \r \r 接下来，为了确定所需的硬盘驱动器数目，应计算数据大小：  \r \r `5TB + 30GB + 25GB + 10GB = 5TB + 65GB`  \r \r 对于本示例，两个 3-TB 硬盘驱动器应该足够。 但是，由于源目录 `H:\\Video` 包含 5 TB 数据，而单个硬盘驱动器的容量仅为 3 TB，因此在运行 Azure 导入/导出工具之前，需要将 `H:\\Video` 分解为两个小目录：`H:\\Video1` 和 `H:\\Video2`。 此步骤生成以下源目录：  \r \r |位置|大小|目标虚拟目录或 Blob|  \r |--------------|----------|-------------------------------------------|  \r |H:\\Video1|2.5TB|https://mystorageaccount.blob.core.chinacloudapi.cn/video|  \r |H:\\Video2|2.5TB|https://mystorageaccount.blob.core.chinacloudapi.cn/video|  \r |H:\\Photo|30GB|https://mystorageaccount.blob.core.chinacloudapi.cn/photo|  \r |K:\\Temp\\FavoriteMovies.ISO|25GB|https://mystorageaccount.blob.core.chinacloudapi.cn/favorite/FavoriteMovies.ISO|  \r |\\\\\\bigshare\\john\\music|10GB|https://mystorageaccount.blob.core.chinacloudapi.cn/music|  \r \r  即使已将 `H:\\Video` 目录分解为两个目录，它们也会指向存储帐户中的同一目标虚拟目录。 这样，所有视频文件将保留在存储帐户中的单个 `video` 容器下。  \r   \r  接下来，将上面的源目录均匀分配到两个硬盘驱动器中：  \r \r ||||  \r |-|-|-|  \r |硬盘驱动器|源目录|总大小|  \r |第一个驱动器|H:\\Video1|2.5TB + 30GB|  \r ||H:\\Photo||  \r |第二个驱动器|H:\\Video2|2.5TB + 35GB|  \r ||K:\\Temp\\BlueRay.ISO||  \r ||\\\\\\bigshare\\john\\music||  \r \r 此外，可为所有文件设置以下元数据：  \r \r -   **UploadMethod：** Azure 导入/导出服务  \r \r -   **DataSetName：** SampleData  \r \r -   **CreationDate：** 10/1/2013  \r \r 若要为导入的文件设置元数据，请创建包含以下内容的文本文件 `c:\\WAImportExport\\SampleMetadata.txt`：  \r \r ```xml\r <?xml version=\"1.0\" encoding=\"UTF-8\"?>  \r <Metadata>  \r     <UploadMethod>Windows Azure Import/Export service</UploadMethod>  \r     <DataSetName>SampleData</DataSetName>  \r     <CreationDate>10/1/2013</CreationDate>  \r </Metadata>  \r ```\r \r 还可为 `FavoriteMovie.ISO` Blob 设置一些属性：  \r \r -   **Content-Type：** application/octet-stream  \r \r -   **Content-MD5：** Q2hlY2sgSW50ZWdyaXR5IQ==  \r \r -   **Cache-Control：** no-cache  \r \r 若要设置这些属性，请创建文本文件 `c:\\WAImportExport\\SampleProperties.txt`：  \r \r ```xml\r <?xml version=\"1.0\" encoding=\"UTF-8\"?>  \r <Properties>  \r     <Content-Type>application/octet-stream</Content-Type>  \r     <Content-MD5>Q2hlY2sgSW50ZWdyaXR5IQ==</Content-MD5>  \r     <Cache-Control>no-cache</Cache-Control>  \r </Properties>  \r ```\r \r 现在，便可以运行 Azure 导入/导出工具来准备两个硬盘驱动器了。 请注意：  \r \r -   第一个驱动器将作为驱动器 X 装入。  \r \r -   第二个驱动器将作为驱动器 Y 装入。  \r \r -   存储帐户 `mystorageaccount` 的密钥为 `8ImTigJhIwvL9VEIQKB/zbqcXbxrIHbBjLIfOt0tyR98TxtFvUM/7T0KVNR6KRkJrh26u5I8hTxTLM2O1aDVqg==`。  \r \r ## <a name=\"preparing-disk-for-import-when-data-is-pre-loaded\"></a>在预先加载了数据的情况下为导入准备磁盘\r  \r  如果要导入的数据已在磁盘上，可以使用标志 /skipwrite。 /t 和 /srcdir 的值应该指向为导入准备的磁盘。 如果要导入的所有数据并非都传送到同一个目标虚拟目录或存储帐户根目录，则可针对每个目标目录单独运行相同的命令，但每次运行需要保持使用相同的 /id 值。\r \r >[!NOTE] \r >请不要指定 /format，否则会擦除磁盘上的数据。 可以根据磁盘是否已加密，指定 /encrypt 或 /bk。 \r >\r \r 如果数据已在磁盘上，请针对每个驱动器运行以下命令。\r ```\r WAImportExport.exe PrepImport /j:FirstDrive.jrn /id:Video1 /logdir:c:\\logs /sk:8ImTigJhIwvL9VEIQKB/zbqcXbxrIHbBjLIfOt0tyR98TxtFvUM/7T0KVNR6KRkJrh26u5I8hTxTLM2O1aDVqg== /t:x /format /encrypt /srcdir:x:\\Video1 /dstdir:video/ /MetadataFile:c:\\WAImportExport\\SampleMetadata.txt /skipwrite\r ```\r \r ## <a name=\"copy-sessions---first-drive\"></a>复制会话 - 第 1 个驱动器\r \r 对于第 1 个驱动器，请运行 Azure 导入/导出工具 2 次来复制两个源目录：  \r \r **第 1 个复制会话**\r \r ```\r WAImportExport.exe PrepImport /j:FirstDrive.jrn /id:Video1 /logdir:c:\\logs /sk:8ImTigJhIwvL9VEIQKB/zbqcXbxrIHbBjLIfOt0tyR98TxtFvUM/7T0KVNR6KRkJrh26u5I8hTxTLM2O1aDVqg== /t:x /format /encrypt /srcdir:H:\\Video1 /dstdir:video/ /MetadataFile:c:\\WAImportExport\\SampleMetadata.txt  \r ```\r \r **第 2 个复制会话**\r \r ```\r WAImportExport.exe PrepImport /j:FirstDrive.jrn /id:Photo /srcdir:H:\\Photo /dstdir:photo/ /MetadataFile:c:\\WAImportExport\\SampleMetadata.txt\r ```\r \r ## <a name=\"copy-sessions---second-drive\"></a>复制会话 - 第二个驱动器\r \r 对于第二个驱动器，请运行 Azure 导入/导出工具 3 次（针对每个源目录运行 1 次，针对独立 Blu-Ray™ 映像文件运行 1 次）：  \r \r **第 1 个复制会话** \r \r ```\r WAImportExport.exe PrepImport /j:SecondDrive.jrn /id:Video2 /logdir:c:\\logs /sk:8ImTigJhIwvL9VEIQKB/zbqcXbxrIHbBjLIfOt0tyR98TxtFvUM/7T0KVNR6KRkJrh26u5I8hTxTLM2O1aDVqg== /t:y /format /encrypt /srcdir:H:\\Video2 /dstdir:video/ /MetadataFile:c:\\WAImportExport\\SampleMetadata.txt  \r ```\r \r **第 2 个复制会话**\r \r ```\r WAImportExport.exe PrepImport /j:SecondDrive.jrn /id:Music /srcdir:\\\\bigshare\\john\\music /dstdir:music/ /MetadataFile:c:\\WAImportExport\\SampleMetadata.txt  \r ```\r \r **第 3 个复制会话**  \r \r ```\r WAImportExport.exe PrepImport /j:SecondDrive.jrn /id:BlueRayIso /srcfile:K:\\Temp\\BlueRay.ISO /dstblob:favorite/BlueRay.ISO /MetadataFile:c:\\WAImportExport\\SampleMetadata.txt /PropertyFile:c:\\WAImportExport\\SampleProperties.txt  \r ```\r \r ## <a name=\"copy-session-completion\"></a>复制会话完成\r \r 复制会话完成后，可断开两个驱动器与复制计算机的连接，并将其寄送到相应的 Azure 数据中心。 在 [Azure 门户](https://portal.azure.cn/)中创建导入作业时，上传两个日记文件：`FirstDrive.jrn` 和 `SecondDrive.jrn`。  \r \r ## <a name=\"next-steps\"></a>后续步骤\r \r * [为导入作业准备硬盘驱动器](../storage-import-export-tool-preparing-hard-drives-import-v1.md)   \r * [常用命令快速参考](../storage-import-export-tool-quick-reference-v1.md) \r <!--Update_Description: wording update-->"}