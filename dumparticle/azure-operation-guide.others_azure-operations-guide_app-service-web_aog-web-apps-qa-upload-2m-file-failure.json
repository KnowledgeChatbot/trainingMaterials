{"Title":"上传超过 2M 的文件到 Azure PHP 网站失败","Description":"上传超过 2M 的文件到 Azure PHP 网站失败","Content":"\r # 上传超过 2M 的文件到 Azure PHP 网站失败\r \r ## **问题描述**\r \r 上传超过 2M 的文件到 Azure PHP 网站失败。\r \r ## **问题分析**\r \r 由于 PHP 本身默认上传文件的上限是 2M，所以当上传超过2M的文件时会报错。\r \r ## **解决方法**\r \r 根据以下步骤进行配置：\r \r 1. 在 site -> wwwroot 目录下增加一个 `.user.ini` 文件，设置如下：\r \r     ```\r     upload_max_filesize = 40M\r     post_max_size = 40M\r     ```\r \r     >[!NOTE]\r     > 以上两个参数的值可以根据需求自行修改。\r \r     为了检查配置是否成功也可以在 `.user.ini` 文件中开启 PHP log ,配置如下：\r \r     ```\r     display_errors = on\r     log_errors = on \r     error_reporting = E_ALL\r     error_log = D:\\home\\site\\wwwroot\\php.log\r     file_uploads = on\r     ```\r \r 2. 由于 IIS 默认请求体的大小为 28.6M，若上传的文件超过这个大小，还需要在 `web.config` 文件中修改 IIS 请求体的大小,具体修改可以参照下面的例子：\r \r     ```\r     <configuration>\r     <system.webServer>\r         <security>\r             <requestFiltering>\r                     <requestLimits maxAllowedContentLength=\"300000000\"/>\r             </requestFiltering>\r         </security>\r     </system.webServer>\r     <system.web>\r                     <httpRuntime maxRequestLength=\"300000000\" appRequestQueueLimit=\"100\" useFullyQualifiedRedirectUrl=\"true\" executionTimeout=\"600\"/>\r     </system.web>\r     </configuration>\r     ```\r \r 3. 做完上述的配置之后，建议在管理门户重启网站。\r \r ## **参考链接**\r \r [Windows Azure Web Sites: File upload limit for PHP sites hosted on WAWS](https://blogs.msdn.microsoft.com/kaushal/2014/01/01/windows-azure-web-sites-file-upload-limit-for-php-sites-hosted-on-waws/)<br>\r [Request Limits](https://www.iis.net/configreference/system.webserver/security/requestfiltering/requestlimits#001)"}