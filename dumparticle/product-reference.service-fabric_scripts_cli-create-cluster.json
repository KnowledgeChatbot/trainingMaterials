{"Title":"Azure Service Fabric CLI 脚本部署示例","Description":"使用 Azure Service Fabric CLI 在 Azure 中创建安全的 Service Fabric Linux 群集。","Content":"# <a name=\"create-a-secure-service-fabric-linux-cluster-in-azure\"></a>在 Azure 中创建安全的 Service Fabric Linux 群集\r \r 此命令创建一个自签名证书，将其添加到密钥保管库并在本地下载该证书。  新证书用于在群集部署时保护群集。  也可以使用现有证书而不是创建一个新证书。  不管怎样，证书的使用者名称都必须与用于访问 Service Fabric 群集的域匹配。 只有满足此匹配，才能为群集的 HTTPS 管理终结点和 Service Fabric Explorer 提供 SSL。 无法从 CA 获取 `.chinacloudapp.cn` 域的 SSL 证书。 必须获取群集的自定义域名。 从 CA 请求证书时，该证书的使用者名称必须与用于群集的自定义域名匹配。\r \r 根据需要安装 [Azure CLI 2.0](https://docs.azure.cn/zh-cn/cli/install-azure-cli?view=azure-cli-latest)。\r \r ## <a name=\"sample-script\"></a>示例脚本\r \r ```sh\r #!/bin/bash\r \r # Variables\r ResourceGroupName=\"aztestclustergroup\" \r ClusterName=\"aztestcluster\" \r Location=\"chinaeast\" \r Password=\"q6D7nN%6ck@6\" \r Subject=\"aztestcluster.chinaeast.cloudapp.chinacloudapi.cn\" \r VaultName=\"aztestkeyvault\" \r VmPassword=\"Mypa$$word!321\"\r VmUserName=\"sfadminuser\"\r \r # Create resource group\r az group create --name $ResourceGroupName --location $Location \r \r # Create secure five node Linux cluster. Creates a key vault in a resource group\r # and creates a certficate in the key vault. The certificate's subject name must match \r # the domain that you use to access the Service Fabric cluster.  The certificate is downloaded locally.\r az sf cluster create --resource-group $ResourceGroupName --location $Location \\ \r   --certificate-output-folder . --certificate-password $Password --certificate-subject-name $Subject \\\r   --cluster-name $ClusterName --cluster-size 5 --os UbuntuServer1604 --vault-name $VaultName \\ \r   --vault-resource-group $ResourceGroupName --vm-password $VmPassword --vm-user-name $VmUserName\r \r ```\r \r ## <a name=\"clean-up-deployment\"></a>清理部署\r \r 运行脚本示例后，可以使用以下命令删除资源组、群集以及所有相关资源。\r \r ```azurecli\r ResourceGroupName = \"aztestclustergroup\"\r az group delete --name $ResourceGroupName\r ```\r \r ## <a name=\"script-explanation\"></a>脚本说明\r \r 此脚本使用以下命令。 表中的每条命令均链接到特定于命令的文档。\r \r | 命令 | 说明 |\r |---|---|\r | [az sf cluster create](https://docs.azure.cn/zh-cn/cli/sf/cluster?view=azure-cli-latest#az_sf_cluster_create) | 新建 Service Fabric 群集。  |\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 在 [Service Fabric CLI 示例](../samples-cli.md)中可找到 Azure Service Fabric 的其他 Service Fabric CLI 示例。\r <!--Update_Description: new articles on create cluster with CLI -->"}