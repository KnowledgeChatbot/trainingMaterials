{"Title":"使用 MongoDB API 生成 Azure Cosmos DB 应用","Description":"使用适用于 MongoDB 的 Azure Cosmos DB API 创建联机数据库的教程。","Content":"# <a name=\"build-an-azure-cosmos-db-api-for-mongodb-app-using-nodejs\"></a>使用 Node.js 生成 Azure Cosmos DB: API for MongoDB 应用\r > [!div class=\"op_single_selector\"]\r > * [.NET](documentdb-get-started.md)\r > * [.NET Core](documentdb-dotnetcore-get-started.md)\r > * [Java](documentdb-java-get-started.md)\r > * [用于 MongoDB 的 Node.js](mongodb-samples.md)\r > * [Node.js](documentdb-nodejs-get-started.md)\r > * [C++](documentdb-cpp-get-started.md)\r >  \r >\r \r 此示例说明如何使用 Node.js 生成 Azure Cosmos DB: API for MongoDB 控制台应用。\r \r 若要使用此示例，必须：\r \r * [创建](create-mongodb-dotnet.md#create-account) Azure Cosmos DB: API for MongoDB 帐户。\r * 检索 MongoDB [连接字符串](connect-mongodb-account.md)信息。\r \r ## <a name=\"create-the-app\"></a>创建应用程序\r \r 1. 创建 app.js 文件，并复制粘贴以下代码。\r \r     ```nodejs\r     var MongoClient = require('mongodb').MongoClient;\r     var assert = require('assert');\r     var ObjectId = require('mongodb').ObjectID;\r     var url = 'mongodb://<endpoint>:<password>@<endpoint>.documents.azure.cn:10255/?ssl=true';\r \r     var insertDocument = function(db, callback) {\r     db.collection('families').insertOne( {\r             \"id\": \"AndersenFamily\",\r             \"lastName\": \"Andersen\",\r             \"parents\": [\r                 { \"firstName\": \"Thomas\" },\r                 { \"firstName\": \"Mary Kay\" }\r             ],\r             \"children\": [\r                 { \"firstName\": \"John\", \"gender\": \"male\", \"grade\": 7 }\r             ],\r             \"pets\": [\r                 { \"givenName\": \"Fluffy\" }\r             ],\r             \"address\": { \"country\": \"USA\", \"state\": \"WA\", \"city\": \"Seattle\" }\r         }, function(err, result) {\r         assert.equal(err, null);\r         console.log(\"Inserted a document into the families collection.\");\r         callback();\r     });\r     };\r \r     var findFamilies = function(db, callback) {\r     var cursor =db.collection('families').find( );\r     cursor.each(function(err, doc) {\r         assert.equal(err, null);\r         if (doc != null) {\r             console.dir(doc);\r         } else {\r             callback();\r         }\r     });\r     };\r \r     var updateFamilies = function(db, callback) {\r     db.collection('families').updateOne(\r         { \"lastName\" : \"Andersen\" },\r         {\r             $set: { \"pets\": [\r                 { \"givenName\": \"Fluffy\" },\r                 { \"givenName\": \"Rocky\"}\r             ] },\r             $currentDate: { \"lastModified\": true }\r         }, function(err, results) {\r         console.log(results);\r         callback();\r     });\r     };\r \r     var removeFamilies = function(db, callback) {\r     db.collection('families').deleteMany(\r         { \"lastName\": \"Andersen\" },\r         function(err, results) {\r             console.log(results);\r             callback();\r         }\r     );\r     };\r \r     MongoClient.connect(url, function(err, db) {\r     assert.equal(null, err);\r     insertDocument(db, function() {\r         findFamilies(db, function() {\r         updateFamilies(db, function() {\r             removeFamilies(db, function() {\r                 db.close();\r             });\r         });\r         });\r     });\r     });\r     ```\r \r 2. 按照帐户设置修改 app.js 文件中的以下变量（了解如何查找[连接字符串](connect-mongodb-account.md)）：\r \r     ```nodejs\r     var url = 'mongodb://<endpoint>:<password>@<endpoint>.documents.azure.cn:10255/?ssl=true';\r     ```\r \r 3. 打开偏爱的终端，运行 **npm install mongodb --save**，并使用 **node app.js** 运行应用程序\r \r ## <a name=\"next-steps\"></a>后续步骤\r * 了解如何配合[使用 MongoChef](mongodb-mongochef.md) 与 Azure Cosmos DB: API for MongoDB 帐户。\r \r <!--Update_Description: wording update-->"}