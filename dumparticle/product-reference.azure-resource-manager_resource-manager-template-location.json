{"Title":"模板中的 Azure 资源位置","Description":"演示如何在 Azure Resource Manager 模板中设置资源位置","Content":"# <a name=\"set-resource-location-in-azure-resource-manager-templates\"></a>在 Azure Resource Manager 模板中设置资源位置\r 部署模板时，必须提供每个资源的位置。 本主题说明如何确定可用于每种资源类型的订阅的位置。\r \r ## <a name=\"determine-supported-locations\"></a>确定支持的位置\r \r 有关每种资源类型支持的位置的完整列表，请参阅 [可用产品（按区域）](https://www.azure.cn/support/service-dashboard)。 但是，订阅可能无法访问该列表中的所有位置。 若要查看可用于订阅的位置的自定义列表，请使用 Azure PowerShell 或 Azure CLI。 \r \r 以下示例使用 PowerShell 获取 `Microsoft.Web\\sites` 资源类型的位置：\r \r ```powershell\r ((Get-AzureRmResourceProvider -ProviderNamespace Microsoft.Web).ResourceTypes | Where-Object ResourceTypeName -eq sites).Locations\r ```\r \r 以下示例使用 Azure CLI 2.0获取 `Microsoft.Web\\sites` 资源类型的位置：\r \r ```azurecli\r az provider show -n Microsoft.Web --query \"resourceTypes[?resourceType=='sites'].locations\"\r ```\r \r ## <a name=\"set-location-in-template\"></a>在模板中设置位置\r \r 确定资源支持的位置后，需要在模板中设置该位置。 设置此值的最简单方法是在支持资源类型的位置中创建资源组，并将每个位置设置为 `[resourceGroup().location]`。 可以将模板重新部署到不同位置中的资源组，而不更改模板或参数中的任何值。 \r \r 以下示例显示了部署到资源组所在位置的存储帐户：\r \r ```json\r {\r     \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r     \"contentVersion\": \"1.0.0.0\",\r     \"variables\": {\r       \"storageName\": \"[concat('storage', uniqueString(resourceGroup().id))]\"\r     },\r     \"resources\": [\r     {\r       \"apiVersion\": \"2016-01-01\",\r       \"type\": \"Microsoft.Storage/storageAccounts\",\r       \"name\": \"[variables('storageName')]\",\r       \"location\": \"[resourceGroup().location]\",\r       \"tags\": {\r         \"Dept\": \"Finance\",\r         \"Environment\": \"Production\"\r       },\r       \"sku\": {\r         \"name\": \"Standard_LRS\"\r       },\r       \"kind\": \"Storage\",\r       \"properties\": { }\r     }\r     ]\r }\r ```\r \r 如果需要在模板中对位置进行硬编码，请提供其中一个支持的区域名称。 以下示例显示了始终部署到中国北部的存储帐户：\r \r ```json\r {\r     \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r     \"contentVersion\": \"1.0.0.0\",\r     \"resources\": [\r     {\r       \"apiVersion\": \"2016-01-01\",\r       \"type\": \"Microsoft.Storage/storageAccounts\",\r       \"name\": \"[concat('storageloc', uniqueString(resourceGroup().id))]\",\r       \"location\": \"China North\",\r       \"tags\": {\r         \"Dept\": \"Finance\",\r         \"Environment\": \"Production\"\r       },\r       \"sku\": {\r         \"name\": \"Standard_LRS\"\r       },\r       \"kind\": \"Storage\",\r       \"properties\": { }\r     }\r     ]\r }\r ```\r \r ## <a name=\"next-steps\"></a>后续步骤\r * 有关如何创建模板的建议，请参阅[创建 Azure Resource Manager 模板的最佳实践](resource-manager-template-best-practices.md)。\r \r <!--Update_Description: update link-->"}