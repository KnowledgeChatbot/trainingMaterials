{"Title":"使用版本 1.0.0 的 Azure ARM SDK for Java 创建虚拟机时报错","Description":"使用版本 1.0.0 的 Azure ARM SDK for Java 创建虚拟机时报错","Content":"\r # 使用版本 1.0.0 的 Azure ARM SDK for Java 创建虚拟机时报错\r \r ## **问题描述**\r \r 我们可以通过使用 Azure ARM SDK 来管理 Azure 上的资源，因此我们也可以通过 SDK 来创建 ARM 类型的虚拟机，当我们使用 1.0.0 版本的 Azure SDK for Java 来创建 ARM 虚拟时，会遇到如下错误：\r \r     com.microsoft.azure.CloudException: Managed Disks are not supported in this region。\r \r ## **问题分析**\r \r 使用版本 1.0.0 之前的 SDK 如 -beta3 来创建虚拟机是使用基于 storage account (OS and Data) disk，但是随后有了 managed disks，因此 1.0.0 版本的 SDK 是通过 managed disks 来创建的虚拟机。\r \r 目前中国区域的 1.0.0 版本的 SDK 还不支持 managed disks，所以出现了下面的报错。我们目前正在积极推进相关功能在中国区域的上线。\r \r ## **解决方案**\r \r 可以通过使用 `withUnmanagedDisks()` 来定义创建虚拟机，可以参考[链接](https://github.com/Azure-Samples/compute-java-manage-virtual-machine-with-unmanaged-disks/blob/master/src/main/java/com/microsoft/azure/management/compute/samples/ManageVirtualMachineWithUnmanagedDisks.java#L72)。\r \r 例如：\r \r     VirtualMachine windowsVM = azure.virtualMachines().define(vmName)\r                     .withRegion(vmRegion)\r                     .withNewResourceGroup(resourceGroupName)\r                     .withNewPrimaryNetwork(\"10.0.0.0/28\")\r                     .withPrimaryPrivateIPAddressDynamic()\r                     .withoutPrimaryPublicIPAddress()\r                     .withPopularWindowsImage(KnownWindowsVirtualMachineImage.WINDOWS_SERVER_2012_R2_DATACENTER)\r                     .withAdminUsername(vmUserName)\r                     .withAdminPassword(vmPassword)\r                     .withUnmanagedDisks()\r                     .withSize(VirtualMachineSizeTypes.STANDARD_D3_V2)\r                     .create();"}