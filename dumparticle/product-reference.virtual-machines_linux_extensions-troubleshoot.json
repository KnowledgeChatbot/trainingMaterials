{"Title":"对 Azure Linux VM 扩展故障进行故障排除。","Description":"了解如何对 Azure Linux VM 扩展故障进行故障排除","Content":"\r # 对 Azure Linux VM 扩展故障进行故障排除。\r \r > [!NOTE]\r >Azure 具有用于创建和处理资源的两个不同的部署模型：[资源管理器和经典](../../azure-resource-manager/resource-manager-deployment-model.md)。这篇文章介绍如何使用资源管理器部署模型，Azure 建议大多数新部署使用资源管理器模型替代经典部署模型。\r \r [!INCLUDE [virtual-machines-common-extensions-troubleshoot](../../../includes/virtual-machines-common-extensions-troubleshoot.md)]\r \r ## 查看扩展状态：\r Azure 资源管理器模板可从 Azure Powershell 或 Azure CLI 执行。一旦执行该模板，就可以从 Azure 资源管理器或命令行工具查看扩展状态。下面是一些示例：\r \r Azure CLI：\r \r ```\r   azure vm get-instance-view\r ```\r \r 下面是示例输出：\r \r ```\r   Extensions:  {\r   \"ExtensionType\": \"Microsoft.Compute.CustomScriptExtension\",\r   \"Name\": \"myCustomScriptExtension\",\r   \"SubStatuses\": [\r     {\r       \"Code\": \"ComponentStatus/StdOut/succeeded\",\r       \"DisplayStatus\": \"Provisioning succeeded\",\r       \"Level\": \"Info\",\r       \"Message\": \"    Directory: C:\\\\temp\\\\n\\\\n\\\\nMode                LastWriteTime     Length Name\r           \\\\n----                -------------     ------ ----                              \\\\n-a---          9/1/2015   2:03 AM         11\r           test.txt                          \\\\n\\\\n\",\r                   \"Time\": null\r       },\r     {\r       \"Code\": \"ComponentStatus/StdErr/succeeded\",\r       \"DisplayStatus\": \"Provisioning succeeded\",\r       \"Level\": \"Info\",\r       \"Message\": \"\",\r       \"Time\": null\r     }\r   ]\r }\r ```\r \r ## 对扩展故障进行故障排除：\r \r ### 在 VM 上重新运行扩展\r \r 如果你使用自定义脚本扩展在 VM 上运行脚本，有时可能会遇到错误，即 VM 已成功创建但脚本却运行失败。在这些情况下，从此错误中恢复的建议方法是删除该扩展并再次重新运行该模板。注意：未来此功能将得到增强，不再需要卸载该扩展。\r \r #### 从 Azure CLI 删除该扩展\r \r ```\r   azure vm extension set --resource-group \"KPRG1\" --vm-name \"kundanapdemo\" --publisher-name \"Microsoft.Compute.CustomScriptExtension\" --name \"myCustomScriptExtension\" --version 1.4 --uninstall\r ```\r \r 其中“publsher-name”对应“azure vm get-instance-view”输出中的扩展类型，名称是模板中扩展资源的名称\r \r 删除该扩展后，可以重新执行模板在 VM 上运行脚本。\r \r <!---HONumber=Mooncake_1207_2015-->"}