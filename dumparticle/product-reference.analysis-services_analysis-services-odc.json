{"Title":"创建 .odc 文件以连接到 Azure Analysis Services 服务器","Description":"了解如何创建 Office 数据连接文件以连接到 Azure 中的 Analysis Services 服务器并从中获取数据。","Content":"# <a name=\"create-an-office-data-connection-file\"></a>创建 Office 数据连接文件\r \r 本文中的信息描述了如何创建 Office Data Connection 文件，以从 Excel 2016 版本号 16.0.7369.2117 或更早版本或 Excel 2013 连接到 Azure Analysis Services 服务器。 还需要更新的 [MSOLAP.7 提供程序](analysis-services-data-providers.md)。\r \r 1. 复制下面的示例连接文件，并粘贴到文本编辑器中。 \r \r 2. 在 `odc:ConnectionString` 中，更改以下属性：\r \r     *   在 `Data Source=asazure://<region>.asazure.chinacloudapi.cn/<servername>;` 中，将 `<region>` 更改为你 Analysis Services 服务器的区域，将 `<servername>` 更改为你服务器的名称。\r \r     *   在 `Initial Catalog=<database>;` 中，将 `<database>` 更改为你数据库的名称。\r \r 3. 在 `<odc:CommandText>Model</odc:CommandText>` 中，将 `Model` 更改为你的模型或者视角的名称。 \r \r 4. 将带有 `.odc` 扩展名的文件保存到 C:\\Users\\\\*username*\\Documents\\My Data Sources 文件夹。\r \r 5. 右键单击该文件，并单击“在 Excel 中打开”。 或者在 Excel 的“数据”功能区上，单击“现有连接”，选择文件，然后单击“打开”。\r \r **示例连接文件**\r ```\r <html xmlns:o=\"urn:schemas-microsoft-com:office:office\"\r xmlns=\"http://www.w3.org/TR/REC-html40\">\r \r <head>\r <meta http-equiv=Content-Type content=\"text/x-ms-odc; charset=utf-8\">\r <meta name=ProgId content=ODC.Cube>\r <meta name=SourceType content=OLEDB>\r <meta name=Catalog content=\"Database\">\r <meta name=Table content=Model>\r <title>AzureAnalysisServicesConnection</title>\r <xml id=docprops><o:DocumentProperties\r   xmlns:o=\"urn:schemas-microsoft-com:office:office\"\r   xmlns=\"http://www.w3.org/TR/REC-html40\">\r   <o:Name>SampleAzureAnalysisServices</o:Name>\r  </o:DocumentProperties>\r </xml><xml id=msodc><odc:OfficeDataConnection\r   xmlns:odc=\"urn:schemas-microsoft-com:office:odc\"\r   xmlns=\"http://www.w3.org/TR/REC-html40\">\r   <odc:Connection odc:Type=\"OLEDB\">\r    <odc:ConnectionString>Provider=MSOLAP.7;Data Source=asazure://<region>.asazure.chinacloudapi.cn/<servername>;Initial Catalog=<database>;</odc:ConnectionString>\r    <odc:CommandType>Cube</odc:CommandType>\r    <odc:CommandText>Model</odc:CommandText>\r   </odc:Connection>\r  </odc:OfficeDataConnection>\r </xml>\r <style>\r <!--\r     .ODCDataSource\r     {\r     behavior: url(dataconn.htc);\r     }\r -->\r </style>\r \r </head>\r \r <body onload='init()' scroll=no leftmargin=0 topmargin=0 rightmargin=0 style='border: 0px'>\r <table style='border: solid 1px threedface; height: 100%; width: 100%' cellpadding=0 cellspacing=0 width='100%'> \r   <tr> \r     <td id=tdName style='font-family:arial; font-size:medium; padding: 3px; background-color: threedface'> \r       &nbsp; \r     </td> \r      <td id=tdTableDropdown style='padding: 3px; background-color: threedface; vertical-align: top; padding-bottom: 3px'>\r \r       &nbsp; \r     </td> \r   </tr> \r   <tr> \r     <td id=tdDesc colspan='2' style='border-bottom: 1px threedshadow solid; font-family: Arial; font-size: 1pt; padding: 2px; background-color: threedface'>\r \r       &nbsp; \r     </td> \r   </tr> \r   <tr> \r     <td colspan='2' style='height: 100%; padding-bottom: 4px; border-top: 1px threedhighlight solid;'> \r       <div id='pt' style='height: 100%' class='ODCDataSource'></div> \r     </td> \r   </tr> \r </table> \r \r <script language='javascript'> \r \r function init() { \r   var sName, sDescription; \r   var i, j; \r \r   try { \r     sName = unescape(location.href) \r \r     i = sName.lastIndexOf(\".\") \r     if (i>=0) { sName = sName.substring(1, i); } \r \r     i = sName.lastIndexOf(\"/\") \r     if (i>=0) { sName = sName.substring(i+1, sName.length); } \r \r     document.title = sName; \r     document.getElementById(\"tdName\").innerText = sName; \r \r     sDescription = document.getElementById(\"docprops\").innerHTML; \r \r     i = sDescription.indexOf(\"escription>\") \r     if (i>=0) { j = sDescription.indexOf(\"escription>\", i + 11); } \r \r     if (i>=0 && j >= 0) { \r       j = sDescription.lastIndexOf(\"</\", j); \r \r       if (j>=0) { \r           sDescription = sDescription.substring(i+11, j); \r         if (sDescription != \"\") { \r             document.getElementById(\"tdDesc\").style.fontSize=\"x-small\"; \r           document.getElementById(\"tdDesc\").innerHTML = sDescription; \r           } \r         } \r       } \r     } \r   catch(e) { \r \r     } \r   } \r </script> \r \r </body> \r \r </html>\r \r ```\r \r <!--Update_Description: update meta properties -->"}