{"Title":"Azure Analysis Services 数据库备份和还原","Description":"介绍如何备份和还原 Azure Analysis Services 数据库。","Content":"# <a name=\"backup-and-restore\"></a>备份和还原\r \r 在 Azure Analysis Services 中备份表格模型数据库与在本地 Analysis Services 中备份大致相同。 主要区别在于存储备份文件的位置。 必须将备份文件保存到 [Azure 存储帐户](../storage/common/storage-create-storage-account.md)的容器中。 可以使用已有存储帐户和容器，也可以在为服务器配置存储设置时创建。\r \r > [!NOTE]\r > 创建存储帐户可能会导致新的计费服务。 若要了解详细信息，请参阅 [Azure 存储定价](https://www.azure.cn/pricing/details/storage/)。\r > \r > \r <!-- Valid Storage Price: https://www.azure.cn/pricing/details/storage/-->\r \r 使用 abf 扩展名保存备份。 对于内存中表格模型，将存储模型数据和元数据。 对于 DirectQuery 表格模型，将仅存储模型元数据。 备份可以进行压缩和加密，具体取决于选择的选项。 \r \r ## <a name=\"configure-storage-settings\"></a>配置存储设置\r 备份前，需要为服务器配置存储设置。\r \r ### <a name=\"to-configure-storage-settings\"></a>配置存储设置\r 1.  在 Azure 门户中，转到“设置”，单击“备份”。\r \r     ![设置中的备份](./media/analysis-services-backup/aas-backup-backups.png)\r \r 2.  单击“已启用”，并单击“存储设置”。\r \r     ![启用](./media/analysis-services-backup/aas-backup-enable.png)\r \r 3. 选择存储帐户，或新建一个。\r \r 4. 选择容器，或新建一个。\r \r     ![选择容器](./media/analysis-services-backup/aas-backup-container.png)\r \r 5. 保存备份设置。\r \r     ![保存备份设置](./media/analysis-services-backup/aas-backup-save.png)\r \r ## <a name=\"backup\"></a>备份\r \r ### <a name=\"to-backup-by-using-ssms\"></a>使用 SSMS 备份\r \r 1. 在 SSMS 中，右键单击某个数据库，转到“备份”。\r \r 2. 在“备份数据库” > “备份文件”中，单击“浏览”。\r \r 3. 在“文件另存为”对话框中，验证文件夹路径，并键入备份文件的名称。 \r \r 4. 在“备份数据库”对话框中，选择选项。\r \r     “允许覆盖文件”- 选择此选项可覆盖具有相同名称的备份文件。 如果未选择此选项，则要保存的文件不能与同一位置中已存在的文件具有相同的名称。\r \r     “应用压缩”- 选择此选项可压缩备份文件。 压缩的备份文件可节省磁盘空间，但需要稍高的 CPU 使用率。 \r \r     “加密备份文件”- 选择此选项可加密备份文件。 此选项要求用户提供密码来保护备份文件。 密码可防止采用还原操作外的任何其他方式读取备份数据。 如果选择对备份加密，请将密码存储在安全位置。\r \r 5. 单击“确定”创建并保存备份文件。\r \r ### <a name=\"powershell\"></a>PowerShell\r 使用 [Backup-ASDatabase](https://docs.microsoft.com/sql/analysis-services/powershell/backup-asdatabase-cmdlet) cmdlet。\r \r ## <a name=\"restore\"></a>还原\r 还原时，备份文件必须在已为服务器配置的存储帐户中。 如果需要将备份文件从本地位置移到存储帐户，请使用 [Azure 存储资源管理器](/vs-azure-tools-storage-manage-with-storage-explorer)或 [AzCopy](../storage/common/storage-use-azcopy.md) 命令行实用工具。 \r \r > [!NOTE]\r > 如果要从本地服务器还原，必须先从该模型的角色中删除所有域用户，并再将这些用户作为 Azure Active Directory 用户重新添加到这些角色。\r > \r > \r \r ### <a name=\"to-restore-by-using-ssms\"></a>使用 SSMS 还原\r \r 1. 在 SSMS 中，右键单击某个数据库，转到“还原”。\r \r 2. 在“备份文件”的“备份数据库”对话框中，单击“浏览”。\r \r 3. 在“定位数据库文件”对话框中，选择要还原的文件。\r \r 4. 在“还原数据库”，选择数据库。\r \r 5. 指定选项。 安全选项必须与备份时使用的备份选项相匹配。\r \r ### <a name=\"powershell\"></a>PowerShell\r \r 使用 [Restore-ASDatabase](https://docs.microsoft.com/sql/analysis-services/powershell/restore-asdatabase-cmdlet) cmdlet.\r \r ## <a name=\"related-information\"></a>相关信息\r \r [Azure 存储帐户](../storage/common/storage-create-storage-account.md)  \r [高可用性](analysis-services-bcdr.md)     \r [管理 Azure Analysis Services](analysis-services-manage.md)\r \r <!--Update_Description: update meta properties -->"}