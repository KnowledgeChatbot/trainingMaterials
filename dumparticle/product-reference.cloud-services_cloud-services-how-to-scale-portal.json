{"Title":"在门户中自动缩放云服务","Description":"了解如何使用门户在 Azure 中为云服务 Web 角色或辅助角色配置自动缩放规则。","Content":"# <a name=\"how-to-configure-auto-scaling-for-a-cloud-service-in-the-portal\"></a>如何在门户中为云服务配置自动缩放\r \r 针对云服务辅助角色设置条件，以触发缩减或扩展操作。 针对角色的条件可以基于 CPU、磁盘或角色的网络负载。 也可以基于消息队列或与订阅关联的其他一些 Azure 资源的指标来设置条件。\r \r >[!NOTE]\r > 本文着重于云服务 Web 和辅助角色。 如果直接创建虚拟机（经典），该虚拟机将托管在云服务中。 可以通过将标准虚拟机与[可用性集](../virtual-machines/windows/classic/configure-availability.md?toc=2fvirtual-machines%2fwindows%2fclassic%2ftoc.json)相关联来缩放标准虚拟机，并可以手动将其打开或关闭。\r \r ## <a name=\"considerations\"></a>注意事项\r 在配置应用程序的缩放之前，应考虑以下信息：\r \r - 缩放受内核使用情况影响。\r \r     角色实例越大，使用的核心越多。 只能在订阅的内核限制内缩放应用程序。 例如，假设订阅有 20 个核心的限制。 如果通过两个中等规模的云服务（一共 4 个核心）运行某个应用程序，则对于订阅中的其他云服务部署，只有 16 个核心的扩展空间。 有关大小的详细信息，请参阅[云服务的大小](./cloud-services-sizes-specs.md)。\r \r - 可以基于队列消息阈值来进行缩放。 有关如何使用队列的详细信息，请参阅[如何使用队列存储服务](../storage/queues/storage-dotnet-how-to-use-queues.md)。\r \r - 还可以缩放与订阅关联的其他资源。\r \r - 要启用应用程序的高可用性，应确保通过两个或更多角色实例来部署它。 有关详细信息，请参阅[服务级别协议](https://www.azure.cn/support/legal/sla/)。\r \r \r ## <a name=\"where-scale-is-located\"></a>缩放位置\r 选择云服务之后，应会看到云服务边栏选项卡。\r \r 1. 在云服务边栏选项卡上的“角色和实例”磁贴中，选择云服务的名称。   \r    **重要说明**：请务必单击云服务角色，而不是角色下面的角色实例。\r \r     ![](./media/cloud-services-how-to-scale-portal/roles-instances.png)\r 2. 选择“缩放”磁贴。\r \r     ![](./media/cloud-services-how-to-scale-portal/scale-tile.png)\r \r ## <a name=\"automatic-scale\"></a>自动缩放\r 可以使用**手动**或**自动**模式来配置角色的缩放设置。 顾名思义，“手动”模式可以设置实例的绝对计数。 但是，“自动”模式可让你设置规则来控制缩放的方式和程度。\r \r 将“缩放方式”选项设置为“计划和性能规则”。\r \r ![包含配置文件和规则的云服务缩放设置](./media/cloud-services-how-to-scale-portal/schedule-basics.png)\r \r 1. 现有的配置文件。\r 2. 添加父配置文件的规则。\r 3. 添加另一个配置文件。\r \r 选择“添加配置文件”。 配置文件确定了用于缩放的模式：**始终**、**定期**和**固定日期**。\r \r 配置了配置文件和规则之后，请选择顶部的“保存”图标。\r \r #### <a name=\"profile\"></a>配置文件\r 配置文件可设置缩放的实例数下限和上限，以及此缩放范围生效的时间。\r \r * **始终**\r \r     始终使此范围的实例数保持可用。  \r \r     ![始终缩放的云服务](./media/cloud-services-how-to-scale-portal/select-always.png)\r * **定期**\r \r     选择一组要缩放的星期日期。\r \r     ![使用定期计划的云服务缩放](./media/cloud-services-how-to-scale-portal/select-recurrence.png)\r * **固定日期**\r \r     要缩放角色的固定日期范围。\r \r     ![使用固定日期的云服务缩放](./media/cloud-services-how-to-scale-portal/select-fixed.png)\r \r 配置了配置文件之后，请选择配置文件边栏选项卡底部的“确定”按钮。\r \r #### <a name=\"rule\"></a>规则\r 规则添加到配置文件，代表触发缩放的条件。 \r \r 规则触发器基于云服务的指标（CPU 使用量、磁盘活动或网络活动），可以在其中添加条件值。 此外，也可以基于消息队列或与订阅关联的其他一些 Azure 资源的指标来设置触发器。\r \r ![](./media/cloud-services-how-to-scale-portal/rule-settings.png)\r \r 配置规则之后，请选择规则边栏选项卡底部的“确定”按钮。\r \r ## <a name=\"back-to-manual-scale\"></a>返回到手动缩放\r 导航到[缩放设置](#where-scale-is-located)，并将“缩放依据”选项设置为“手动输入的实例计数”。\r \r ![包含配置文件和规则的云服务缩放设置](./media/cloud-services-how-to-scale-portal/manual-basics.png)\r \r 此设置会删除角色中的自动缩放，用户就可以直接设置实例计数。 \r \r 1. 缩放（手动或自动）选项。\r 2. 角色实例滑块，用于设置要缩放的实例。\r 3. 要缩放的角色实例。\r \r 配置缩放设置后，请选择顶部的 **保存** 图标。\r \r <!--Update_Description:update meta properties and wording-->"}