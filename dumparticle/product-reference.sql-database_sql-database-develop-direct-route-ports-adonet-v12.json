{"Title":"用于 SQL 数据库的非 1433 端口","Description":"从 ADO.NET 到 Azure SQL 数据库的客户端连接可以绕过代理直接通过 1433 以外的端口与数据库交互。","Content":"# <a name=\"ports-beyond-1433-for-adonet-45\"></a>用于 ADO.NET 4.5 的非 1433 端口\r 本主题介绍使用 ADO.NET 4.5 或更高版本的客户端的 Azure SQL 数据库连接行为。 \r \r > [!IMPORTANT]\r > 有关连接体系结构的信息，请参阅 [Azure SQL 数据库连接体系结构](sql-database-connectivity-architecture.md)。\r >\r \r ## <a name=\"outside-vs-inside\"></a>外部与内部\r 对于 Azure SQL 数据库的连接，首先必须询问客户端程序是在 Azure 云边界*外部*还是*内部*运行。 以下小节讨论了两种常见方案。\r \r #### <a name=\"outside-client-runs-on-your-desktop-computer\"></a>*外部：* 客户端在台式计算机上运行\r 端口 1433 是托管 SQL 数据库客户端应用程序的台式计算机上唯一必须打开的端口。\r \r #### <a name=\"inside-client-runs-on-azure\"></a>*内部：* 客户端在 Azure 上运行\r 如果客户端在 Azure 云边界内部运行，则它使用我们所谓的*直接路由*来与 SQL 数据库服务器交互。 建立连接后，客户端与数据库之间的进一步交互不涉及到任何中间件代理。\r \r 顺序如下：\r \r 1. ADO.NET 4.5（或更高版本）发起与 Azure 云的简短交互，并接收动态识别的端口号。\r \r    * 动态识别的端口号范围为 11000-11999 或 14000-14999。\r 2. 然后，ADO.NET 不通过任何中间件直接连接到 SQL 数据库服务器。\r 3. 查询直接发送到数据库，结果直接返回到客户端。\r \r 确保 Azure 客户端计算机上 11000-11999 和 14000-14999 的端口范围已保留，供 ADO.NET 4.5 客户端与 SQL 数据库的交互使用。\r \r * 具体而言，范围中的端口必须没有其他任何出站阻塞器。\r * 在 Azure VM 上， **高级安全 Windows 防火墙** 控制端口设置。\r \r   * 可以使用[防火墙的用户界面](http://msdn.microsoft.com/library/cc646023.aspx)为指定 **TCP** 协议以及语法类似于 **11000-11999** 的端口范围添加规则。\r \r ## <a name=\"version-clarifications\"></a>版本澄清\r 本部分澄清引用产品版本的 Moniker。 此外还列出了产品之间的版本配对。\r \r #### <a name=\"adonet\"></a>ADO.NET\r * ADO.NET 4.0 支持 TDS 7.3 协议，但不支持 7.4。\r * ADO.NET 4.5 和更高版本支持 TDS 7.4 协议。\r \r ## <a name=\"related-links\"></a>相关链接\r * ADO.NET 4.6 已于 2015 年 7 月 20 日发布。 可以在 [此处](http://blogs.msdn.com/b/dotnet/archive/2015/07/20/announcing-net-framework-4-6.aspx)访问 .NET 团队的博客通告。\r * ADO.NET 4.5 已于 2012 年 8 月 15 日发布。 可以在 [此处](http://blogs.msdn.com/b/dotnet/archive/2012/08/15/announcing-the-release-of-net-framework-4-5-rtm-product-and-source-code.aspx)访问 .NET 团队的博客通告。\r \r   * 可以在 [此处](http://blogs.msdn.com/b/dotnet/archive/2013/06/26/announcing-the-net-framework-4-5-1-preview.aspx)访问有关 ADO.NET 4.5.1 的博客文章。\r * [TDS 协议版本列表](http://www.freetds.org/userguide/tdshistory.htm)\r * [SQL 数据库开发概述](sql-database-develop-overview.md)\r * [Azure SQL 数据库防火墙](sql-database-firewall-configure.md)\r * [如何：在 SQL 数据库上配置防火墙设置](sql-database-configure-firewall-settings.md)\r "}