{"Title":"排查性能问题和优化数据库","Description":"将性能建议应用到 SQL 数据库，并了解如何获取有关针对数据库运行的查询的性能见解","Content":"# 排查性能问题和优化数据库\r <a name=\"troubleshoot-performance-issues-and-optimize-your-database\"></a>\r \r 缺少索引与查询优化不足是数据库性能不佳的常见原因。 本教程介绍以下内容：\r > [!div class=\"checklist\"]\r > * 查看、应用和撤销性能改善建议\r > * 查找资源使用率较高的查询\r > * 查找长时间运行的查询\r \r > 需要针对存在性能问题（例如，缺少索引）的数据库持续运行一个工作负荷，以接收建议。\r >\r \r ## 登录到 Azure 门户\r <a name=\"log-in-to-the-azure-portal\"></a>\r \r 登录到 [Azure 门户](https://portal.azure.cn/)。\r \r ## 查看并应用建议\r <a name=\"review-and-apply-a-recommendation\"></a>\r \r 遵循以下步骤，对数据库应用系统提供的建议：\r \r 1. 在数据库边栏选项卡中单击“性能建议”菜单。\r \r     ![性能建议](./media/sql-database-performance-tutorial/perf_recommendations.png)\r \r 2. 在建议列表中，选择一条有效的建议。 在本示例中，该建议为“创建索引”。\r \r     ![选择建议](./media/sql-database-performance-tutorial/create_index.png)\r \r 3. 单击“应用”按钮应用该建议。 （可选）查看建议详细信息，然后单击“查看脚本”按钮查看要执行的 T-SQL 脚本。\r \r     ![应用建议](./media/sql-database-performance-tutorial/apply.png)\r \r 4. [可选] 启用自动优化，以自动应用建议。\r \r     ![自动优化](./media/sql-database-performance-tutorial/auto_tuning.png)\r \r ## 撤销建议\r <a name=\"revert-a-recommendation\"></a>\r \r 数据库顾问会监视实施的每条建议。 如果某条建议未改善工作负荷，该建议将自动被撤销。 可以手动撤销建议，但大多数情况下不需要这样做。 撤销建议：\r \r 1. 转到性能建议菜单，然后选择一条已应用的建议。\r \r     ![选择建议](./media/sql-database-performance-tutorial/select.png)\r \r 2. 在详细信息视图中，单击“撤销”。\r \r     ![撤销建议](./media/sql-database-performance-tutorial/revert.png)\r \r ## 查找资源消耗量最大的查询\r <a name=\"find-the-query-that-consumes-the-most-resources\"></a>\r \r 遵循以下步骤查找资源消耗量最大的查询：\r \r 1. 在数据库边栏选项卡中单击“查询性能见解”菜单。\r \r     ![查询见解](./media/sql-database-performance-tutorial/query_perf_insights.png)\r \r 2. 选择资源类型。\r \r     ![查询见解](./media/sql-database-performance-tutorial/select_resource_type.png)\r \r 3. 选择表中的第一个查询。\r \r     ![查询见解](./media/sql-database-performance-tutorial/select_query.png)\r \r 4. 查看查询详细信息。\r \r     ![查询见解](./media/sql-database-performance-tutorial/query_details.png)\r \r ## 查找运行时间最长的查询\r <a name=\"find-the-longest-running-query\"></a>\r \r 1. 转到“查询性能见解”，然后选择“长时间运行的查询”选项卡。\r \r     ![查询见解](./media/sql-database-performance-tutorial/long_running.png)\r \r 3. 选择表中的第一个查询。\r \r     ![查询见解](./media/sql-database-performance-tutorial/select_first_query.png)\r \r 4. 查看查询详细信息。\r \r     ![查询见解](./media/sql-database-performance-tutorial/review_query_details.png)\r \r \r \r ## 后续步骤\r <a name=\"next-steps\"></a> \r 缺少索引与查询优化不足是数据库性能不佳的常见原因。 本教程介绍了：\r > [!div class=\"checklist\"]\r > * 查看、应用和撤销性能改善建议\r > * 查找资源使用率较高的查询\r > * 查找长时间运行的查询\r \r [SQL 数据库性能优化提示](sql-database-troubleshoot-performance.md)"}