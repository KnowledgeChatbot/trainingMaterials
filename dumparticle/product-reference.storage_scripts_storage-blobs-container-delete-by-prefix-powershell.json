{"Title":"Azure PowerShell 脚本示例 - 根据前缀删除容器","Description":"根据容器名称前缀删除 Azure 存储 blob 容器。","Content":"# <a name=\"delete-containers-based-on-container-name-prefix\"></a>根据容器名称前缀删除容器\r \r 此脚本根据容器名称的前缀删除 Azure Blob 存储中的容器。\r \r [!INCLUDE [sample-powershell-install](../../../includes/sample-powershell-install-no-ssh.md)]\r \r [!INCLUDE [quickstarts-free-trial-note](../../../includes/quickstarts-free-trial-note.md)]\r \r ## <a name=\"sample-script\"></a>示例脚本\r \r ```powershell\r # this script will show how to delete containers with a specific prefix \r # the prefix this will search for is \"image\". \r # before running this, you need to create a storage account, create some containers,\r #    some having the same prefix so you can test this\r # note: this retrieves all of the matching containers in one command \r #       if you are going to run this against a storage account with a lot of containers\r #       (more than a couple hundred), use continuation tokens to retrieve\r #       the list of containers. We will be adding a sample showing that scenario in the future.\r \r # these are for the storage account to be used\r #   and the prefix for which to search\r $resourceGroup = \"containerdeletetestrg\"\r $location = \"China East\"\r $storageAccountName = \"containerdeletetest\"\r $prefix = \"image\"\r \r # get a reference to the storage account and the context\r $storageAccount = Get-AzureRmStorageAccount `\r   -ResourceGroupName $resourceGroup `\r   -Name $storageAccountName\r $ctx = $storageAccount.Context \r \r # list all containers in the storage account \r Write-Host \"All containers\"\r Get-AzureStorageContainer -Context $ctx | select Name\r \r # retrieve list of containers to delete\r $listOfContainersToDelete = Get-AzureStorageContainer -Context $ctx -Prefix $prefix\r \r # write list of containers to be deleted \r Write-Host \"Containers to be deleted\"\r $listOfContainersToDelete | select Name\r \r # delete the containers; this pipes the result of the listing of the containers to delete\r #    into the Remove-AzureStorageContainer command. It handles all of the containers in the list.\r Write-Host \"Deleting containers\"\r $listOfContainersToDelete | Remove-AzureStorageContainer -Context $ctx \r \r # show list of containers not deleted \r Write-Host \"All containers not deleted\"\r Get-AzureStorageContainer -Context $ctx | select Name\r ```\r \r ## <a name=\"clean-up-deployment\"></a>清理部署 \r \r 运行以下命令，删除资源组、其余容器和所有相关资源。\r \r ```powershell\r Remove-AzureRmResourceGroup -Name containerdeletetestrg\r ```\r \r ## <a name=\"script-explanation\"></a>脚本说明\r \r 此脚本使用以下命令根据容器名称前缀删除容器。 表中的每一项均链接到命令特定的文档。\r \r | 命令 | 说明 |\r |---|---|\r | [Get-AzureRmStorageAccount](https://docs.microsoft.com/powershell/module/azurerm.storage/get-azurermstorageaccount) | 获取资源组或订阅中的指定存储帐户或所有存储帐户。 |\r | [Get-AzureStorageContainer](https://docs.microsoft.com/powershell/module/azure.storage/get-azurestoragecontainer) | 列出与存储帐户关联的存储容器。 |\r | [Remove-AzureStorageContainer](https://docs.microsoft.com/powershell/module/azure.storage/remove-azurestoragecontainer) | 删除指定的存储容器。 |\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 有关 Azure PowerShell 模块的详细信息，请参阅 [Azure PowerShell 文档](https://docs.microsoft.com/powershell/azure/overview)。\r \r 有关其他存储 PowerShell 脚本示例，可参阅 [Azure Blob 存储的 PowerShell 示例](../blobs/storage-samples-blobs-powershell.md)。\r "}