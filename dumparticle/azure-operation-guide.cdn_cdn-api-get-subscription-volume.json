{"Title":"Azure China CDN API doc-get subscription usage","Description":"Learn How to create Live Streaming acceleration type CDN on Azure Management Portal and default caching rules for Live Streaming CDN","Content":"\r # 流量-获取订阅下所有节点流量信息\r \r > [!div class=\"op_single_selector\"]\r > * [中文](https://docs.azure.cn/zh-cn/cdn/cdn-api-get-subscription-volume)\r > * [英文](https://docs.azure.cn/en-us/cdn/cdn-api-get-subscription-volume)\r \r ## 请求\r <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r   <th align=\"left\"><strong>方法</strong>\r     </td>\r   <th align=\"left\"><strong>请求 URI</strong>\r     </td>  \r   <tr>\r     <td>GET</td>\r     <td>https://restapi.cdn.azure.cn/subscriptions/{subscriptionId}/endpoints/{endpointId}/volume?apiVersion=1.0</td>\r   </tr>\r </table>\r \r ### URI参数\r <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r   <th align=\"left\"><strong>参数名</strong>\r     </td>\r   <th align=\"left\"><strong>描述</strong>\r     </td>  \r   <tr>\r     <td>subscriptionId</td>\r     <td>订阅唯一标识</td>\r   </tr\r   <tr>\r     <td>endpointId</td>\r     <td>目标节点唯一标识</td>\r   </tr>\r   <tr>\r     <td>startTime</td>\r     <td>流量查询起始时间，必须符合'yyyy-MM-ddThh:mm:ssZ’格式的UTC时间\r   </td>\r   </tr>\r   <tr>\r     <td>endTime</td>\r     <td>流量查询结束时间，必须符合'yyyy-MM-ddThh:mm:ssZ’格式的UTC时间\r     </td>\r   </tr>\r   <tr>\r     <td>granularity</td>\r     <td>流量统计粒度。\r     <ul>\r        <li>PerFiveMinutes:按五分钟</li>\r        <li>PerHour：按小时</li>\r        <li>PerDay：按天</li>\r     </ul></td>\r   </tr>\r </table>\r \r ### 请求 Headers\r \r | 请求包头 | 描述 |\r |:-----------|:-----------|\r | x-azurecdn-request-date | 必填。符合yyyy-MM-dd hh:mm:ss格式的UTC当前请求时间 |\r | Authorization | 必填。授权头请参考[CDN API签名机制](./cdn-api-signature.md) |\r \r ### 请求 Body\r 无\r \r ## 响应\r \r 响应由状态码，响应 headers以及响应 body组成。\r ### 状态码\r <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r   <th align=\"left\"><strong>状态码</strong>\r     </td>\r   <th align=\"left\"><strong>描述</strong>\r     </td>\r   <tr>\r     <td>200</td>\r     <td>表明服务器成功返回</td>\r   </tr>\r   <tr>\r     <td>其他</td>\r     <td>表示出错的通用回复</td>\r   </tr>\r </table>\r \r ### 响应 Headers\r \r <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r   <th align=\"left\"><strong>响应包头</strong>\r     </th>\r   <th align=\"left\"><strong>描述</strong>\r     </th>\r \r   <tr>\r     <td>X-Correlation-Id</td>\r     <td>该请求唯一标识，用于追踪请求信息。</td>\r   </tr>\r </table>\r \r ### 响应 Body\r **请求成功的JSON示例**:：\r ```\r {\r   \"Details\": {\r     \"www.example1.com\": {\r       \"DomainName\": \"www.example1.com\",\r       \"Items\": [\r         {\r           \"Timestamp\": \"2017-05-01T16:00:00Z\",\r           \"VolumeInMB\": 100,\r           \"OriginVolumeInMB\": 20\r         },\r         {\r           \"Timestamp\": \"2017-05-02T16:00:00Z\",\r           \"VolumeInMB\": 200,\r           \"OriginVolumeInMB\": 40\r         }\r       ],\r       \"TotalCdnVolumeInMB\": 300,\r       \"TotalOriginVolumeInMB\": 60\r     },\r     \"www.example2.com\": {\r       \"DomainName\": \"www.example2.com\",\r       \"Items\": [\r         {\r           \"Timestamp\": \"2017-05-01T16:00:00Z\",\r           \"VolumeInMB\": 100,\r           \"OriginVolumeInMB\": 20\r         },\r         {\r           \"Timestamp\": \"2017-05-02T16:00:00Z\",\r           \"VolumeInMB\": 200,\r           \"OriginVolumeInMB\": 40\r         }\r       ],\r       \"TotalCdnVolumeInMB\": 300,\r       \"TotalOriginVolumeInMB\": 60\r     },\r   \"TotalCdnVolumeInMB\": 600,\r   \"TotalOriginVolumeInMB\": 120\r }\r ```\r <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r   <th align=\"left\"><strong>参数名称</strong>\r     </td>\r   <th align=\"left\"><strong>描述</strong>\r     </td>\r \r   <tr>\r     <td>DomainName</td>\r     <td>加速域名</td>\r   </tr>\r   <tr>\r     <td>VolumeInMB</td>\r     <td>CDN流量</td>\r   </tr>\r   <tr>\r     <td>OriginVolumeInMB</td>\r     <td>回源流量</td>\r   </tr>\r   <tr>\r     <td>TotalCdnVolumeInMB</td>\r     <td>CDN总流量</td>\r   </tr>\r   <tr>\r     <td>TotalOriginVolumeInMB</td>\r     <td>回源总流量</td>\r   </tr>\r </table>\r \r **请求失败的JSON示例**:\r ```\r {\r   \"Succeeded\": false,\r   \"ErrorInfo\": {\r     \"Type\": \"MissingAuthorizationHeader\",\r     \"Message\": \"Missing authorization header.\"\r   }\r }\r ```\r <table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\r   <th align=\"left\"><strong>参数名称</strong>\r     </td>\r   <th align=\"left\"><strong>描述</strong>\r     </td>\r \r   <tr>\r     <td>Type</td>\r     <td>错误类型\r          <ul>\r             <li>CredentialInvalid:凭据不合法</li>\r             <li>ParameterMissing:缺少参数</li>\r             <li>ParameterInvalid：参数不合法</li>\r             <li>MissingAuthorizationHeader:缺少Authorization请求头</li>\r             <li>InvalidRequestDateHeader:请求时间不合法</li>\r             <li>MissingRequestDateHeader：缺少请求时间头</li>\r             <li>AuthorizationHeaderExpired:Authorization请求头已失效</li>\r             <li>InvalidAuthorizationHeader:Authorization请求头不合法</li>\r             <li>ApiKeyNotFound：API密钥不存在</li>\r             <li>InvalidApiKey:API密钥不合法</li>\r             <li>WrongSignature:签名不对</li>\r             <li>SubscriptionNotFound：订阅不存在</li>\r             <li>EndpointDoesNotBelongToSubscription：节点不属于订阅</li>\r             <li>EndpointNotInActiveState：节点不处于活跃状态</li>\r             <li>EndpointNotFound：节点不存在</li>\r             <li>MaliciousItemPathDetected：检查到恶意路径</li>\r             <li>PermissionDenied：权限不够</li>\r             <li>RequestThrottled：请求被限流</li>\r          </ul>    \r     </td>\r   </tr>\r   <tr>\r     <td>Message</td>\r     <td>错误信息</td>\r   </tr>\r </table>"}