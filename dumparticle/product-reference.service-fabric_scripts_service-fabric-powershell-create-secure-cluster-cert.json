{"Title":"Azure PowerShell 脚本示例 - 创建 Service Fabric 群集","Description":"Azure PowerShell 脚本示例 - 创建 Service Fabric 群集。","Content":"# <a name=\"create-a-service-fabric-cluster\"></a>创建 Service Fabric 群集\r \r 此示例脚本将创建一个由五个节点组成的 Service Fabric 群集（使用 X.509 证书保护的群集）。  该命令将创建一个自签名证书，并将其上传到新的 Key Vault。 该证书也会复制到本地目录。  设置 *-OS* 参数可选择群集节点上运行的 Windows 或 Linux 的版本。  根据需要自定义参数。\r \r 必要时，请使用 [Azure PowerShell 指南](https://docs.microsoft.com/powershell/azure/overview)中的说明安装 Azure PowerShell，并运行 `Login-AzureRmAccount -EnvironmentName AzureChinaCloud` 创建与 Azure 的连接。 \r \r ## <a name=\"sample-script\"></a>示例脚本\r \r ```powershell\r #Provide the subscription Id\r $subscriptionId = 'yourSubscriptionId'\r \r # Certificate variables.\r $certpwd=\"Password#1234\" | ConvertTo-SecureString -AsPlainText -Force\r $certfolder=\"c:\\mycertificates\\\"\r \r # Variables for VM admin.\r $adminuser=\"vmadmin\"\r $adminpwd=\"Password#1234\" | ConvertTo-SecureString -AsPlainText -Force \r \r # Variables for common values\r $clusterloc=\"chinaeast\"\r $clustername = \"mysfcluster\"\r $groupname=\"mysfclustergroup\"       \r $vmsku = \"Standard_D2_v2\"\r $vaultname = \"mykeyvault\"\r $subname=\"$clustername.$clusterloc.cloudapp.chinacloudapi.cn\"\r \r # Set the number of cluster nodes. Possible values: 1, 3-99\r $clustersize=5 \r \r # Set the context to the subscription Id where the cluster will be created\r Select-AzureRmSubscription -SubscriptionId $subscriptionId\r \r # Create the Service Fabric cluster.\r New-AzureRmServiceFabricCluster -Name $clustername -ResourceGroupName $groupname -Location $clusterloc `\r -ClusterSize $clustersize -VmUserName $adminuser -VmPassword $adminpwd -CertificateSubjectName $subname `\r -CertificatePassword $certpwd -CertificateOutputFolder $certfolder `\r -OS WindowsServer2016DatacenterwithContainers -VmSku $vmsku -KeyVaultName $vaultname\r ```\r \r ## <a name=\"clean-up-deployment\"></a>清理部署 \r \r 运行脚本示例后，可以使用以下命令删除资源组、群集以及所有相关资源。\r \r ```powershell\r $groupname=\"mysfclustergroup\"\r Remove-AzureRmResourceGroup -Name $groupname -Force\r ```\r \r ## <a name=\"script-explanation\"></a>脚本说明\r \r 此脚本使用以下命令。 表中的每条命令均链接到特定于命令的文档。\r \r | 命令 | 说明 |\r |---|---|\r | [New-AzureRmServiceFabricCluster](https://docs.microsoft.com/powershell/module/azurerm.servicefabric/New-AzureRmServiceFabricCluster) | 新建 Service Fabric 群集。 |\r \r ## <a name=\"next-steps\"></a>后续步骤\r \r 有关 Azure PowerShell 模块的详细信息，请参阅 [Azure PowerShell 文档](https://docs.microsoft.com/powershell/azure/overview)。\r \r 可以在 [Azure PowerShell 示例](../service-fabric-powershell-samples.md)中找到 Azure Service Fabric 的其他 Azure Powershell 示例。\r <!--Update_Description: update meta properties, wording update-->"}