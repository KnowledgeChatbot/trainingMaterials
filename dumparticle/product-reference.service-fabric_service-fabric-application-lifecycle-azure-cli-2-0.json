{"Title":"使用 Azure CLI 2.0 管理 Azure Service Fabric 应用程序","Description":"了解如何使用 Azure CLI 2.0 在 Azure Service Fabric 群集中部署和删除应用程序。","Content":"# <a name=\"manage-an-azure-service-fabric-application-by-using-azure-cli-20\"></a>使用 Azure CLI 2.0 管理 Azure Service Fabric 应用程序\r \r 了解如何创建和删除在 Azure Service Fabric 群集中运行的应用程序。\r \r ## <a name=\"prerequisites\"></a>先决条件\r \r * 安装 Azure CLI 2.0。 然后选择 Service Fabric 群集。 有关详细信息，请参阅 [Azure CLI 2.0 入门](service-fabric-azure-cli-2-0.md)。\r \r * 已准备好随时可供部署的 Service Fabric 应用程序包。 有关如何创建和打包应用程序的详细信息，请参阅 [Service Fabric 应用程序模型](service-fabric-application-model.md)。\r \r ## <a name=\"overview\"></a>概述\r \r 若要部署新应用程序，请完成以下步骤：\r \r 1. 将应用程序包上传到 Service Fabric 映像存储中。\r 2. 预配应用程序类型。\r 3. 指定并创建应用程序。\r 4. 指定并创建服务。\r \r 若要删除现有应用程序，请完成以下步骤：\r \r 1. 删除应用程序。\r 2. 取消预配关联的应用程序类型。\r 3. 删除映像存储内容。\r \r ## <a name=\"deploy-a-new-application\"></a>部署新应用程序\r \r 若要部署新应用程序，请完成以下任务：\r \r ### <a name=\"upload-a-new-application-package-to-the-image-store\"></a>将新应用程序包上传到映像存储区\r \r 在创建应用程序之前，先将应用程序包上传到 Service Fabric 映像存储。 \r \r 例如，如果应用程序包在 `app_package_dir` 目录中，请使用以下命令上传该目录：\r \r ```azurecli\r az sf application upload --path ~/app_package_dir\r ```\r \r 对于大型应用程序包，可以指定 `--show-progress` 选项来显示上传进度。\r \r ### <a name=\"provision-the-application-type\"></a>预配应用程序类型\r \r 完成上传后，预配应用程序。 若要预配应用程序，请运行以下命令：\r \r ```azurecli\r az sf application provision --application-type-build-path app_package_dir\r ```\r \r `application-type-build-path` 的值是将应用程序包上传到的目录的名称。\r \r ### <a name=\"create-an-application-from-an-application-type\"></a>基于应用程序类型创建应用程序\r \r 预配应用程序后，使用以下命令来命名并创建应用程序：\r \r ```azurecli\r az sf application create --app-name fabric:/TestApp --app-type TestAppType --app-version 1.0\r ```\r \r `app-name` 是要用于应用程序实例的名称。 可以从前面预配的应用程序清单获取其他参数。\r \r 应用程序名称必须以 `fabric:/` 前缀开头。\r \r ### <a name=\"create-services-for-the-new-application\"></a>为新应用程序创建服务\r \r 创建应用程序后，通过该应用程序创建服务。 在以下示例中，我们通过自己的应用程序创建新的无状态服务。 在前面预配的应用程序包中的服务清单内，定义可通过应用程序创建的服务。\r \r ```azurecli\r az sf service create --app-id TestApp --name fabric:/TestApp/TestSvc --service-type TestServiceType \\\r --stateless --instance-count 1 --singleton-scheme\r ```\r \r ## <a name=\"verify-application-deployment-and-health\"></a>验证应用程序部署和运行状况\r \r 若要验证是否已成功部署某个应用程序和服务，请检查是否已列出该应用程序和服务：\r \r ```azurecli\r az sf application list\r az sf service list --application-list TestApp\r ```\r \r 若要验证服务是否正常运行，请使用类似的命令检索服务和应用程序的运行状况：\r \r ```azurecli\r az sf application health --application-id TestApp\r az sf service health --service-id TestApp/TestSvc\r ```\r \r 正常的服务和应用程序的 `HealthState` 值为 `Ok`。\r \r ## <a name=\"remove-an-existing-application\"></a>删除现有应用程序\r \r 若要移除应用程序，请完成以下任务。\r \r ### <a name=\"delete-the-application\"></a>删除应用程序\r \r 若要删除应用程序，请使用以下命令：\r \r ```azurecli\r az sf application delete --application-id TestEdApp\r ```\r \r ### <a name=\"unprovision-the-application-type\"></a>取消预配应用程序类型\r \r 删除应用程序后，如果不再需要它，可以取消预配应用程序类型。 若要取消预配应用程序类型，请使用以下命令：\r \r ```azurecli\r az sf application unprovision --application-type-name TestAppTye --application-type-version 1.0\r ```\r \r 类型名称和类型版本必须与前面预配的应用程序清单中的名称和版本匹配。\r \r ### <a name=\"delete-the-application-package\"></a>删除应用程序包\r \r 取消预配应用程序类型后，如果不再需要应用程序包，可从映像存储中删除它。 删除应用程序包有助于回收磁盘空间。 \r \r 若要从映像存储中删除应用程序包，请使用以下命令：\r \r ```azurecli\r az sf application package-delete --content-path app_package_dir\r ```\r \r `content-path` 必须是创建应用程序时上传的目录的名称。\r \r ## <a name=\"related-articles\"></a>相关文章\r \r * [Service Fabric 和 Azure CLI 2.0 入门](service-fabric-azure-cli-2-0.md)\r * [Service Fabric XPlat CLI 入门](service-fabric-azure-cli.md)"}