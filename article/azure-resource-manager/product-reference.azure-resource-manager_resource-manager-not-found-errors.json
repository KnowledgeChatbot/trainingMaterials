{"Title":"Azure 资源找不到错误","Description":"说明如何在找不到资源时解决错误。","Content":"# <a name=\"resolve-not-found-errors-for-azure-resources\"></a>解决 Azure 资源找不到错误\r\n\r\n本文介绍在部署过程中找不到资源时可能遇到的错误。 \r\n\r\n## <a name=\"symptom\"></a>症状\r\n\r\n如果模板包含无法解析的资源的名称，将出现类似于下面的错误：\r\n\r\n```\r\nCode=NotFound;\r\nMessage=Cannot find ServerFarm with name exampleplan.\r\n```\r\n\r\n如果尝试对无法解析的资源使用 [reference](resource-group-template-functions-resource.md#reference) 或 [listKeys](resource-group-template-functions-resource.md#listkeys) 函数，则会收到以下错误：\r\n\r\n```\r\nCode=ResourceNotFound;\r\nMessage=The Resource 'Microsoft.Storage/storageAccounts/{storage name}' under resource\r\ngroup {resource group name} was not found.\r\n```\r\n\r\n## <a name=\"cause\"></a>原因\r\n\r\n资源管理器需要检索资源的属性，但无法确定订阅中的资源。\r\n\r\n## <a name=\"solution\"></a>解决方案\r\n\r\n### <a name=\"solution-1\"></a>解决方案 1\r\n\r\n若要部署模板中缺少的资源，请检查是否需要添加依赖关系。 如果可能，Resource Manager 将通过并行创建资源来优化部署。 如果一个资源必须在另一个资源之后部署，则需在模板中使用 **dependsOn** 元素创建与其他资源的依赖关系。 例如，在部署 Web 应用时，应用服务计划必须存在。 如果未指定该 Web 应用与应用服务计划的依赖关系，则 Resource Manager 会同时创建这两个资源。 会收到一条错误消息，指出未能找到应用服务计划资源，因为尝试在 Web 应用上设置属性时它尚不存在。 在 Web 应用中设置依赖关系可避免此错误。\r\n\r\n```json\r\n{\r\n  \"apiVersion\": \"2015-08-01\",\r\n  \"type\": \"Microsoft.Web/sites\",\r\n  \"dependsOn\": [\r\n    \"[variables('hostingPlanName')]\"\r\n  ],\r\n  ...\r\n}\r\n```\r\n\r\n有关依赖项错误的故障诊断建议，请参阅 [检查部署顺序](resource-manager-troubleshoot-tips.md#check-deployment-sequence)。\r\n\r\n### <a name=\"solution-2\"></a>解决方案 2\r\n\r\n当资源未存在于要部署到的资源组中时，请使用 [resourceId 函数](resource-group-template-functions-resource.md#resourceid)获取资源的完全限定名称。\r\n\r\n```json\r\n\"properties\": {\r\n    \"name\": \"[parameters('siteName')]\",\r\n    \"serverFarmId\": \"[resourceId('plangroup', 'Microsoft.Web/serverfarms', parameters('hostingPlanName'))]\"\r\n}\r\n```\r\n\r\n### <a name=\"solution-3\"></a>解决方案 3\r\n\r\n查找包含 [reference](resource-group-template-functions-resource.md#reference) 函数的表达式。 提供的值因资源是否位于同一模板、资源组和订阅中而有所不同。 请仔细检查是否为方案提供了所需的参数值。 如果资源位于不同的资源组中，请提供完整的资源 ID。 例如，若要引用另一个资源组中的存储帐户，请使用：\r\n\r\n```json\r\n\"[reference(resourceId('exampleResourceGroup', 'Microsoft.Storage/storageAccounts', 'myStorage'), '2017-06-01')]\"\r\n```\r\n\r\n\r\n<!--Update_Description: new articles on Resource Manager not found errors-->"}