{"Title":"模板中的 Azure 资源位置","Description":"演示如何在 Azure Resource Manager 模板中设置资源位置","Content":"# <a name=\"set-resource-location-in-azure-resource-manager-templates\"></a>在 Azure Resource Manager 模板中设置资源位置\r\n部署模板时，必须提供每个资源的位置。 本主题说明如何确定可用于每种资源类型的订阅的位置。\r\n\r\n## <a name=\"determine-supported-locations\"></a>确定支持的位置\r\n\r\n有关每种资源类型支持的位置的完整列表，请参阅 [可用产品（按区域）](https://www.azure.cn/support/service-dashboard)。 但是，订阅可能无法访问该列表中的所有位置。 若要查看可用于订阅的位置的自定义列表，请使用 Azure PowerShell 或 Azure CLI。 \r\n\r\n以下示例使用 PowerShell 获取 `Microsoft.Web\\sites` 资源类型的位置：\r\n\r\n```powershell\r\n((Get-AzureRmResourceProvider -ProviderNamespace Microsoft.Web).ResourceTypes | Where-Object ResourceTypeName -eq sites).Locations\r\n```\r\n\r\n以下示例使用 Azure CLI 2.0获取 `Microsoft.Web\\sites` 资源类型的位置：\r\n\r\n```azurecli\r\naz provider show -n Microsoft.Web --query \"resourceTypes[?resourceType=='sites'].locations\"\r\n```\r\n\r\n## <a name=\"set-location-in-template\"></a>在模板中设置位置\r\n\r\n确定资源支持的位置后，需要在模板中设置该位置。 设置此值的最简单方法是在支持资源类型的位置中创建资源组，并将每个位置设置为 `[resourceGroup().location]`。 可以将模板重新部署到不同位置中的资源组，而不更改模板或参数中的任何值。 \r\n\r\n以下示例显示了部署到资源组所在位置的存储帐户：\r\n\r\n```json\r\n{\r\n    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n    \"contentVersion\": \"1.0.0.0\",\r\n    \"variables\": {\r\n      \"storageName\": \"[concat('storage', uniqueString(resourceGroup().id))]\"\r\n    },\r\n    \"resources\": [\r\n    {\r\n      \"apiVersion\": \"2016-01-01\",\r\n      \"type\": \"Microsoft.Storage/storageAccounts\",\r\n      \"name\": \"[variables('storageName')]\",\r\n      \"location\": \"[resourceGroup().location]\",\r\n      \"tags\": {\r\n        \"Dept\": \"Finance\",\r\n        \"Environment\": \"Production\"\r\n      },\r\n      \"sku\": {\r\n        \"name\": \"Standard_LRS\"\r\n      },\r\n      \"kind\": \"Storage\",\r\n      \"properties\": { }\r\n    }\r\n    ]\r\n}\r\n```\r\n\r\n如果需要在模板中对位置进行硬编码，请提供其中一个支持的区域名称。 以下示例显示了始终部署到中国北部的存储帐户：\r\n\r\n```json\r\n{\r\n    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n    \"contentVersion\": \"1.0.0.0\",\r\n    \"resources\": [\r\n    {\r\n      \"apiVersion\": \"2016-01-01\",\r\n      \"type\": \"Microsoft.Storage/storageAccounts\",\r\n      \"name\": \"[concat('storageloc', uniqueString(resourceGroup().id))]\",\r\n      \"location\": \"China North\",\r\n      \"tags\": {\r\n        \"Dept\": \"Finance\",\r\n        \"Environment\": \"Production\"\r\n      },\r\n      \"sku\": {\r\n        \"name\": \"Standard_LRS\"\r\n      },\r\n      \"kind\": \"Storage\",\r\n      \"properties\": { }\r\n    }\r\n    ]\r\n}\r\n```\r\n\r\n## <a name=\"next-steps\"></a>后续步骤\r\n* 有关如何创建模板的建议，请参阅[创建 Azure Resource Manager 模板的最佳实践](resource-manager-template-best-practices.md)。\r\n\r\n<!--Update_Description: update link-->"}