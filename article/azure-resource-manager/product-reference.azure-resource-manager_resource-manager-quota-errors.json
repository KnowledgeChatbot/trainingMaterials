{"Title":"Azure 配额错误","Description":"说明如何解决资源配额错误。","Content":"# <a name=\"resolve-errors-for-resource-quotas\"></a>解决资源配额错误\r\n\r\n本文介绍部署资源时可能遇到的配额错误。\r\n\r\n## <a name=\"symptom\"></a>症状\r\n\r\n如果部署一个创建超过 Azure 配额的资源的模板，则会收到如下所示的部署错误：\r\n\r\n```\r\nCode=OperationNotAllowed\r\nMessage=Operation results in exceeding quota limits of Core.\r\nMaximum allowed: 4, Current in use: 4, Additional requested: 2.\r\n```\r\n\r\n或者，可能会看到：\r\n\r\n```\r\nCode=ResourceQuotaExceeded\r\nMessage=Creating the resource of type <resource-type> would exceed the quota of <number>\r\nresources of type <resource-type> per resource group. The current resource count is <number>,\r\nplease delete some resources of this type before creating a new one.\r\n```\r\n\r\n## <a name=\"cause\"></a>原因\r\n\r\n按每个资源组、订阅、帐户和其他作用域应用配额。 例如，订阅可能配置为限制某个区域的核心数目。 如果尝试部署超过允许核心数目的虚拟机，则会收到指出超过配额的错误消息。\r\n\r\n## <a name=\"solution\"></a>解决方案\r\n\r\n### <a name=\"solution-1\"></a>解决方案 1\r\n\r\n对于 Azure CLI，使用 `az vm list-usage` 命令查找虚拟机配额。\r\n\r\n```azurecli\r\naz vm list-usage --location \"China East\"\r\n```\r\n\r\n返回：\r\n\r\n```azurecli\r\n[\r\n  {\r\n    \"currentValue\": 0,\r\n    \"limit\": 2000,\r\n    \"name\": {\r\n      \"localizedValue\": \"Availability Sets\",\r\n      \"value\": \"availabilitySets\"\r\n    }\r\n  },\r\n  ...\r\n]\r\n```\r\n\r\n### <a name=\"solution-2\"></a>解决方案 2\r\n\r\n对于 PowerShell，使用 **Get-AzureRmVMUsage** 命令查找虚拟机配额。\r\n\r\n```powershell\r\nGet-AzureRmVMUsage -Location \"China East\"\r\n```\r\n\r\n返回：\r\n\r\n```powershell\r\nName                             Current Value Limit  Unit\r\n----                             ------------- -----  ----\r\nAvailability Sets                            0  2000 Count\r\nTotal Regional Cores                         0   100 Count\r\nVirtual Machines                             0 10000 Count\r\n```\r\n\r\n### <a name=\"solution-3\"></a>解决方案 3\r\n\r\n如果需要增加配额限制，请前往门户并提交一份支持问题以增加要部署区域内的配额。\r\n\r\n> [!NOTE]\r\n> 请记住，对于资源组，配额针对每个单独的区域，而不是针对整个订阅。 如果需要在中国北部部署 30 个核心，则必须在中国北部寻求 30 个 Resource Manager 核心。 如果需要在有权访问的任何区域内部署总共 30 个核心，则应在所有区域内请求总共 30 个 Resource Manager 核心。\r\n>\r\n>\r\n\r\n\r\n<!--Update_Description: new articles on resource manager quota errors-->"}