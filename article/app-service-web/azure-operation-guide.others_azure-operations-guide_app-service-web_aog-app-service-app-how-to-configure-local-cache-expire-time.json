{"Title":"Web 应用中如何设置静态文件缓存过期时间","Description":"Web 应用中如何设置静态文件缓存过期时间","Content":"\r\n# Web 应用中如何设置静态文件缓存过期时间\r\n\r\n## **问题描述**\r\n\r\n在使用 Azure Web 应用时，如何设置静态文件缓存过期时间。\r\n\r\n## **问题分析**\r\n\r\n目前， Azure Web 应用都是基于 IIS 转发的，我们可以在 wwwroot 中配置 web.config 来设置缓存过期时间。\r\n\r\n## **解决办法**\r\n\r\nIIS 可以基于不同的文件夹来进行配置规则，例如，设置 Scripts 文件夹中的静态文件的缓存过期时间为 60 天，其他静态文件过期时间为 30 天，则需要配置规则如下：\r\n\r\n![script](./media/aog-app-service-web-how-to-configure-local-cache-expire-time/script.jpg)\r\n\r\n```XML\r\n<configuration>\r\n  <system.webServer>\r\n        <staticContent> \r\n         <!-- Set expire headers to 30 days for static content-->\r\n         <clientCache cacheControlCustom=\"public\" cacheControlMode=\"UseMaxAge\" cacheControlMaxAge=\"30.00:00:00\" />\r\n         <mimeMap fileExtension=\".json\" mimeType=\"application/x-javascript\" />\r\n        </staticContent> \r\n  </system.webServer>\r\n\r\n   <location path=\"Scripts\">\r\n    <system.webServer>\r\n      <staticContent>\r\n        <clientCache cacheControlCustom=\"public\" cacheControlMode=\"UseMaxAge\" cacheControlMaxAge=\"60.00:00:00\" />\r\n      </staticContent>\r\n    </system.webServer>\r\n  </location>\r\n</configuration>\r\n```\r\n\r\n这样 Scirpts 文件夹中静态资源的缓存缓存时间为 60 天。\r\n\r\n![cache2](./media/aog-app-service-web-how-to-configure-local-cache-expire-time/cache2.jpg)\r\n\r\n其余静态资源的缓存时间为 30 天。\r\n\r\n![cache2](./media/aog-app-service-web-how-to-configure-local-cache-expire-time/cache1.jpg)\r\n\r\n## **参考文档**\r\n\r\n关于 IIS 配置缓存规则，请参考 IIS 官网文档：[Client Cache](https://docs.microsoft.com/iis/configuration/system.webserver/staticcontent/clientcache)。"}