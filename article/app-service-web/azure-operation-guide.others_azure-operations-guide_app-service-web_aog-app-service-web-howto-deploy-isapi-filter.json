{"Title":"如何在 Web 应用上安装自定义 ISAPI Filter","Description":"以安装 F5XForwardedFor.dll 为例讲述如何在 Web 应用上安装自定义 ISAPI Filter","Content":"\r\n# 如何在 Web 应用上安装自定义 ISAPI Filter\r\n\r\n以下步骤以安装用于获取真实 IP 的 F5XForwardedFor.dll 为例。\r\n\r\n## 操作步骤\r\n\r\n1. 进入您网站的 kudu 站点：\r\n\r\n    ![01](media/aog-app-service-web-howto-deploy-isapi-filter/01.jpg)\r\n\r\n2. 安装 IIS Manager 模块：\r\n\r\n    进入 kudu 的 “**Site extensions**”-> “**Gallery**” -> 输入 **iis** 进行搜索 -> 安装**IIS Manager**。\r\n\r\n    ![02](media/aog-app-service-web-howto-deploy-isapi-filter/02.jpg)\r\n\r\n3. 安装完毕后，在门户上重启该网站。\r\n\r\n4. Kudu 站点进入到上图中的 “**Installed**” 页面，点击运行。\r\n\r\n    ![03](media/aog-app-service-web-howto-deploy-isapi-filter/03.jpg)\r\n\r\n5. 在打开的页面中，全局搜索 “**isapiFilters**”,找到对应的行，然后修改其值，并点击右上角“**Save XDT**”。\r\n\r\n    ![04](media/aog-app-service-web-howto-deploy-isapi-filter/04.jpg)\r\n\r\n6. 修改完成以后，点击上图中的 “**Restart Site**” 重启 Kudu 站点，确保 Kudu 可以正常运行。\r\n\r\n7.\t在目录 “**wwwroot**” 中上传合适的 dll 文件，并修改 web.config 文件。例如：F5XForwarded.dll\r\n\r\n    ![05](media/aog-app-service-web-howto-deploy-isapi-filter/05.jpg)\r\n\r\n    Web.config 文件内容范例如下：\r\n\r\n    ```XML\r\n    <configuration>\r\n        <system.webServer>\r\n            <isapiFilters>\r\n                <filter name=\"ForwardFilter\" enabled=\"true\" enableCache=\"false\" path=\"D:\\home\\site\\wwwroot\\F5XForwardedFor.dll\" />\r\n            </isapiFilters>\r\n        </system.webServer>\r\n    </configuration>\r\n    ```\r\n8. 配置完成以后，在门户中重启该网站。回到 Kudu 站点的 “**Process Explorer**” 中即可看到 w3wp 进程加载的模块中已有该模块。\r\n\r\n    ![06](media/aog-app-service-web-howto-deploy-isapi-filter/06.jpg)\r\n\r\n"}