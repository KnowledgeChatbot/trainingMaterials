{"Title":"将 Spring Boot 应用程序部署到 Azure 应用服务","Description":"本教程引导开发人员完成将 Spring Boot 入门 Web 应用部署到 Azure 应用服务的步骤。","Content":"# <a name=\"deploy-a-spring-boot-application-to-the-azure-app-service\"></a>将 Spring Boot 应用程序部署到 Azure 应用服务\r\n\r\n**[Spring Framework]** 是可以帮助 Java 开发人员创建企业级应用程序的开源解决方案。构建在该平台基础之上的较热门项目之一是 [Spring Boot]，它提供一种简化的方法来创建独立的 Java 应用程序。\r\n\r\n本教程将逐步讲解如何创建示例 Spring Boot 入门 Web 应用，并将其部署到 [Azure 应用服务]。\r\n\r\n### <a name=\"prerequisites\"></a>先决条件\r\n\r\n若要完成本教程中的步骤，需要满足以下先决条件：\r\n\r\n* 一个 Azure 订阅；如果你没有 Azure 订阅，可以注册[试用 Azure 帐户]。\r\n* 最新的 [Java 开发人员工具包 (JDK)]。\r\n* Apache 的 [Maven] 生成工具（版本 3）。\r\n* 一个 [Git] 客户端。\r\n\r\n## <a name=\"create-the-spring-boot-getting-started-web-app\"></a>创建 Spring Boot 入门 Web 应用\r\n\r\n以下步骤将引导你创建一个简单的 Spring Boot Web 应用程序并在本地对其进行测试。\r\n\r\n1. 打开命令提示符并创建一个用于保存应用程序的本地目录，然后切换到该目录；例如：\r\n   ```\r\n   md C:\\SpringBoot\r\n   cd C:\\SpringBoot\r\n   ```\r\n   -- 或 --\r\n   ```\r\n   md /users/robert/SpringBoot\r\n   cd /users/robert/SpringBoot\r\n   ```\r\n\r\n1. 将 [Spring Boot 入门]示例项目克隆到刚刚创建的目录；例如：\r\n   ```\r\n   git clone https://github.com/spring-guides/gs-spring-boot.git\r\n   ```\r\n\r\n1. 将目录切换到已完成项目所在的目录；例如：\r\n   ```\r\n   cd gs-spring-boot\r\n   cd complete\r\n   ```\r\n\r\n1. 使用 Maven 生成 JAR 文件；例如：\r\n   ```\r\n   mvn package\r\n   ```\r\n\r\n1. 创建 Web 应用后，请将目录切换到 JAR 文件所在的目录并启动该 Web 应用；例如：\r\n   ```\r\n   cd target\r\n   java -jar gs-spring-boot-0.1.0.jar\r\n   ```\r\n\r\n1. 使用 Web 浏览器浏览到 http://localhost:8080 以测试该 Web 应用；如果有可用的 curl，请使用类似下面的示例语法：\r\n   ```\r\n   curl http://localhost:8080\r\n   ```\r\n\r\n1. 此时应显示以下消息：“来自 Spring Boot 的问候!”\r\n\r\n   ![浏览示例应用][SB01]\r\n\r\n## <a name=\"create-an-azure-web-app-for-use-with-java\"></a>创建用于 Java 的 Azure Web 应用\r\n\r\n以下步骤将引导你创建 Azure Web 应用、配置 Java 所需的设置，然后配置 FTP 凭据。\r\n\r\n1. 浏览到 [Azure 门户]并登录。\r\n\r\n1. 在 Azure 门户中登录到帐户后，请单击“应用服务”对应的菜单图标：\r\n\r\n   ![Azure 门户][AZ01]\r\n\r\n1. 显示“应用服务”页后，请单击“+ 添加”创建新的应用服务。\r\n\r\n   ![创建应用服务][AZ02]\r\n\r\n1. 显示 Web 应用模板列表后，请单击“基本 Microsoft Web 应用”对应的链接。\r\n\r\n   ![Web 应用模板][AZ03]\r\n\r\n1. 显示 Web 应用模板的信息页后，请单击“创建”。\r\n\r\n   ![创建 Web 应用][AZ04]\r\n\r\n1. 提供 Web 应用的唯一名称并指定其他任何设置，然后单击“创建”。\r\n\r\n   ![创建 Web 应用设置][AZ05]\r\n\r\n1. 创建 Web 应用后，请单击“应用服务”对应的菜单图标，然后单击新建的 Web 应用：\r\n\r\n   ![列出 Web 应用][AZ06]\r\n\r\n1. 显示你的 Web 应用后，请使用以下步骤指定 Java 版本：\r\n\r\n   a. 单击“应用程序设置”菜单项。\r\n\r\n   b. 为 Java 版本选择“Java 8”。\r\n\r\n   c. 为次要 Java 版本选择“最新”。\r\n\r\n   d.单击“下一步”。 为 Web 容器选择“最新的 Tomcat 8.5”。 （实际上并不使用此容器；Azure 将使用 Spring Boot 应用程序中的容器。）\r\n\r\n   e. 单击“保存” 。\r\n\r\n   ![应用程序设置][AZ07]\r\n\r\n1. 使用以下步骤指定 FTP 部署凭据：\r\n\r\n   a. 单击“部署凭据”菜单项。\r\n\r\n   b. 指定用户名和密码。\r\n\r\n   c. 单击“保存” 。\r\n\r\n   ![指定部署凭据][AZ08]\r\n\r\n1. 使用以下步骤检索 FTP 连接信息：\r\n\r\n   a. 单击“部署凭据”菜单项。\r\n\r\n   b. 复制并保存完整的 FTP 用户名和 URL，以便在本教程的下一部分使用。\r\n\r\n   ![FTP URL 和凭据][AZ09]\r\n\r\n## <a name=\"deploy-your-spring-boot-web-app-to-azure\"></a>将 Spring Boot Web 应用部署到 Azure\r\n\r\n以下步骤引导你将 Spring Boot Web 应用部署到 Azure。\r\n\r\n1. 打开文本编辑器（例如 Windows 记事本）并将以下文本粘贴到新文档中，然后将文件保存为 *web.config*：\r\n   ```xml\r\n   <?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n   <configuration>\r\n     <system.webServer>\r\n       <handlers>\r\n         <add name=\"httpPlatformHandler\" path=\"*\" verb=\"*\" modules=\"httpPlatformHandler\" resourceType=\"Unspecified\" />\r\n       </handlers>\r\n       <httpPlatform processPath=\"%JAVA_HOME%\\bin\\java.exe\"\r\n           arguments=\"-Djava.net.preferIPv4Stack=true -Dserver.port=%HTTP_PLATFORM_PORT% -jar &quot;%HOME%\\site\\wwwroot\\gs-spring-boot-0.1.0.jar&quot;\">\r\n       </httpPlatform>\r\n     </system.webServer>\r\n   </configuration>\r\n   ```\r\n\r\n1. 在系统中保存 *web.config* 文件后，请使用在本教程前一部分中获取的 URL、用户名和密码通过 FTP 连接到 Web 应用。 例如：\r\n   ```\r\n   ftp\r\n   open waws-prod-sn0-000.ftp.azurewebsites.chinacloudapi.cn\r\n   user wingtiptoys-springboot\\wingtiptoysuser\r\n   pass ********\r\n   ```\r\n\r\n1. 将远程目录切换到 Web 应用的根文件夹（路径为 */site/wwwroot*），然后复制 Spring Boot 应用程序中的 JAR 文件，以及前面创建的 *web.config*。 例如：\r\n   ```\r\n   cd site/wwwroot\r\n   put gs-spring-boot-0.1.0.jar\r\n   put web.config\r\n   ```\r\n\r\n1. 将 JAR 和 *web.config* 文件部署到 Web 应用后，需要使用 Azure 门户重启 Web 应用：\r\n\r\n   ![][AZ10]\r\n\r\n1. 使用 Web 浏览器浏览到 Web 应用的 URL 以测试该 Web 应用；如果有可用的 curl，请使用类似下面的示例语法：\r\n   ```\r\n   curl http://wingtiptoys-springboot.chinacloudsites.cn/\r\n   ```\r\n\r\n1. 此时应显示以下消息：“来自 Spring Boot 的问候!”\r\n\r\n   ![浏览示例应用][SB02]\r\n\r\n## <a name=\"next-steps\"></a>后续步骤\r\n\r\n有关将 Azure 与 Java 配合使用的详细信息，请参阅 [Azure Java 开发人员中心]和[用于 Visual Studio Team Services 的 Java 工具]。\r\n\r\n有关使用 FTP 将 Web 应用部署到 Azure 的更多信息，请参阅[使用 FTP/S 将应用部署到 Azure 应用服务]。\r\n\r\n有关 Spring Boot 示例项目的更多详细信息，请参阅 [Spring Boot 入门]。\r\n\r\n有关创建自己的 Spring Boot 应用程序的入门帮助，请参阅 https://start.spring.io/ 上的 **Spring Initializr**。\r\n\r\n有关为 Web 应用配置其他设置的详细信息，请参阅[在 Azure 应用服务中配置 Web 应用]。\r\n\r\n<!-- URL List -->\r\n\r\n[Azure 应用服务]: https://www.azure.cn/home/features/app-service/\r\n[Azure Java 开发人员中心]: /develop/java/\r\n[Azure 门户]: https://portal.azure.cn/\r\n[在 Azure 应用服务中配置 Web 应用]: ./web-sites-configure.md\r\n[使用 FTP/S 将应用部署到 Azure 应用服务]: ./app-service-deploy-ftp.md\r\n[试用 Azure 帐户]: https://www.azure.cn/pricing/1rmb-trial/\r\n[Git]: https://github.com/\r\n[Java 开发人员工具包 (JDK)]: http://www.oracle.com/technetwork/java/javase/downloads/\r\n[用于 Visual Studio Team Services 的 Java 工具]: https://java.visualstudio.com/\r\n[Maven]: http://maven.apache.org/\r\n[Spring Boot]: http://projects.spring.io/spring-boot/\r\n[Spring Boot 入门]: https://github.com/spring-guides/gs-spring-boot\r\n[Spring Framework]: https://spring.io/\r\n\r\n<!-- IMG List -->\r\n\r\n[SB01]: ./media/app-service-deploy-spring-boot-web-app-on-azure/SB01.png\r\n[SB02]: ./media/app-service-deploy-spring-boot-web-app-on-azure/SB02.png\r\n\r\n[AZ01]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ01.png\r\n[AZ02]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ02.png\r\n[AZ03]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ03.png\r\n[AZ04]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ04.png\r\n[AZ05]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ05.png\r\n[AZ06]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ06.png\r\n[AZ07]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ07.png\r\n[AZ08]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ08.png\r\n[AZ09]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ09.png\r\n[AZ10]: ./media/app-service-deploy-spring-boot-web-app-on-azure/AZ10.png"}