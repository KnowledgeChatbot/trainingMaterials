{"Title":"基于 URL 的内容路由概述","Description":"本页提供基于应用程序网关 URL 的内容路由、UrlPathMap 配置和 PathBasedRouting 规则的概述。","Content":"\r\n# 基于 URL 路径的路由概述\r\n\r\n基于 URL 路径的路由可让你根据请求的 URL 路径，将流量路由到后端服务器池。方案之一是将针对不同内容类型的请求路由到不同的后端服务器池。\r\n在以下示例中，应用程序网关针对 contoso.com 从三个后端服务器池提供流量，例如：VideoServerPool、ImageServerPool 和 DefaultServerPool。\r\n\r\n![imageURLroute](./media/application-gateway-url-route-overview/figure1.png)\r\n\r\n对 http://contoso.com/video* 的请求将路由到 VideoServerPool，对 http://contoso.com/images* 的请求将路由到 ImageServerPool。如果没有任何路径模式匹配，则选择 DefaultServerPool。\r\n\r\n## UrlPathMap 配置元素\r\n\r\nUrlPathMap 元素是用于指定后端服务器池映射的路径模式。这是模板文件中 urlPathMap 元素的代码段。\r\n\r\n```json\r\n\"urlPathMaps\": [\r\n{\r\n\"name\": \"<urlPathMapName>\",\r\n\"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/ urlPathMaps/<urlPathMapName>\",\r\n\"properties\": {\r\n    \"defaultBackendAddressPool\": {\r\n        \"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/backendAddressPools/<poolName>\"\r\n    },\r\n    \"defaultBackendHttpSettings\": {\r\n        \"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/backendHttpSettingsList/<settingsName>\"\r\n    },\r\n    \"pathRules\": [\r\n        {\r\n            \"paths\": [\r\n                <pathPattern>\r\n            ],\r\n            \"backendAddressPool\": {\r\n                \"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/backendAddressPools/<poolName2>\"\r\n            },\r\n            \"backendHttpsettings\": {\r\n                \"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/backendHttpsettingsList/<settingsName2>\"\r\n            },\r\n\r\n        },\r\n\r\n    ],\r\n\r\n}\r\n}\r\n```\r\n\r\n>[!NOTE]\r\n> PathPattern：这是要匹配的路径模式列表。每个模式必须以 / 开始，只允许在后接“/”的末尾处添加 *。发送到路径匹配器的字符串不会在第一个 ? 或 # 之后包含任何文本，这些字符在这里是不允许的。\r\n\r\n有关详细信息，可以查看[使用基于 URL 的路由的 ARM 模板](https://github.com/Azure/azure-quickstart-templates/tree/master/201-application-gateway-url-path-based-routing)。\r\n\r\n## PathBasedRouting 规则\r\n\r\nPathBasedRouting 类型的 RequestRoutingRule 可用于将侦听器绑定到 urlPathMap。针对此侦听器收到的所有请求将根据 urlPathMap 中指定的策略进行路由。PathBasedRouting 规则的代码段：\r\n\r\n```json\r\n\"requestRoutingRules\": [\r\n  {\r\n\r\n\"name\": \"<ruleName>\",\r\n\"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/requestRoutingRules/<ruleName>\",\r\n\"properties\": {\r\n    \"ruleType\": \"PathBasedRouting\",\r\n    \"httpListener\": {\r\n        \"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/httpListeners/<listenerName>\"\r\n    },\r\n    \"urlPathMap\": {\r\n        \"id\": \"/subscriptions/<subscriptionId>/../microsoft.network/applicationGateways/<gatewayName>/ urlPathMaps/<urlPathMapName>\"\r\n    },\r\n\r\n}\r\n```\r\n\r\n## 后续步骤 \r\n\r\n了解基于 URL 的内容路由之后，请转到[使用基于 URL 的路由创建应用程序网关](./application-gateway-create-url-route-arm-ps.md)，以使用 URL 路由规则创建应用程序网关。\r\n\r\n<!---HONumber=Mooncake_Quality_Review_0117_2017-->"}