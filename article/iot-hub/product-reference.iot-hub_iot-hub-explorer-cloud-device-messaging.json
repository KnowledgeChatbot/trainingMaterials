{"Title":"使用 iothub-explorer 管理 Azure IoT 中心云设备消息传送","Description":"了解如何在 Azure IoT 中心内使用 iothub-explorer CLI 工具监视设备到云 (D2C) 的消息以及发送到云到设备 (C2D) 的消息。","Content":"# <a name=\"use-iothub-explorer-to-send-and-receive-messages-between-your-device-and-iot-hub\"></a>使用 iothub-explorer 在设备与 IoT 中心之间发送和接收消息\r\n\r\n![端到端关系图](media/iot-hub-get-started-e2e-diagram/2.png)\r\n\r\n[!INCLUDE [iot-hub-get-started-note](../../includes/iot-hub-get-started-note.md)]\r\n\r\n[iothub-explorer](https://github.com/azure/iothub-explorer) 提供一些命令用于简化 IoT 中心的管理。 本教程重点介绍如何使用 iothub-explorer 在设备与 IoT 中心之间发送和接收消息。\r\n\r\n## <a name=\"what-you-will-learn\"></a>要学习的知识\r\n\r\n了解如何使用 iothub-explorer 监视设备到云的消息以及发送云到设备的消息。 设备到云的消息可能是设备收集的，随后要发送到 IoT 中心的传感器数据。 云到设备的消息可能是 IoT 中心发送到设备的，用于闪烁连接到设备的 LED 的命令。\r\n\r\n## <a name=\"what-you-will-do\"></a>执行的操作\r\n\r\n- 使用 iothub-explorer 监视设备到云的消息。\r\n- 使用 iothub-explorer 发送云到设备的消息。\r\n\r\n## <a name=\"what-you-need\"></a>需要什么\r\n\r\n- 已完成教程[设置设备](./iot-hub-raspberry-pi-kit-node-get-started.md)，其中涵盖以下要求：\r\n  - 一个有效的 Azure 订阅。\r\n  - 已在订阅中创建一个 Azure IoT 中心。\r\n  - 一个可向 Azure IoT 中心发送消息的客户端应用程序。\r\n- iothub-explorer。 （[安装 iothub-explorer](https://github.com/azure/iothub-explorer)）\r\n\r\n## <a name=\"monitor-device-to-cloud-messages\"></a>监视设备到云的消息\r\n\r\n若要监视设备发送到 IoT 中心的消息，请执行以下步骤：\r\n\r\n1. 打开控制台窗口。\r\n1. 运行以下命令：\r\n\r\n   ```bash\r\n   iothub-explorer monitor-events <device-id> --login \"<IoTHubConnectionString>\"\r\n   ```\r\n\r\n   > [!Note]\r\n   > 从 IoT 中心获取 `<device-id>` 和 `<IoTHubConnectionString>`。 确保已完成以前的教程。 或者可以尝试使用 `iothub-explorer monitor-events <device-id> --login \"HostName=<my-hub>.azure-devices.cn;SharedAccessKeyName=<my-policy>;SharedAccessKey=<my-policy-key>\"`（如果有 `HostName`、`SharedAccessKeyName` 和 `SharedAccessKey`）。\r\n\r\n## <a name=\"send-cloud-to-device-messages\"></a>发送“云到设备”消息\r\n\r\n要将消息从 IoT 中心发送到设备，请执行以下步骤：\r\n\r\n1. 打开控制台窗口。\r\n1. 运行以下命令，在 IoT 中心内启动一个会话：\r\n\r\n   ```bash\r\n   iothub-explorer login <IoTHubConnectionString>\r\n   ```\r\n\r\n1. 运行以下命令，将消息发送到设备：\r\n\r\n   ```bash\r\n   iothub-explorer send <device-id> <message>\r\n   ```\r\n\r\n该命令将闪烁连接到设备的 LED，并将消息发送到设备。\r\n\r\n> [!Note]\r\n> 设备收到消息后，不需要向 IoT 中心发送单独的确认命令。\r\n\r\n## <a name=\"next-steps\"></a>后续步骤\r\n\r\n现在，已了解如何监视设备到云的消息，以及在 IoT 设备与 Azure IoT 中心之间发送云到设备的消息。\r\n\r\n[!INCLUDE [iot-hub-get-started-next-steps](../../includes/iot-hub-get-started-next-steps.md)]\r\n\r\n\r\n<!--Update_Description: update meta data and wording-->"}